2012-12-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-task-form, task): Add filter params to and
	remove overrides params from task icons.
	(gsa:alert-in-trash): New function.
	(task [trash]): Use gsa:alert-in-trash for restore check, because there
	are multiple alerts now.
	(list-window): For the refresh in the header, get the filter from
	FILTERS/TERM and remove the filt_id param.  This keeps the existing
	filtering but drops the actual named filter, otherwise the new
	apply_override could conflict with the filter.

2012-12-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_tasks): Prepend apply_overrides to the filter
	according to the overrides request param.

	* src/html/omp.xsl (list-window-line-icons): Add extra-params-details.
	(task): Pass overrides in extra-params-details.
	(list-window): Enable overrides control for Tasks page.

2012-12-12  Hani Benhabiles  <kroosec@gmail.com>

	* src/html/omp.xsl (html-create-alert-form): Update help link. Add
	Alerts list link.
	(new_alert): New template.
	(html-alerts-table): Use list-window.
	(alert): Link alert names to their details page. Use
	list-window-line-icons, detail-headers-icons and minor-details templates.
	(get_alerts): Remove html-create-alert-form call.

2012-12-12  Hani Benhabiles  <kroosec@gmail.com>

	* src/gsad_omp.c (new_alert_omp): New function. Correct typo in
	changelog.

2012-12-12  Hani Benhabiles  <kroosec@gmail.com>

	* src/gsad_omp.c (new_alert, export_alert_omp, export_alerts_omp):
	New functions.

	* src/gsad_omp.h: Add headers accordingly.

	* src/gsad.c (init_validator, exec_omp_get): Add new_alert, export_alert
	and export_alerts command.

2012-12-12  Hani Benhabiles  <kroosec@gmail.com>

	* src/gsad_omp.c (delete_alert_omp, delete_trash_alert_omp): Use
	delete_resource.
	(get_alert): New function. Use get_one.
	(get_alert_omp): Use get_alert.
	(get_alerts_omp): Use get_many.
	(get_alerts_xml): Remove unused function.

2012-12-12  Hani Benhabiles  <kroosec@gmail.com>

	* src/gsad_omp.c (export_target_omp, export_note_omp)
	(export_override_omp): Use export_resource.

2012-12-12  Hani Benhabiles  <kroosec@gmail.com>

	Add alerts information in Report Formats details page.

	* src/gsad_omp.c (get_report_format): Add alerts attribute in get_one
	request.

	* src/html/omp.xsl (report_format [details]): Add Alerts using this
	Report Format table.

2012-12-12  Matthew Mundell <matthew.mundell@greenbone.net>

	Add the refresh input to the headers of the new-style get pages.

	* src/gsad_omp.c (xsl_transform_omp): Add AUTOREFRESH to ENVELOPE.

	* src/html/gsad.xsl (autorefresh): Get the URL from the ENVELOPE instead
	of always using get_tasks.

	* src/html/omp.xsl (list-window): Add the refresh input that was
	previously on the tasks page.

2012-12-12  Hani Benhabiles  <kroosec@gmail.com>

	* src/gsad_omp.c (export_report_format_omp): Use export_resource.

2012-12-11  Hani Benhabiles  <kroosec@gmail.com>

	Update help documentation for Port Lists.

	* src/html/help.xsl (port_lists.html, new_port_list.html)
	(port_list_details.html): New templates. Use various templates and
	content from configure_port_lists.html.
	(configure_port_lists.html): Removed.
	(report_formats.html): Fix typo.

2012-12-11  Hani Benhabiles  <kroosec@gmail.com>

	* src/gsd_omp.c (get_port_list): Send targets and ranges attributes
	instead of details.

2012-12-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/wizard.xsl (wizard-icon, wizard): Let page element determine
	visibility.

2012-12-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_base.c (params_add): Ensure that name and value are always
	strings.

	* src/html/omp.xsl (details-header-icon): Remove extra ampersand from
	New link.

2012-12-11  Hani Benhabiles  <kroosec@gmail.com>

	* src/html/omp.xsl (details-header-icons): Add noedit parameter.
	(port_list [details]): Fix type parameter and use noedit parameter
	for details-header-icons template call.

2012-12-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_many): Get the Wizard Rows setting too.

	* src/html/omp.xsl (list-window): Call wizard-icon and wizard.

	* src/html/wizard.xsl (wizard-icon, wizard): New templates.

2012-12-10  Hani Benhabiles  <kroosec@gmail.com>

	* src/gsad_omp.c (get_port_list): Use get_one function. Rename commands
	parameter to extra_xml for consistency.
	(get_port_lists): New function.
	(get_port_lists_omp): Use get_port_lists function.
	(delete_port_list_omp, delete_trash_port_list_omp)
	(delete_port_range_omp): Use delete_resource adequately.

2012-12-10  Hani Benhabiles  <kroosec@gmail.com>

	* src/html/omp.xsl (port_list [details]): Use details-header-icon and
	minor-details templates.

	* src/gsad_omp.c (export_port_list_omp): Remove trailing whitespace.

2012-12-10  Hani Benhabiles  <kroosec@gmail.com>

	Add Port Lists exporting.

	* src/gsad_omp.c (export_port_lists_omp): New function.
	(export_port_list_omp): Use export_resource.

	* src/gsad_omp.h: Add header accordingly.

	* src/gsad.c (init_validator, exec_omp_get): Add export_port_lists
	command.

2012-12-10  Hani Benhabiles  <kroosec@gmail.com>

	Add New Port List page.

	* src/gsad_omp.c (new_port_list, new_port_list_omp): New functions.

	* src/gsad_omp.h: Add header accordingly.

	* src/gsad.c (init_validator, exec_omp_get): Add new_port command.

	* src/html/omp.xsl (html-create-port_list-table): Rename to
	html-create-port-list-table to follow the same naming style.
	(get_port_lists): Remove port list create and import template calls.
	(new_port_list): New template.

2012-12-10  Hani Benhabiles  <kroosec@gmail.com>

	* src/html/omp.xsl (list-window-line-icons): Add support for noclone and
	noedit parameters to disable edit and clone icons.
	(html-port-lists-table): Use filter-window-pager and
	list-window-line-icons template. Add various links.

2012-12-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-tasks-table): Correct replace typo.

2012-12-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (list-window): Remove anchor from top row of
	multi-row heading.

2012-12-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-tasks-table): Call through to list-window.
	(old-html-tasks-table): New template.  Body from html-tasks-table.
	(list-window): Extend the header generation for headers over multiple
	rows, as in Tasks header.

2012-12-07  Matthew Mundell <matthew.mundell@greenbone.net>

	Only pass parameters into the XML in the ENVELOPE if their values are
	valid UTF8.

	* src/gsad_base.h (struct param): Add valid_utf8.

	* src/gsad.c (params_mhd_validate_values): Init valid_utf8 in params.
	When param is valid run g_utf8_validate on value to set valid_utf8.

	* src/gsad_omp.c (xsl_transform_omp): Only print param in ENVELOPE if
	param value is valid utf8.

	* src/gsad_base.c (params_add): Clear valid_utf8.

2012-12-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-task-table): Remove.  Now html-tasks-table.
	(html-tasks-table): New template.  Was html-task-table.  Add pager and
	filter window.
	(task): Make name a link to the task details.
	(get_tasks_response): Update html-task-table call.
	(list-window-line-icons, details-header-icons): Flush trailing
	whitespace.

	* src/gsad_omp.c (get_many): Add marker for get_settings.
	(get_tasks): Call get_many.

2012-12-06  Hani Benhabiles <kroosec@gmail.com>

	* src/html/help.xsl (list-window-line-actions): Add noclone and noedit
	parameters to be able to omit clone and edit information.
	(agents.html): Use the new form of list-window-line-actions.
	(report_formats.html): Use noclone for list-window-line-actions
	template. Add Verify Report Format information.

2012-12-06  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/next.png, src/html/img/previous.png: New.

	* CMakeLists.txt: Install the new icons.

	* src/html/omp.xsl (filter-window-pager): Use new Icons for
	Next/Previous as a replacement for "<<" and ">>".

2012-12-06  Hani Benhabiles <kroosec@gmail.com>

	Update Report Formats help documentation.

	* src/html/help.xsl (configure_report_formats.html): Renamed to
	report_formats. Updated the content to match the new style.
	(new_report_format, report_format_details): New templates.
	(contents.html): Updated links to Report Formats help documentation.

2012-12-06  Hani Benhabiles <kroosec@gmail.com>

	* src/html/omp.xsl (details-header-icons, list-window-line-icons):
	Replace space by underscore for type-lower variable in order to allow
	the use of multiple words types such as Report Formats without breaking
	links.

2012-12-05  Hani Benhabiles <kroosec@gmail.com>

	Add Export Report Formats.

	* src/gsad_omp.c (export_report_formats_omp): New function.

	* src/gsad_omp.h: Add header accrodingly.

	* src/gsad.c (init_validator, exec_omp_get): Add export_report_formats
	command. Fix indentation.

2012-12-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_report_formats): Correct typo.  Flush trailing
	space.

2012-12-05  Hani Benhabiles <kroosec@gmail.com>

	* src/html/omp.xsl (details-header-icons): Check writable value when
	displaying edit and delete icons.
	(get_report_format): Call report_format template in details mode.

2012-12-05  Hani Benhabiles <kroosec@gmail.com>

	* src/gsad_omp.c (new_note): Revert previous change to take into
	account task_id and result_id values.

2012-12-04  Hani Benhabiles <kroosec@gmail.com>

	* src/gsad_omp.c (new_schedule): Default First Time fields to current
	time.

2012-12-04  Hani Benhabiles <kroosec@gmail.com>

	* src/gsad_omp.c (next_page): Add handlers for get_report_format and
	get_report_formats.
	(check_modify_report_format): Remove unused function.
	(save_report_format_omp): Refactor to leverage omp, next_page and
	omp_success functions.

2012-12-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-target-form): Add missing filt_id arg to
	header icons and remove old max and first args.
	(html-edit-note-form, html-edit-override-form): Add list icon in header.

2012-12-03  Hani Benhabiles <kroosec@gmail.com>

	* src/gsad.c (delete_agent_omp, delete_trash_agent_omp)
	(delete_trash_report_format_omp, delete_trash_slave_omp)
	(delete_report_format_omp, edit_report_format): Code refactoring to
	leverage delete_resource and edit_resource.

2012-12-03  Hani Benhabiles <kroosec@gmail.com>

	* src/gsad.c (init_validator, exec_omp_get): Added new_report_format
	command.

	* src/gsad_omp.c, src/gsad_omp.h (get_report_format)
	(get_report_format_omp, get_report_formats, get_report_formats_omp):
	Refactored to leverage get_one and get_many functions.
	(new_report_format, new_report_format_omp): New functions.
	(save_report_format_omp): Adapt for get_report_format and
	get_report_formats.

2012-12-03  Hani Benhabiles <kroosec@gmail.com>

	Update Report formats management.

	* src/html/omp.xsl (html-report-formats-table): Use list-window.
	(html-import-report-format-form): Renamed to
	html-create-report-format-form.
	(html-import-report-format-form, html-edit-report-format-form): Updated
	title and links to follow the new style.
	(report_format [details]): Use details-header-icons and minor-details.
	Update various links.
	(new_report_format): New template.
	(get_report_formats): Update to match new style.

2012-11-29  Hani Benhabiles <kroosec@gmail.com>

	Updated help documentation for Agents object.

	* src/html/help.xsl (list-window-line-actions): Output the resource type
	for export header.
	(configure_agents.html): Removed template.
	(agent_details.html, agents.html, new_agent.html [help]): New templates.
	Using the same style of documentation as other resources using the new
	GET style object management.
	(contents.html, glossary.html): Updated with new links and information.

2012-11-29  Hani Benhabiles <kroosec@gmail.com>

	* src/gsad_omp.c (save_slave_omp): Refactored code to use omp function.

2012-11-29  Hani Benhabiles <kroosec@gmail.com>

	* src/gsad.c (init_validator, exec_omp_get): Added new_agent command.

	* src/gsad_omp.c (new_agent_omp, new_agent): New functions.

	* src/html/omp.xsl (agent): Added get agent details action.

2012-11-29  Hani Benhabiles <kroosec@gmail.com>

	* src/html/omp.xsl (agent): Added action entry for agent exporting.
	(agent [details], get_agent): New templates.

2012-11-29  Hani Benhabiles <kroosec@gmail.com>

	* src/gsad_omp.h, src/gsad_omp.c (export_agents_omp, export_agent_omp)
	(get_agent, get_agent_omp): New functions.
	(export_many): Sends details attribute with a value of One.

2012-11-29  Hani Benhabiles <kroosec@gmail.com>

	* src/html/omp.xsl (html-create-agent-form, agent, get_agents_response):
	Adapted for new GET style.
	(new_agent): New template.
	(html-agents-table): Refactored to use list-window template.

2012-11-29  Hani Benhabiles <kroosec@gmail.com>

	* src/gsad.c, src/gsad_omp.c, src/gsad_omp.h (get_agent_omp): Renamed to
	download_agent_omp. Adequated GSA command renamed from get_agent to
	download_agent.

2012-11-29  Hani Benhabiles <kroosec@gmail.com>

	* src/html/omp.xsl (html-edit-schedule-form): Add a dropdown option
	containing the first time's year when it is out of the range 2012-2017.

2012-11-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-schedule-form)
	(html-edit-schedule-form): Replace number dropdowns in duration and
	period with text input fields.  Update "first time" year range to
	2012-2017.

2012-11-28  Hani Benhabiles <kroosec@gmail.com>

	* src/gsad_omp.c (save_task_omp): Removed sort_field and sort_order.

2012-11-28  Hani Benhabiles <kroosec@gmail.com>

	* src/gsad_omp.c (save_task_omp): Removed sort_field and sort_order.

2012-11-28  Hani Benhabiles <kroosec@gmail.com>

	Updated Slaves management documentation to reflect the new object
	management style and features.

	* src/html/help.xsl (configure_slaves.html): Template removed.
	(slave_details.html, slaves.html, new_slave.html): New templates.

2012-11-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Separate token missing and token bad
	messages.

2012-11-27  Hani Benhabiles <kroosec@gmail.com>

	* src/html/omp.xsl (slave [details]): Refactored code to use shared
	templates details-header-icons and minor-details.

2012-11-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Split default report check
	per report type, to make it easier to patch for custom report formats.

2012-11-27  Hani Benhabiles <kroosec@gmail.com>

	* src/gsad_omp.h, src/gsad_omp.c (save_slave_omp): New function.

	* src/gsad.c (init_validator, exec_omp_post): Added edit_slave and
	save_slave values.

	* src/html/omp.xsl (modify_slave_response, html-edit-slave-form)
	(edit_slave): New templates.
	(html-edit-schedule-form): Fixed help link.

2012-11-27  Hani Benhabiles <kroosec@gmail.com>

	* src/gsad.c (init_validator): Added export_slave and export_slaves
	values. Added slave to possible values of resource_type and
	optional_resource_type.
	(export_omp_get): Added handlers for export_slave and export_slaves
	commands.

	* src/gsad_omp.c (next_page): Added handler for get_slaves value.

2012-11-26  Hani Benhabiles <kroosec@gmail.com>

	* src/html/omp.xsl (html-slaves-table): Refactored code to use
	list-window.
	(create_slave_response): Added links to each slave details page in the
	list.
	(slave): Refactored code to use list-window-line-icons.
	(get_slaves): Added code to test for 4xx and 5xx status responses.

2012-11-26  Hani Benhabiles <kroosec@gmail.com>

	* src/gsad_omp.c (export_filter_omp): Fixed documentation.

2012-11-26  Hani Benhabiles <kroosec@gmail.com>

	* src/gsad_omp.c (edit_slave, edit_slave_omp, export_slave_omp)
	(export_slaves_omp): New functions.

2012-11-26  Henri Doreau <henri.doreau@greenbone.net>

	* src/gsad_omp.c (save_task_omp, save_container_task_omp): Removed
	set-but-unused variables to get rid of the corresponding GCC warning.

2012-11-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_lsc_credential_omp, delete_alert_omp)
	(test_alert_omp, new_target_omp, create_target_omp, get_targets_omp)
	(save_target_omp, get_my_settings, edit_my_settings, save_my_settings)
	(new_filter, create_filter_omp): Close connection after use.

	* src/gsad_oap.c (edit_user_oap, get_user_oap, get_users_oap)
	(get_feed_oap, get_scan_oap, sync_feed_oap, sync_scap_oap)
	(get_settings_oap): Close connection after use.

2012-11-24  Hani Benhabiles <kroosec@gmail.com>

	* src/gsad_omp.c (delete_schedule_omp, delete_trash_schedule_omp)
	(delete_target_omp, delete_trash_target_omp): Refactored to use
	delete_resource accordingly.

2012-11-24  Hani Benhabiles <kroosec@gmail.com>

	* src/gsad_omp.c (get_slave, get_slaves): New functions.
	(delete_slave_omp): Now uses delete_resource.
	(get_slave_omp): Now uses get_slave.
	(get_slaves_omp): Now uses get_slaves.

2012-11-24  Hani Benhabiles <kroosec@gmail.com>

	* src/html/omp.xsl (html-create-slave-form): Added link to slaves list.
	Updated to link to new style help documentation.

2012-11-24  Hani Benhabiles <kroosec@gmail.com>

	* src/html/omp.xsl (new_slave): New template.

2012-11-24  Hani Benhabiles <kroosec@gmail.com>

	* src/gsad.c (exec_omp_get, init_validator): Added new_slave command.

2012-11-24  Hani Benhabiles <kroosec@gmail.com>

	* src/gsad_omp.c, src/gsad_omp.h (new_slave, new_slave_omp): New
	functions.

2012-11-24  Hani Benhabiles <kroosec@gmail.com>

	* src/html/omp.xsl (new_schedule): Updated link to new schedule help
	page.

2012-11-24  Hani Benhabiles <kroosec@gmail.com>

	* src/html/gsad.xsl (login_page): Added autofocus on username field to
	automatically select it at page load and improve user experience.

2012-11-24  Hani Benhabiles <kroosec@gmail.com>

	* src/html/omp.xsl (new_schedule): Added delete_schedule_response
	commands_response.

2012-11-24  Hani Benhabiles <kroosec@gmail.com>

	* src/html/omp.xsl (html-create-schedule-form): Added button to show
	list of schedules

2012-11-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (omp): Close connection afterwards.

2012-11-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-task-table): Remove tracing from last commit.

2012-11-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-task-table): Convert $wizard-rows to number
	before doing comparison with task count.

2012-11-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-filter-form, html-edit-filter-form): Add
	Note and Override to types.

2012-11-21  Hani Benhabiles <kroosec@gmail.com>

	* src/html/help.xsl (schedule_details.html, schedules.html)
	(new_schedule.html, contents.html): Updated to reflect the new Schedules
	object management.

2012-11-21  Hani Benhabiles <kroosec@gmail.com>

	* src/html/gsad.xsl (new_schedule): New template.
	(html-schedules-table): Cleaned code. Now calls list-window.
	(schedule): Each schedule now links to its details page. Now calls
	list-window-line-icons.
	(schedule [details]): Refactored code to use details-header-icons and
	minor-details.
	(get_schedules): Code cleanup and refactoring.

2012-11-21  Hani Benhabiles <kroosec@gmail.com>

	* src/gsad_omp.c, src/gsad_omp.h (new_schedule_omp, export_schedule_omp)
	(export_schedules_omp): New functions.

	* src/gsad_omp.c (get_schedules, get_schedule, new_schedule): New
	functions.
	(get_schedule_omp): Now calls get_schedule.
	(get_schedules_omp): Now calls get_schedules.

2012-11-21  Hani Benhabiles <kroosec@gmail.com>

	* src/gsad_omp.c (new_note): Code cleaned.

2012-11-21  Hani Benhabiles <kroosec@gmail.com>

	New schedule object management implementation.

	* src/gsad.c (exec_omp_get): new commands: export_schedule and
	export_schedules. Also checks for new_schedule command now.
	(init_validator): Added export_schedule and export_schedules commands.

2012-11-21  Hani Benhabiles <kroosec@gmail.com>

	* src/html/gsad.xsl (sync_scap_response): Added SCAP Synchronization
	template for response indicator.

2012-11-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_tasks): Match create_task_response, for cloning.

2012-11-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-task-table): Widen actions column.
	(task): Make start icon margins consistent.  Introduce standard icons.

2012-11-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (contents.html): Add New Task.  Rename Reports to
	Task Details and Reports.
	(reports.html): Remove.  Now task_details.html.
	(task_details.html): New template.  Was reports.html.  Update jump
	link.  Rename header.

2012-11-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator, exec_omp_get): Add export_task and
	export_tasks.

	* src/gsad_omp.c (export_task, export_tasks): New functions.

	* src/gsad_omp.h: Add headers accordingly.

2012-11-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task [details]): Rename Task Summary to Task
	Details.  Introduce new style icons.

2012-11-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_tasks_args): Remove.  Merged into only caller.
	(get_tasks): Add get_task_args body.  Remove commands arg.  Callers all
	now do this themselves.

2012-11-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (run_wizard_omp): Run the OMP directly, and use
	next_page.

	* src/html/gsad.xsl (html-gsa-logo): Adjust indicator path accordingly.

2012-11-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_container_task_omp): Run the OMP directly, and
	use next_page.

2012-11-20  Matthew Mundell <matthew.mundell@greenbone.net>

	Separate get_task handling from get_tasks, and simplify some of the
	tasks page handlers.

	* src/gsad.c (init_validator, exec_omp_get): Add get_task.
	(exec_omp_post): Remove get_tasks, which is in exec_omp_get.

	* src/gsad_omp.c (omp_success, omp): Move up in file.
	(next_page): Add get_task.
	(resource_action): New function.
	(create_report_omp): Combine cases.  Use next_page instead of get_task
	function.
	(delete_task_omp, delete_report_omp): Switch to delete_resource.
	(CHECK): New macro.
	(save_task_omp): Use omp and next_page.
	(save_container_task_omp): Add get_task calls temporarily.
	(stop_task_omp, pause_task_omp, resume_paused_task_omp)
	(resume_stopped_task_omp, start_task_omp): Switch to resource_action.
	(get_info): Adjust formatting.
	(get_tasks_args): Remove task_id arg and case.
	(get_task): New function.  Like get_tasks_args task_id case.
	(get_task_omp): New function.
	(run_wizard_omp): Adjust get_tasks_arg call.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/gsad.xsl (html-gsa-logo): Adjust indicator paths accordingly.

	* src/html/omp.xsl: Replace all get_tasks links that have task_ids with
	get_task links.
	(html-report-table): Remove, now task.
	(task [details]): New template.  Was html-report-table.  Adjust paths
	to be like other details templates.
	(report): Add next to delete icon.
	(get_tasks_response): Remove single task case.
	(get_task): New template.
	(get_tasks): Match delete_task_response.

2012-11-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_my_settings): Make Wizard Rows odd.

2012-11-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add missing separators to last commit.

2012-11-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add pretty names to types.

	* src/html/omp.xsl (html-create-filter-form)
	(html-edit-filter-form): Expect pretty type names.

2012-11-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (quick-first-scan-wizard): Correct text about when
	the wizard appears.

2012-11-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_task_omp): Get the tasks with get_tasks instead
	of by hand.

	* src/html/gsad.xsl (html-gsa-logo): Adjust indicator path accordingly.

2012-11-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_target): Request tasks, so that "Tasks using this
	Target" show up.

2012-11-15  Benhabiles Hani <kroosec@gmail.com>

	* src/gsad_omp.c (get_target): Removed old code. Now uses get_one().

2012-11-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/wizard.xsl (quick-first-scan-wizard): Set refresh_interval to
	30.

2012-11-15  Hani Benhabiles <kroosec@gmail.com>

	* src/html/help.xsl (list-window-line-actions): Fixed icone for Clone
	action.

2012-11-15  Andre Heinecke <aheinecke@intevation.de>

	* src/gsad_omp.c (get_info): Fix coding style.

2012-11-15  Andre Heinecke <andre.heinecke@greenbone.net>

	* src/gsad_omp.c (get_info): Set a default filter for CVE

2012-11-15  Andre Heinecke <andre.heinecke@greenbone.net>

	* src/html/omp.xsl (cve-details): Add gb_window classes. Add list icon.
	Change style of the upper right information to be in line with the rest.

2012-11-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (host): Use a filter instead of multiple
	parameters in the Last Report link.  Within the filter use the new
	exact term syntax for the IP, so that the filter matches only that
	single IP.

2012-11-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [assets]): Use a filter instead of multiple
	parameters in the Last Report link.  Within the filter use the new
	exact term syntax for the IP, so that the filter matches only that
	single IP.

2012-11-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (powerfilter.html): Add example for exact term.
	Clarify what the substring term example will match.

2012-11-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (powerfilter.html): Add empty and N/A example and
	syntax.

2012-11-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (powerfilter.html): Add Date Format section.

2012-11-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (powerfilter.html): Improve text slightly.

2012-11-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-logo): Remove duplicate
	delete_report_format response indicator.

2012-11-13  Andre Heinecke <andre.heinecke@greenbone.net>

	Add CVE Browse mode.

	* src/html/gsad.xsl (html-gsa-navigation): Add CVE entry in SecInfo Menu.

	* src/html/help.xsl (contents.html): Add link to cves.html help page.
	(cves.html): New. Help Page for CVE browser.
	(cve.html): Updated to reflect that cve is no longer obtained by lookup.
	(glossary.html): Add short entry about CVSS.

	* src/html/omp.xsl (info/cve): New. Table contents of CVE Table.
	(get_info_cve_lnk): Add details parameter.
	(html-cve-table): New. The main CVE browse table.
	(get_info_response): Use the new templates for CVE.
	(cve-details): Updated to work with new get_info structure.

	* src/html/dialog.xsl (browse_infosec.html): Remove CVE Lookup.

2012-11-12  Matthew Mundell <matthew.mundell@greenbone.net>

	Use the next_page facility when importing reports.  In the process this
	ensures that the observers are included in the Tasks page following the
	import; thanks to Felix Wolfsteller for spotting this.

	* src/html/omp.xsl (html-report-table, html-edit-task-form)
	(new_task): Add next arg to create_report form.
	(get_tasks): Match create_report_response.

	* src/html/gsad.xsl (html-gsa-logo): Adjust create_report indicator
	path.

	* src/gsad_omp.c (next_page): Add get_tasks.
	(create_report_omp): For the second case, let next_page handle the next
	page, instead of doing the GET_TASKS OMP by hand.
	(get_tasks_args): New function.  Body from get_tasks.  Adjust all
	get_tasks callers to call this instead.
	(get_tasks): Reduce params to match similar functions.  Call through to
	get_tasks_args.
	(get_tasks_omp): Just call get_tasks.

2012-11-07  Hani Benhabiles <kroosec@gmail.com>

	* ChangeLog: Fixed formatting issues from last updates.

2012-11-07  Hani Benhabiles <kroosec@gmail.com>

	* src/html/oap.xsl: Added describe_scap_response, html-scap-response and
	sync_scap_response templates.

	* src/html/help.xsl: Added scap_management.html template.

	* src/html/gsad.xsl: Added SCAP Feed submenu.

2012-11-07  Hani Benhabiles <kroosec@gmail.com>

	* src/gsad.c (init_validator): Added entries for get_scap and sync_scap.
	(exec_omp_post): Added entry for sync_scap.
	(exec_omp_get): Added entry for get_scap.

	* src/gsad_oap.h: Added get_scap_oap and sync_scap_oap.

	* src/gsad_oap.c: Added get_scap_oap and sync_scap_oap.

2012-11-07  Hani Benhabiles <kroosec@gmail.com>

	* src/gsad.c (content_type_from_format_string): Small documentation fix
	in r14449.

2012-11-07  Hani Benhabiles <kroosec@gmail.com>

	* src/gsad.c (token_user): Fixed return value when a bad token is
	provided.

2012-11-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-override-form): Add fragment to
	save_override form action so that position stays on result.  Add
	filter params.  Reduce the number of pass-through params, getting them
	from the envelope instead of the current context.

2012-11-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (contents.html): Add Overrides subpages.
	(new_override.html, override_details.html): New templates.
	(overrides.html): Add list icon link.  Match to new style.

2012-11-06  Matthew Mundell <matthew.mundell@greenbone.net>

	Make the New Override page function "standalone", so it works from the
	New Override icon on the Overrides page.

	* src/gsad.c (init_validator): Add params for manual override field
	entry.

	* src/gsad_omp.c (new_override): New function.  Body from
	new_override_omp.  Add extra_xml arg.  Remove param checks because there
	might just the new style filter params.  Add a new case for the
	standalone New Override page, which gets the tasks.
	(new_override_omp): Call through to new_override.
	(create_override_omp): Add param check gaurds.  Check if override params
	have been entered in the manual params.  Call the CREATE_OVERRIDE
	directly instead letting the handler for the next page do it.  Choose
	next page more automatically.

	* src/html/omp.xsl (html-create-override-form): Add new filter params to
	form.  Get next from envelope so any caller can specify it.  Correct
	name of task_id param.  Add missing apply_overrides param.  Add cases
	for manual entry of fields, for standalone page.  Make Associated Result
	sectional conditional.  Add list icon.  Update help link.
	(new_override): Match create_override_response too.
	(result-detailed): Add apply_overrides and next to New Override links.

2012-11-06  Matthew Mundell <matthew.mundell@greenbone.net>

	Add trashcan feature to overrides.

	* src/gsad.c (init_validator, exec_omp_post): Add delete_trash_override.

	* src/gsad_omp.c (delete_trash_override_omp): New function.
	(get_trash): Get trash overrides too.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/gsad.xsl (html-gsa-logo): Update indicator paths and add
	missing cases.

	* src/html/omp.xsl (override [trash], html-overrides-trash-table): New
	templates.
	(override-detailed-delete-params): Remove.
	(override-detailed): Replace delete icon with trashcan.  Add clone icon.
	Update icon and Report links.
	(get_trash): Add overrides.

2012-11-06  Matthew Mundell <matthew.mundell@greenbone.net>

	Add filtering to overrides.

	* src/gsad.c (init_validator): Add override to resource types.
	Add export_overrides.
	(exec_omp_get): Add export_overrides.

	* src/gsad_omp.c (next_page): Add overrides commands.
	(export_overrides_omp): New function.
	(get_overrides, delete_override_omp, edit_override_omp): Switch to
	generic function.  Adjust callers.
	(get_override): Add extra_xml arg and override_id check.  Adjust
	callers.
	(edit_override): New function.
	(save_override_omp): Use omp and next_page conveniences.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/omp.xsl (html-report-table, nvt): Replace overrides section
	with link to overrides.
	(override): Use list-window-line-icons.
	(override [nvt-details]): Remove.
	(override [details]): Use details-header-icons and minor-details.
	(html-overrides-table): Call list-window.
	(get_overrides): Apply like the other commands.

2012-11-05  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump to 4.0+beta5.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2012-11-05  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 4.0+beta4 release.

	* CHANGES: Updated.

2012-11-02  Andre Heinecke <aheinecke@intevation.de>

	* src/html/omp.xsl (html-create-alert-form): Replace verinice.PRO ip /
	port by url. Consistently use the name verinice.PRO.

2012-11-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (html-create-note-form, html-create-override-form):
	Added a clearifying hint what is meant with the Result UUID.

2012-11-02  Michael Wiegand <michael.wiegand@greenbone.net>

	* CHANGES: Prepared for the next beta release.

2012-11-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (info/cpe): Change String for NULL from
	"Not Available" to the shorter "N/A".

2012-11-01  Michael Wiegand <michael.wiegand@greenbone.net>

	* INSTALL: Update reference system section and prerequisites, update
	instructions to use out-of-source building, add missing target.

2012-11-01  Michael Wiegand <michael.wiegand@greenbone.net>

	Update targets for out-of-source builds.

	* doc/CMakeLists.txt: Update commands and targets to work with
	out-of-source builds.

	* doc/Doxyfile.in: Updated to work with out-of-source builds,
	harmonized with other modules.

	* doc/Doxyfile_full.in: Harmonized with Doxyfile.in.

	* src/CMakeLists.txt: Ensure that the target "splint", "rats",
	"flawfinder", "etags" and "ctags" work with out-of-source builds.

2012-11-01  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/omp.xsl (html-create-alert-form): Add support for creating
	a verinice .PRO server connector alert.

2012-10-31  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_note_omp): Remove next var as next is now done
	via next_page.

2012-10-31  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-schedule-form): Correct help link.

	* src/html/help.xsl (configure_schedules.html): Add Edit Schedule
	action.

2012-10-30  Matthew Mundell <matthew.mundell@greenbone.net>

	Add editing of schedules.

	* src/gsad.c (init_validator, exec_omp_get, exec_omp_post): Add
	edit_schedule and save_schedule.  Add timezone validator.

	* src/gsad_omp.c (next_page): Add get_schedules.
	(edit_schedule, edit_schedule_omp, save_schedule_omp): New functions.

	* src/gsad_omp.h: Add headers accordingly.

	* src/html/omp.xsl (html-schedule-table)
	(html-schedules-trash-table): Remove unit.  Units are in the column.
	(modify_schedule_response, schedule-select-options)
	(html-edit-schedule-form, edit_schedule): New templates.
	(schedule): Add edit icon.

2012-10-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (schedule): Update next_time check and format
	next_time like the other cases.

2012-10-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (schedule [details]): Match field names to Schedules
	page columns.  If the schedule is over just put a - for Next Time.

2012-10-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (gsa:date-tz, gsa:long-time-tz): New functions.
	(html-report-table, schedule, schedule [details]): Append timezone to
	schedule times.  Add timezone field to Schedule Details.

	* src/html/help.xsl (configure_schedules.html): Add timezone.

2012-10-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* ChangeLog: End every sentence with a full stop.

2012-10-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (powerfilter.html): Simplify first sentence.
	Describe usual default.  Add example with new special columns.  Add
	subsection for Column Keywords, with info about possible column names.
	Add subsection for Special Keywords, with new ones.

	* src/html/omp.xml (filter-window-part, html-report-details): Add help
	link alongside filter field.

2012-10-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (new_task): Default to 1 alert instead of 2.

2012-10-25  Andre Heinecke <aheinecke@intevation.de>

	* src/html/omp.xsl (get_info_response): Show cpe-table also when no
	cpe's are found. Handle scap DB not loaded.

2012-10-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_agents_response, get_filters, get_targets): Add
	fail status dialog.

2012-10-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/wizard.xsl (quick-first-scan-wizard): Specify UUID for
	setting, else it just gets the first one.

2012-10-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-alert-form): Make the filter ID for "--"
	"0" so that it validates.

2012-10-19  Andre Heinecke <aheinecke@intevation.de>

	* src/html/omp.xsl (wrap): Add linebreak to the default marker.

2012-10-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): Pass details flag with getting the
	"assets" report for a single host.

2012-10-18  Andre Heinecke <aheinecke@intevation.de>

	Do not jump to filter page after adding a filter for CPE.

	* src/gsad_omp.c (get_info): Renamed get_info_omp to get_info.
	(get_info_omp): New.  Wrapper around get_info without extra_xml.
	(next_page): Call get_info for get_info next.
	* src/gsad_omp.h: Add header accordingly.
	* src/html/omp.xsl (filter-window-pager): Add extra_params to new filter
	form.

2012-10-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (openvas_append_xml): Remove.  Now xml_string_append in
	libraries.  Update all calls to new name.

2012-10-15  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Renamed menu item "Lookup".

	* src/html/dialog.xsl (browse_infosec.html): Removed entry field for CPE because this
	is handled in the new CPE management.

	* src/html/help.xsl: Moved details on CPE elements to glossary.

2012-10-15  Andre Heinecke <aheinecke@intevation.de>

	Add CPE Overview table with filtering

	* src/gsad_omp.c (get_many): Add extra_attribs parameter. Handle non
	countable type info. Update callers.
	(get_info): Removed.
	(get_info_omp): Call get_many with the appropiate extra_attribs

	* src/gsad.c (init_validator): Add validators for info_id and details,
	allow filters of type info.

	* src/html/omp.xsl: Include exslt common.
	(gsa:date): New. Convert ISO date to just the date without time.
	(gsa:type-many): New. Get the plural form of a type.
	(filter-window-pager): Add optional extra_params parameter to include in
	generated links.
	(filter-window-part): Add optional extra_params parameter to add as hidden
	form fields. Expects a node-set.
	(wrap, wrap-line): Add params width and marker to specifiy the width
	and symbol used for breaking a line.
	(column-name): Add extra_params parameter to include in generated links.
	(info/cpe): New. Generate table rows for CPE table.
	(get_info_cpe_lnk): Wrap the text part of the link.
	(html-cpe-table): New. Generate an overview table for CPE.
	(get_info_response, cve-details): Handle new response style.
	(cpe-details): Expand with new information. Update Style.
	(html-create-filter-form, html-edit-filter-form): Allow filters of type
	info.

	* src/html/gsad.xsl (html-gsa-navigation): Add link to CPE.

	* src/html/help.xsl (contents.html): Remove misplaced links to CPE and
	CVE. Add link to cpes doc.
	(cpe.html): Expand and update documentation of CPE Details page.
	(cpes.html): New. Document CPE overview table.

	* src/html/dialog.xsl (browse_infosec.html): Add details parameter to
	lookup requests.

2012-10-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-filter-form)
	(html-create-target-form): Add filters to list icon link.
	(html-create-note-form): Add list icon.
	(html-targets-table): Add filter to New Target link.

2012-10-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (list-window-line-actions): New template.
	(contents.html): Add Notes subpages.
	(filters.html): Use template for filtering section.
	(new_note.html, note_details.html): New template.
	(notes.html): Add list icon link.  Match to new style.

	* src/html/omp.xsl (html-create-note-form): Update help link.

2012-10-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (note [nvt-details]): Remove.  NVT Details just has
	link to notes now.

2012-10-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (host): Remove extra opening xsl:if.

2012-10-11  Matthew Mundell <matthew.mundell@greenbone.net>

	Clear out more of old filter param handling.

	* src/gsad.c (init_validator): Add report_result_id.

	* src/html/gsad.xsl (html-gsa-logo): Apply missing note response
	indicators.

	* src/html/omp.xsl (html-report-details, html-create-note-form)
	(html-edit-note-form, note-detailed, result-details)
	(result-detailed): Remove old filter params, making sure that new params
	and the overrides flag are always included.  Also add param
	report_result_id for the Result Details page because in some cases the
	result to return to on the report is different from the result being
	viewed on the details page.
	(get_delta_result): Apply responses from note operations.

2012-10-11 Michael Meyer <michael.meyer@greenbone.net>

	* src/html/omp.xsl (host):
	 Added MAC address, IP, Interface name of all interfaces to be
	 displayed in the hardware section.

2012-10-09  Matthew Mundell <matthew.mundell@greenbone.net>

	Clear out most of old filter param handling in notes.

	* src/gsad_omp.c (next_page): Add get_note.
	(clone_omp): Improve comments slightly.
	(get_result): Remove old filter params.
	(get_note): Add extra_xml arg.  Update caller.
	(edit_note): New function.  Body from edit_note_omp.  Add extra_xml arg.
	Remove old filter params.  Remove checks of params for following pages,
	the pages can do those checks.
	(edit_note_omp): Call through to edit_note.
	(save_note_omp): Remove old filter params.  Remove Task and NVT page
	cases.  Replace per-page cases with a single case that lets next_page
	sort out the next page.

	* src/html/omp.xsl (list-window-line-icons, html-create-note-form)
	(html-edit-note-form, note-detailed, result-details)
	(result-detailed): Remove old filter params, ensuring that the
	overrides and autofp flags are still passed around.  Get more params
	from /envelope/params.
	(note-detailed-delete-params): Remove.  Was for old filter params.

2012-10-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_result_page): Remove attempt at sorting.  Covered
	by Manager now.

	* src/html/gsad.xsl (html-gsa-navigation): Add filter to notes link so
	that sorting is by nvt.  This is required because the name column in
	notes is replaced by the NVT column.  If sorting is by the default,
	name, then clicking on NVT will "switch to" NVT, leaving the sorting
	the same on the first click.

	* src/html/omp.xsl (html-report-table, nvt): Ditto.

	* src/html/help.xsl (notes.html): Ditto.

2012-10-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (trashcan-icon): Add fragment arg.
	(html-edit-note-form, note-detailed, result [details]): Add result-id
	fragment to note icons, so that the view stays on the current result
	after the operation.

2012-10-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-note-form): Bold the NVT field and make
	the value a link, to match the edit page.  Hide the Associated Result
	section for the standalone page.

2012-10-06  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (host): Added MAC address to be displayed in the
	hardware section if there was one identified.
	Patch developed by Michael Meyer.

2012-10-06  Matthew Mundell <matthew.mundell@greenbone.net>

	Make the New Note page function "standalone", so it works from the New
	Note list on the Notes page.

	* src/gsad.c (init_validator): Add params for manual note field entry.

	* src/gsad_omp.c (new_note): New function.  Body from new_note_omp.  Add
	extra_xml arg.  Remove param checks because there might just the new
	style filter params.  Add a new case for the standalone New Note page,
	which gets the tasks.
	(new_note_omp): Call through to new_note.
	(omp_success, omp): New functions.
	(create_note_omp): Add param check gaurds.  Check if note params have
	been entered in the manual params.  Call the CREATE_NOTE directly
	instead letting the handler for the next page do it.  Choose next page
	more automatically.

	* src/html/omp.xsl (list-window): Add missing filt_id param to link.
	(html-create-note-form): Add new filter params to form.  Get next from
	envelope so any caller can specify it.  Correct name of task_id param.
	Add missing apply_overrides param.  Add cases for manual entry of
	fields, for standalone page.
	(new_note): Match create_note_response too.
	(result-detailed): Add apply_overrides and next to New Note links.

2012-10-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (delete_resource): Pick the next page if "get" is NULL.
	(delete_note_omp): Let delete_resource decide on the next page.

2012-10-04  Matthew Mundell <matthew.mundell@greenbone.net>

	Add trashcan feature to notes.

	* src/gsad.c (init_validator, exec_omp_post): Add delete_trash_notes.

	* src/gsad_omp.c (next_page): Add get_result case.
	(get_report_page): New function.
	(get_result): Add extra_xml arg.  Update callers.
	(get_result_page): New function.  Suitable for delete_resource callback.
	(delete_note_omp): Pick callback according to next param.
	(delete_trash_note_omp): New function.
	(get_trash): Get trash notes too.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/gsad.xsl (html-gsa-logo): Update indicator paths and add
	missing cases.

	* src/html/omp.xsl (note [trash], html-notes-trash-table): New
	templates.
	(note-detailed): Replace delete icon with trashcan.  Add clone icon.
	Update icon and Report links.
	(get_trash): Add notes.

2012-10-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (export_targets_omp, export_notes_omp)
	(export_filters_omp): Correct type arg.

2012-10-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (nvt): Replace note list with a link to the notes
	page in the summary.

2012-10-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-table): Replace the note list with a
	link to the notes page in the summary.

2012-10-02  Matthew Mundell <matthew.mundell@greenbone.net>

	Update the note list icons and note details page to the new style.

	* src/gsad.c (init_validator, exec_omp_get): Add export_filters and
	export_notes.

	* src/gsad_omp.c (export_many): New function.  Body from export_targets.
	(export_targets): Call through to export_many.
	(export_notes_omp, export_filters_omp): New functions.
	(delete_note_omp): Correct type.
	(save_note_omp): Get the get_notes case working.

	* src/gsad_omp.h: Add headers accordingly.

	* src/html/omp.xsl (gsa:lower-case): New function.
	(list-window-line-icons, minor-details, details-header-icons): New
	templates.
	(list-window): Correct typo in Applied filter link.
	(filter, target, note): Call list-window-line-icons instead of doing
	them by hand.
	(filter [details], target [details], note [details]): Call
	details-header-icons and minor-details instead of doing them by hand.
	(html-edit-filter-form): Correct name and value of Filter ID param.
	(html-edit-target-form, html-edit-note-form): Add missing filter params.

2012-10-01  Matthew Mundell <matthew.mundell@greenbone.net>

	Add filtering to notes.

	* src/gsad.c (init_validator): Add note to resource types.

	* src/gsad_omp.c (next_page): New function.
	(delete_resource): Move up in file.
	(clone_omp, create_filter_omp): Let next_page decide which page is next,
	adding get_notes to previous options.
	(get_notes, delete_note_omp): Switch to generic function.  Adjust
	callers.

	* src/html/omp.xsl (html-notes-table): Call list-window.
	(get_notes): Apply like the other commands.

2012-09-26  Andre Heinecke <aheinecke@intevation.de>

	* src/html/help.xsl (contents.html): Change placement of SecInfo
	Management to be between Asset Management and Configuration.

	* src/html/gsad.xsl (html-gsa-navigation): Change placement of SecInfo
	Management to be between Asset Management and Configuration.

2012-09-26  Andre Heinecke <aheinecke@intevation.de>

	Make SecInfo Management the seventh top level menu item.

	* src/html/dialog.xsl (browse_infosec.html): Rename
	"Security Information Management" to "Lookup".

	* src/html/gsa-style.css (#gb_menu ul li a): Switch to new button width
	128px and adapt background position.

	* src/html/gsa-style.css (#gb_menu ul .first_button a)
	(#gb_menu ul .last_button a): Set width to 130px. Add > a to overwrite
	width only for the first link in the element.

	* src/html/gsa-style.css (#gb_menu ul li ul, #gb_menu ul li ul a)
	(#gb_menu ul li ul a): Expand submenu by 5px to avoid asymetric look with
	the new menu width.

	* src/html/gsa-style.css (#gb_menu ul li:hover a)
	(#gb_menu ul .last_button:hover a): Adopt background position.

	* src/html/help.xsl (browse_infosec.html): Rename from "Security Information
	Browser" to "Security Information Lookup".

	* src/html/help.xsl (contents.html): Move SecInfo Management to the top
	level of the contents index.

	* src/html/gsad.xsl (html-gsa-navigation): Move SecInfo from Extras to the
	top level.

	* style/top_menu_buttons.png:  First button and last button now
	have a width of 130px the other buttons are 128px.

2012-09-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (feed_management.html): Reword side effects to be
	clear that sometimes it can take a while.

2012-09-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_base.c (gsad_message): Add GSA version to error message.

2012-09-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (new_task.html): Add Observer, Asset Management and
	Scan Intensity columns.
	(tasks.html): Describe task comment and name column icons.

2012-09-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_trash): Get Contents backgrounds right.

2012-09-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsa-style.css (#list ul): Increase left margin so that sub
	items are easier to make out.

	* src/html/help.xsl (filtering): New template.  From filtering.html.
	(configure_alerts.html): Add filtering section.
	(contents.html): Add filtering subpages.
	(filters.html): Move filtering section out to template.

2012-09-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (contents.html, glossary.html): Add filters.
	(filter_details.html, filters.html, new_filter.html): New templates.

2012-09-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add filt_id to Report Summary
	refresh icon, so that the selected filter is kept.  Add overrides to new
	filter control forms so that the current "Apply overrides" state is
	used.

2012-09-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): Correct some defaults, so the "--" filter
	uses the same values as the initial filtering.

2012-09-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (filter): Remove old first and max URL params.

2012-09-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): In prognostic case check if
	GET_REPORT_FORMATS is enabled before calling, and get the filters for
	the dropdown.

2012-09-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_one): Add extra_attribs arg.
	(get_filter): Pass alerts="1" for GET_FILTER.

	* src/html/omp.xsl (filter [details]): Add list of Alerts that use the
	filter.

2012-09-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (file_content_response, request_handler): Free
	MHD_create_response_from_data return.

2012-09-13  Matthew Mundell <matthew.mundell@greenbone.net>

	Adjust for explicit Alert filters in OMP.

	* src/gsad_omp.c (create_alert_omp): Add filter.

	* src/html/omp.xsl (html-create-alert-form): Pass filter as explicit
	request param.
	(alert [trash]): Expect filter in explicit OMP element.  Make restore
	icon depend on whether filter is in trashcan.
	(alert [details]): Expect filter in explicit OMP element.
	(delete_filter_response): New template.
	(filter): Make trashcan icon depend on in_use instead of writable.

2012-09-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (attach_sid): Free tz.

	* src/validator.c (openvas_validator_alias): Remove leaky g_strdup.

2012-09-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-alert-form, alert [details]): Make filter
	a field of it's own, instead of a subfield of the mail case.
	(html-alerts-table, alert, alert [trash], html-alerts-trash-table): Add
	a filter column.

2012-09-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): Add extra_xml arg.  Update callers.
	(create_filter_omp): If the CREATE_FILTER fails then choose the next
	page according to the "next" param.  Remove done todo.  Pass response
	into get_report for success indicator.

	* src/html/gsad.xsl (html-gsa-logo): Add indicator for creating a filter
	in a report.

	* src/html/omp.xsl (get_report): Apply create_filter_response for error
	dialog.

2012-09-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-logo): Use right path for MODIFY_TARGET
	response indicator.  Add indicator for details page.

2012-09-10  Matthew Mundell <matthew.mundell@greenbone.net>

	Add report filtering to email alerts.

	* src/gsad_omp.c (create_alert_omp, delete_alert_omp, get_alerts_omp)
	(test_alert_omp): Call through to get_alerts instead of getting alerts
	and more in each.
	(get_alerts): New function.  Body from get_alerts_omp.  Get filters too.
	(get_alert_omp): Get filters too.

	* src/html/gsad.xsl (html-gsa-logo): Update delete_alert_response patch.

	* src/html/omp.xsl (html-create-alert-form): Add report filter field.
	(alert [details]): Display report filter for email alerts.
	(get_alerts): Pass filters to html-create-alert-form.

2012-09-06  Matthew Mundell <matthew.mundell@greenbone.net>

	Add new-style filtering to report page.

	* src/gsad.c (init_validator): Add reports to resource types.

	* src/gsad_omp.c (get_report): Add new-style filtering to GET_REPORTS
	call.  Get filters for filter switching dropdown.
	(create_filter_omp): Add the created filter to the params, so the next
	page uses the new filter.  Add get_report to next options.

	* src/html/omp.xsl (html-report-details): Add new-style filtering
	controls.
	(html-create-filter-form): Add report to resource types.
	(html-edit-filter-form): Increase term field width.  Add report to
	resource types.

2012-09-04  Matthew Mundell <matthew.mundell@greenbone.net>

	Add first class filters.

	* src/gsad.c (init_validator): Add filter commands and params.
	(exec_omp_post, exec_omp_post): Add filter commands.

	* src/gsad_omp.c (get_one, edit_resource, export_resource): New
	functions.  Generic page handlers.
	(get_many): Add filt_id to OMP GET.  Get the filters too.
	(clone_omp): Add get_filters.
	(get_config, get_config_family, get_config_nvt): Correct backurl.
	(get_trash): Get sort field from "params" instead of dedicated args.
	Update many callers.  Get filters too.
	(get_filter, get_filter_omp, get_filters, get_filters_omp, new_filter)
	(create_filter_omp, delete_resource, delete_trash_filter_omp)
	(delete_filter_omp, edit_filter, edit_filter_omp, export_filter_omp)
	(new_filter_omp, save_filter_omp): New functions.
	(CHECK): New define.

	* src/gsad_omp.h: Add headers accordingly.

	* src/html/gsad.xsl (create_filter_response, delete_filter_response)
	(modify_filter_response): New templates.
	(html-gsa-logo): Apply indicator icons.
	(html-gsa-navigation): Add filters.

	* src/html/omp.xsl (filter-window-part): Remove Reset button.  Add create
	field, switcher dropdown and list icon.
	(list-window, filters, create_filter_response, modify_filter_response)
	(filter, filter [trash], filter [details], html-filters-trash-table)
	(html-filters-table, html-create-filter-form, new_filter)
	(html-edit-filter-form, edit_filter, get_filter, get_filters): New
	templates.
	(column-name): Adjust for calling within for-each.
	(get_trash): Add filters.

2012-08-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (error_dialog): For the backurl link, check for
	the case where the token is the only parameter.

2012-08-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (SID_COOKIE_NAME): New define.  Rename cookie to be more
	unique.
	(struct gsad_connection_info): Remove quotes for name change.
	(attach_sid, remove_side, request_handler): Get name of SID cookie from
	define.

2012-08-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-task-table): Add refresh_interval and
	overrides to sorting links.

2012-08-22  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a Task Wizard page.  Add wizard and list icons to the New Task page.

	* src/gsad_base.h (params_t): Move up in file.
	(credentials_t): Add params.

	* src/gsad.c (exec_omp_post, exec_omp_get): Store request params in
	credentials.

	* src/gsad_omp.c (openvas_append_xml): Move up in file.
	(xsl_transform_omp): Pass all valid request params to XSL in ENVELOPE.
	(run_wizard_omp): Use separate variable for wizard params.  Get refresh
	interval from param.

	* src/html/gsad.xsl (params): New template.

	* src/html/help.xsl (tasks.html): Rename wizard.  Make wizard section
	suitable for dedicated wizard page.

	* src/html/omp.xsl (html-task-table): Add missing refresh_interval arg
	to links.  Remove apply-overrides param from template call.
	(new_task): Add wizard and list icons.  Add missing refresh_interval arg
	to link.

	* src/html/wizard.xsl (quick-first-scan-wizard): Remove apply-overrides
	arg as this is in ENVELOPE now.
	(wizard/quick_first_scan): New template.  Dedicated wizard page.

2012-08-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/oap.xsl, src/html/help.xsl: Replaced "consequences" by
	"side effects" for the sake of a more apropriate term.

2012-08-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a dedicated quick start wizard page.

	* CMakeLists.txt: Install wizard.xsl.

	* src/gsad.c (init_validator, exec_omp_get): Add wizard.

	* src/gsad_omp.c (wizard_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/gsad.xsl: Incluse wizard.xsl.

	* src/html/omp.xsl (html-task-table): Link wizard icon to new wizard
	page.  Replace wizard code with call to wizard template.

	* src/html/wizard.xsl: New file.  For wizards.  Move quick start wizard
	here.  Also display the actual 'Wizard Rows' value in the text instead
	of 10.

2012-08-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-task-table): Use "icon" for buttons, because
	that's what they're called in the help.

	* src/html/help.xsl (tasks.html): Add section about wizard.

2012-08-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-gsa-logo): Update path for run_wizard response
	indicator.

2012-08-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (run_wizard_omp): Escape param name and value for XML.

2012-08-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add force_wizard.

	* src/gsad_omp.c (get_tasks): Add params arg.  Adjust all callers.  Get
	Wizard Rows preference.  Pass force_wizard down to XML.
	(save_my_settings): Save Wizard Rows too.

	* src/html/omp.xsl (html-task-table): Add wizard icon.  Make wizard
	visibility depend on Wizard Rows and force_wizard.
	(get_my_settings, edit_my_settings): Add Wizard Rows.

2012-08-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (run_wizard_omp): Expect params in generic form.

	* src/html/omp.xsl (html-task-table): Send param in generic form.

2012-08-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-task-table): Improve English slightly.

2012-08-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (verify_report_format_omp): Let get_tasks do the
	command so the response comes out in the XML.

	* src/html/omp.xsl (get_tasks): Apply run_wizard_response.

2012-08-14  Matthew Mundell <matthew.mundell@greenbone.net>

	Add Immediate Scan wizard.  Based on patch by Jan-Oliver Wagner.

	* CMakeLists.txt: Install enchantress.

	* src/gsad.c (init_validator, exec_omp_post): Add run_wizard.

	* src/gsad_omp.c (run_wizard_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/gsad.xsl (run_wizard_response): New template.
	(html-gsa-logo): Apply run_wizard response indicator icon.

	* src/html/omp.xsl (html-task-table): Add wizard under table.
	(run_wizard_response): New template.

2012-08-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (openvas_append_xml): New function.
	(get_report, get_result, new_note_omp, edit_note_omp, new_override_omp)
	(edit_override_omp): Escape XML containing search phrase before sending.

2012-08-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (get_report): Send the GET_REPORTS OMP with the XML version
	of the send function so that the search phrase is escaped.

2012-08-06  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/enchantress.png: New.

2012-08-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): Add a fallback to the help case for when
	the help XSL transform fails.

2012-08-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (cve-details): Sort Vulnerable Products by Name.

2012-08-01  Matthew Mundell <matthew.mundell@greenbone.net>

	Enable the user to add or edit a task with any number of alerts.

	* src/gsad.c (init_validator): Remove alert_id_optional_2.  Add alerts
	and the hashtable version of alert_id_optional.
	(params_append_mhd): Add alert_id_optional to hashtable params.

	* src/gsad_omp.c (new_task, edit_task): Send number of alerts down to
	XSL.
	(create_task_omp, save_task_omp): Handle any number of alerts, instead
	of just two.

	* src/html/omp.xsl (html-edit-task-form): Show every alert, with link for
	adding more.
	(new-task-alert-select): New template.
	(new_task): Show two alerts, and a link for adding more.

2012-07-31  Matthew Mundell <matthew.mundell@greenbone.net>

	Add control of second alert to tasks.

	* src/gsad.c (init_validator): Add alert_id_optional_2 and alert_id_2.

	* src/gsad_omp.c (create_task_omp, save_task_omp): Pass second alert to
	manager.

	* src/html/omp.xsl (html-report-table): Display all alerts.
	(html-edit-task-form, new_task): Add second alert option.

2012-07-25  Matthew Mundell <matthew.mundell@greenbone.net>

	Add the new "Add results to Asset Management" task preference.

	* src/gsad.c (init_validator): Add in_assets.

	* src/gsad_omp.c (create_task_omp, save_task_omp)
	(save_container_task_omp): Add in_assets to task preferences in OMP
	command.

	* src/html/omp.xsl (html-report-table, html-edit-task-form, new_task): Add
	in_assets fields.

2012-07-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (get_many): If the filter is empty then add "row=-2", so that
	Rows Per Page rows are returned, because Manager now returns all rows.

2012-07-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add summary.

	* src/gsad_omp.c (save_report_format_omp): Get summary from "summary"
	instead of "comment", to all quotations in the summary.

	* src/html/omp.xsl (html-edit-report-format-form): Rename field to
	"summary".

2012-07-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl (tasks.html): Added hint that paused scans will have
	impact on overall performance.

2012-07-09  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad_omp.c (create_target_omp): Remove assigned but unused
	variable to address compiler warning.

2012-07-09  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt: Print a more useful message if both libxslt and the
	xsltproc binary cannot be found instead of failing silently.

2012-07-02  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/help.xsl: Fix a few typos in the help texts.

2012-06-27  Matthew Mundell <matthew.mundell@greenbone.net>

	Bring agents up to date with the GET filtering changes.

	* src/gsad_omp.c (create_agent_omp, delete_agent_omp): Use the get_agents
	function to get agents, so that the new filtering is right.

	* src/html/gsad.xsl (verify_agent_response): New template.
	(html-gsa-logo): Add missing agent responses.

	* src/html/omp.xsl (html-agents-table): Generate columns with column-name.
	(column-name): Take type as an argument so that any type can use this.
	Remove old max and first params.

2012-06-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Add back Alerts which Jan
	removed in r13634 on 2012-06-20.

2012-06-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (filter-window-pager): Move first and max params into
	filter.
	(filter-window-part): Rename Apply to Update Filter.  Remove First and
	Rows fields.
	(column): Use new TARGET/SORT to determine the current sorting.  Just put
	the sort= on the front of the filter, instead of doing complex parsing,
	because the manager now removes duplicates.

2012-06-20  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (html-targets-table): Have "Applied Filter"
	span over full table to avoid wrapping.

2012-06-20  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/gsa-style.css: Added menu item style that is indented.

	* src/html/gsad.xsl (html-gsa-navigation): Move Port Lists up,
	indented Port Lists and Credentials as they are sub-elements of
	a Target. Moved Agents to end of menu and therefore simplified
	code regarding "last" element.

2012-06-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (column-name): In both "some other column" cases sort
	ascending.

2012-06-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsa-style.css (.gbntablehead2 a:focus): Separate from a:hover
	rule so that browser applies .gbntablehead2 to a:focus too.

2012-06-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-targets-table): Note the current filter at the
	end of the table.

	* src/html/gsa-style.css (.footnote): New class for note.

2012-06-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (column-name): Rename asc and desc in filter to sort
	and sort-reverse.

2012-06-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Allow newlines in preference:value, because
	the value could be a file.

2012-06-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsa-style.css (.gbntablehead2 a): New rules.

	* src/html/omp.xsl (column-name): New template.
	(html-targets-table): Make column headings sorting links.

2012-06-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (edit_task): Check if commands are enabled before using.

2012-06-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_target_omp): Only check port when SSH credential
	is given.

2012-06-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-target-form): If the port is empty make it
	22.

2012-06-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result-detailed): Add References for second result in
	delta "changed" case.

2012-06-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Match PDF report for Download
	column by name instead of ID, because the ID changes.

2012-06-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_oap.c (xsl_transform_omp): Add capabilities.

2012-06-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl: Add a show_closed_cves param everywhere that there is
	a autofp param.

	* src/gsad_omp.c (get_result): Add autofp arg.
	(get_result_omp): Pass show_closed_cves param to get_result.
	(new_note_omp, create_note_omp, delete_note_omp, edit_note_omp)
	(save_note_omp, new_override_omp, create_override_omp)
	(delete_override_omp, edit_override_omp, save_override_omp): Add
	show_closed_cves params alongside autofp params.

2012-06-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (view_report.html): Update Back to Tasks link text.

	* src/html/omp.xsl (report [details]): Do token in links in Closed CVEs
	table with a variable because they're inside a for-each.

2012-06-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): Pass show_closed_cves to Manager now that
	there is OMP support for this.  Remove SHOW_CLOSED_CVES from XML because
	it's in the OMP report now.

	* src/html/omp.xsl (html-report-details): Add show_closed_cves params to
	alert and download columns.  Update checks for Closed CVEs checkbox and
	table to use OMP value of SHOW_CLOSED_CVES.

2012-06-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add autofp param to download
	column.

2012-06-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add autofp param to report
	links in delta report.

2012-06-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Hide "Show Closed CVEs" checkbox
	for delta reports.  The OMP report currently holds the host details for
	the first report only.  It will take some pain to add the second report
	host details.  For now the user can go to the report via the links in the
	summary to see the closed CVEs for that report.
	(report [details]): Init other case of delta arg.  Hide Closed CVE table
	for delta case.

2012-06-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [details]): Specify the report that the closed
	CVEs belong to.

2012-06-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): Pass autofp to the alert OMP command
	instead of a special esc_autofp param, because they would always be the
	same.

	* src/html/omp.xsl (html-report-details): Add autofp params for Run Alert
	column.

2012-05-31  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [details]): List Closed CVEs by CVE instead of
	by NVT.

2012-05-31  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (host): Add commented table of all host details.
	(report [details]): Put NVT name in Closed CVE table instead of OID.

2012-05-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_result): Add autofp to OMP command.

2012-05-22  Matthew Mundell <matthew.mundell@greenbone.net>

	Get passing around of autofp working again.

	* src/gsad.c (init_validator): Add 2 to autofp rule.

	* src/gsad_omp.c (get_report): If autofp is 2 then make autofp_value
	2.

2012-05-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [details]): Adjust closed CVE section for
	revised location of these CVEs in the host details.

2012-05-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [details]): Add CVEs from source descriptions
	to table of closed NVTs.

2012-05-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add show_closed_cves.

	* src/gsad_omp.c (get_report): Add SHOW_CLOSED_CVES to XML.

	* src/html/omp.xsl (html-report-details): Add "Show closed CVEs" checkbox.
	(report [details]): Add "Show closed CVEs" section.

2012-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_info_cve_lnk): Strip space from CVE, otherwise the
	links are broken.

2012-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-target-form): Get hosts from OMP response
	in the "no target locators" case too.

2012-05-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Get the full/partial CVE filter working.

	* src/gsad.c (init_validator): Add autofp_value.

	* src/gsad_omp.c (get_report): Pass autofp_value in GET_REPORTS instead
	of 1 or 0.

	* src/html/omp.xsl (html-report-details): Make the "Trust vendor" radio
	depend the autofp value.  Rename it to autofp_value.
	(report [details]): Add commented "All host details" section.

2012-05-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [details]): Add "NVTs closed by updates" section
	for each host, as a start towards putting the closed CVEs there.  This is
	all the info available in the report itself.

2012-05-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): Remove extra GET_REPORT, as it looks like
	the XSL stopped using this at some point.

2012-05-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add autofp arg to paging links.

2012-05-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Rework auto-fp control layout
	a bit.

2012-05-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (powerfilter.html): Add date examples.

2012-05-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl: Add autofp param to all get_report links, and to all
	links that could return to get_report.

2012-05-14  Matthew Mundell <matthew.mundell@greenbone.net>

	Start Auto FP support.  Slight modification of patch from Henri Doreau.

	* src/gsad.c (init_validator): Add autofp.

	* src/gsad_omp.c (get_report): Pass autofp param through to Manager.

	* src/html/omp.xsl (html-report-details): Add Auto FP checkbox.
	(get_result, get_results_omp, new_note_omp, create_note_omp)
	(delete_note_omp, edit_note_omp, save_note_omp, new_override_omp)
	(create_override_omp, delete_override_omp, edit_override_omp)
	(save_override_omp): Add autofp param.

2012-05-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (filter-window-pager): New template.
	(html-agents-table): Add pager to filter window.
	(html-targets-table): Call filter-window-pager to produce the pager.

2012-05-04  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump to 4.0+beta4.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2012-05-04  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 4.0+beta3 release.

	* CHANGES: Updated.

2012-05-04  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/help.xsl: Fixed icon inconsistency.

2012-05-03  Matthew Mundell <matthew.mundell@greenbone.net>

	Get GSA working better when certain commands are disabled in Manager.

	* src/gsad_omp.c (new_task, get_tasks, get_report): Check if commands are
	enabled before sending.

	* src/html/gsad.xsl (html-gsa-navigation): Add GET commands to New Task
	requirements.

	* src/html/omp.xsl (html-task-table): Test for required commands before
	adding New Task button.

2012-05-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (command_enabled): New function.
	(get_trash): Check if command is enabled before sending.

	* src/html/omp.xsl (get_trash): Include enabled resources only.

2012-05-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl: Add availability check to many pages.
	(availability): New template.

2012-05-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (target [details]): Add creation date.  Make right hand
	column a table for neatness.

2012-05-03  Matthew Mundell <matthew.mundell@greenbone.net>

	Add OMP capabilities support.  Match the menu to the capabilities of the
	manager.

	* src/gsad.c (struct user, user_add): Add capabilities.
	(exec_omp_post): Setup user capabilities, handle new return.
	(request_handler): Setup credential capabilities.  Add to envelope.

	* src/gsad_base.h, src/gsad_omp.h (credentials_t): Add capabilities.

	* src/gsad_omp.c (xsl_transform_omp): Add capabilities to envelope.
	(authenticate_omp): Add capabilities return arg.  Get capabilities from
	manager.

	* src/html/omp.xsl (html-gsa-navigation): Check if menu items are
	supported before including them.
	(help_response): New template.

2012-05-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (target [details]): Add "Last Modified".

2012-04-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsa-style.css: Remove underline from link text decoration.
	Show underline on mouse-over.

2012-04-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-targets-table): Offset the export icon slightly
	from the others.
	(target): Make the target name a link to Target Details.  Use the clone
	image for the clone icon.  Add per-target export icon.

2012-04-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (filter-window-part): New template.
	(html-agents-table): Add filtering controls.
	(html-targets-table): Call filter-window-part to add filtering controls.

2012-04-25  Matthew Mundell <matthew.mundell@greenbone.net>

	Add cloning of targets.

	* src/gsad.c (init_validator): Add clone to commands.  Add id and
	resource_type validators.
	(exec_omp_post): Add clone.

	* src/gsad_omp.c (CHECK): New macro.
	(clone_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/omp.xsl (target): Add Clone icon.

2012-04-25  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump to 4.0+beta2.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2012-04-25  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 4.0+beta2 release.

	* CHANGES: Updated.

2012-04-25  Michael Wiegand <michael.wiegand@greenbone.net>

	Clean up CMake infrastructure and ensure that compilation with modern
	gccs works.

	* CMakeLists.txt: Remove setting of OPENVAS_LIB_INSTALL_DIR and
	OPENVAS_HEADER_INSTALL_DIR as they were never used and the information
	is retrieved via pkg-config now.

	* src/CMakeLists.txt: Move include_directories and link_directories to
	target_properties and target_link_libraries. Set link libraries via
	target_link_libraries and not via LINK_FLAGS since this breaks
	compilation with more modern gccs. Take the correct flags from
	pkg-config output.

	* INSTALL: Remove references to superfluous OPENVAS_LIB_INSTALL_DIR
	and OPENVAS_HEADER_INSTALL_DIR variables.

2012-04-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/clone.png: New.

	* CMakeLists.txt: Install new icon.

2012-04-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Update UUID of PDF report
	format.

2012-04-19  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a generic GET page handler, because the handlers for the types are
	basically the same.  Use the new handler for targets and agents.

	* src/gsad_omp.c (get_many, get_agents): New functions.
	(get_agents_omp): Call through to get_agents.
	(get_targets): Call through to get_many.

2012-04-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-targets-table): Add count to export tooltip.

2012-04-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (port_list): Make the trashcan icon depend on WRITABLE
	instead of IN_USE.

2012-04-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (target): Make the trashcan icon depend on WRITABLE
	instead of IN_USE.

2012-04-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (powerfilter.html): Improve slightly.  Add NOT.

2012-04-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-logo): Adjust for new path.

	* src/html/omp.xsl (get_targets): Adjust for new path.

2012-04-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-lsc-credential-form)
	(html-create-port_list-form): Move text and password inputs out of labels
	because Firefox 3.5 jumps to the associated radio when the input area is
	clicked.

2012-04-16  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (main): Updated Copyright years.

2012-04-16  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Post release version bump to 4.0+beta2.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2012-04-16  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Preparing the gsa 3.0+beta1 release.

	* CHANGES: Updated.

2012-04-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.c (target [details]): Indent icon section properly.  Add
	trashcan icon.

2012-04-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.c (target [details]): Add UUID where back link was.

2012-04-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (new_target.html): Add max to the new_target link,
	otherwise the empty value is interpreted as "all".
	(targets.html): Remove out of date section.

2012-04-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (new_targets.html, target_details.html)
	(targets.html): Describe new icons on target pages.  Correct typo.

2012-04-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (contents.html): Add powerfilter.
	(powerfilter.html): New template.
	(targets.html): Add filtering section and edit icon.

2012-04-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (CHECK): Go to right page on error.
	(save_target_omp): Only check port if there's an SSH credential.

2012-04-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (edit_target, get_target): Print pass through info
	with g_markup_printf_escaped.

	* src/html/omp.xsl (modify_target_response): New template.

	* src/html/gsad.xsl (modify_task_response [response-indicator]): New
	template.
	(html-gsa-logo): Match modify_task_response for indicator.

2012-04-11  Matthew Mundell <matthew.mundell@greenbone.net>

	Add editing of targets.

	* src/gsad.c (init_validator, exec_omp_post): Add edit_target and
	save_target.

	* src/gsad_omp.c (new_target): Pass filter params in.
	(create_target): Go to Target Details if target present.  Call get_targets
	instead of getting targets by hand.
	(create_target): Call get_targets instead of getting targets by hand.
	(edit_target, edit_target_omp, get_targets): New function.
	(get_target): Pass through filter params.
	(get_targets_omp): Call through to get_targets.
	(CHECK): New macro.
	(save_target_omp): New function.

	* src/gsad_omp.h: Add headers accordingly.

	* src/html/omp.xsl (html-create-target-form, html-targets-table): Add
	filter args to Targets icon and create_target form.
	(html-edit-target-form, edit_target): New templates
	(target, target [details]): Add filter args.  Add edit icon.

2012-04-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (edit_my_settings): Get setting from manager.
	(save_my_settings): Save Rows Per Page.

	* src/html/omp.xsl (edit_my_settings): Add Rows Per Page.

2012-04-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Allow max to be negative and empty.

	* src/gsad_omp.c (create_target_omp): Add max to GET_TARGETS.
	(get_targets_omp): If max is NULL use -2 instead of -1, to get the Rows
	Per Page rows instead of all rows.

	* src/html/omp.xsl (html-targets-table): Use -2 for max in reset, to get
	Rows Per Page rows instead of all.  When Rows is -1 make it empty, because
	that looks nicer.

2012-04-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_trash): Correct odds and evens.

2012-04-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_my_settings): Call OMP GET_SETTINGS.

	* src/html/omp.xsl (get_my_settings): Add Rows Per Page.

2012-04-04  Matthew Mundell <matthew.mundell@greenbone.net>

	Split targets configuration help into three pages.

	* src/html/help.xsl (configure_targets.html): Remove.
	(contents.html): Split targets link into three.
	(new_target.html, target_details.html, targets.html): New templates.
	Bodies from configure_targets.html.

	* src/html/omp.xsl (html-create-target-form, html-targets-table)
	(target [details]): Switch to new target help pages.

2012-04-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_targets_omp): Make max -1 if it fails instead of 10,
	so that it is possible to get all targets.

2012-04-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (target [details]): Remove Targets link.  Superseded by
	is a list icon.

2012-04-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-targets-table): Add reset button to filtering.

2012-04-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-targets-table): Add First field to filtering.

2012-04-02  Matthew Mundell <matthew.mundell@greenbone.net>

	Add new, list and export icons on Target Details page.

	* src/gsad.c (init_validator, exec_omp_get): Add export_target.

	* src/gsad_omp.c (new_target): Add target ID to XML for icon on Target
	Details page.
	(create_target_omp): If target ID present, go to Target Details page.
	(get_target): New function.  Body from get_target_omp.
	(get_target_omp): Pass through to get_target.
	(export_target_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/omp.xsl (html-gsa-logo): Add create_target indicator match for
	Target Details page.
	(html-create-target-form): Add new, list and export icons.

2012-04-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-targets-table): Add Rows field to filtering.

2012-04-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (CHECK): New macro.
	(save_config_omp): Respond with an error if name or comment is NULL,
	instead of with an internal error.

2012-03-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/upload.png: New.

	* CMakeLists.txt: Added handling of new icon.

2012-03-30  Matthew Mundell <matthew.mundell@greenbone.net>

	Add Targets pagination.

	* src/gsad.c (init_validator): Add first and max.

	* src/gsad_omp.c (get_targets_omp): Pass first and max to GET_TARGETS.

	* src/html/omp.xsl (html-targets-table): Add page control.

2012-03-28  Matthew Mundell <matthew.mundell@greenbone.net>

	Move the New Target window to a separate page.

	* src/gsad.c (init_validator, exec_omp_get): Add new_target.

	* src/gsad_omp.c (new_target, new_target_omp): New functions.
	(CHECK): Invoke new_target page instead of going through to get_targets.
	(create_target_omp): Pass filter through to GET_TARGETS.  If GET_TARGETS
	fails go to new_target instead of get_targets page.  Remove OMP that was
	for New Target window.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/omp.xsl (html-create-user-form): Add list icon to link to
	Targets page.  Pass filter through.
	(html-targets-table): Add New Target icon.  Correct export tooltip.
	(get_targets): Remove html-create-target-form.
	(new_target): New template.

2012-03-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_targets_omp): Send with openvas_server_sendf_xml as
	there may be XML in the filter.

2012-03-28  Matthew Mundell <matthew.mundell@greenbone.net>

	Add export of Targets.

	* src/gsad.c (init_validator, exec_omp_get): Add command export_targets.

	* src/gsad_omp.c (export_targets_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/omp.xsl (html-targets-table): Add export button to Targets.

2012-03-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add filter.

	* src/gsad_omp.c (get_targets_omp): Send filter through to manager.

	* src/html/omp.xsl (html-targets-table): Add filter section to Targets.

2012-03-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c, src/gsad_omp.c, src/gsad_omp.h, src/html/omp.xsl,
	src/html/gsad.xsl, src/html/help.xsl: Rename escalator to alert everywhere.

2012-03-28  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Post branch version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2012-03-28  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CMakeLists.txt, INSTALL: Set dependency for glib and gnutls
	to minimum of what openvas-libraries requires.

2012-03-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add ; and ' to comment.

2011-03-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number to 3.0.1.

	* src/html/help.xsl: Updated version number to 3.0.1.

2011-03-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Preparing the gsa 3.0.0 release.

	* CHANGES: Updated.

	* CMakeLists.txt: Updated version to 3.0.0.

	* src/html/help.xsl: Updated version number to 3.0.0.

2012-03-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (delete_user_oap): Add DESCRIBE_AUTH to commands, as this is
	needed for the Users page.

2012-03-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-note-form, note, note [details])
	(html-edit-override-form, override, override [details]): Explicitly print
	an explanation instead of an NVT name when the result was an open port.
	This is because the open port results come from the PORT OTP message and
	so lack an association with an NVT.

2012-03-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-report-format-form): Correct help link.

	* src/html/help.xsl (configure_report_formats.html): Correct anchor.  Add
	Edit Report Format action.
	(configure_users.html): Make wording a bit nicer.  Add note about roles.
	Add observer to list.

2012-03-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add , to observers now that it is accepted
	as a separator.

2012-03-16  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/help.xsl: Fixed case for consistency.

2012-03-16  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/help.xsl: Include examples of how to use ADS (domain\user)
	with new per-user-ldap authentication.

2012-03-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Ensure scan start is available
	before printing it, otherwise it ends up as NaNs.
	(get_report): Match create responses.  Needed after last commit, which
	moves location of these responses.

	* src/html/gsad.xsl (html-gsa-logo): Apply note and override create and
	delete indicator icon responses.

2012-03-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_note_omp, create_override_omp): Replace explicit
	fetching of report with call to get_report.

2012-03-15  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/oap.xsl: Match user (edit/details) in a commands_response,
	as these now have to include response to describe_auth, too.

	* src/gsad_oap.c (create_user_oap): Modify create-user command if
	enable_ldap_connect parameter is set and issue describe_auth.
	(save_user_oap): Include sources element in oap command and include
	desribe_auth command.
	(edit_user_oap): Include describe_auth command.
	(modify_auth_oap): Allow ldap_connect method, fixed typo in trace
	msg.

2011-03-15  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number to 3.0+rc2.

	* src/html/help.xsl: Updated version number to 3.0+rc2.

2011-03-15  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Preparing the gsa 3.0+rc1 release.

	* CHANGES: Updated.

	* CMakeLists.txt: Updated version to 3.0+rc1.

2012-03-15  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/oap.xsl (html-create-user-form): If per-user-ldap auth. is
	configured and enabled, allow to create a user with "ldap only"-
	option.
	(html-users-table, user): If per-user-ldap auth, add column to show
	if user is allowed to use ldap-auth only; allow modifications, too.
	(group): Include per-user-ldap-conf and link to help.
	(describe_auth_response): Match ldap_connect.

	* src/html/help.xsl: Added basic help for per-user ldap configuration.

2012-03-15  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad.c (init_validator): Added new validation target
	"enable_ldap_connect", allow "ldap_connect" for "group" parameter,
	allow "@" within login names for "user@domain"- scenarios.

2011-03-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/wizard.png: New.

	* CMakeLists.txt: Install new icon.

2012-03-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): Replace the UUID with a fixed string in the
	report name of the XML report, when it's a prognostic report.

2012-03-13  Matthew Mundell <matthew.mundell@greenbone.net>

	Add download of prognostic reports.

	* src/gsad_omp.c (get_report): Replace the UUID with a fixed string in the
	report name when it's a prognostic report.  Get the report formats when
	getting a prognostic report, for the dropdown box.

	* src/html/omp.xsl (html-report-details): Enable the Download column for
	prognostic reports.

2012-03-09  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/help.xsl: Removed double entries for scan config details
	  table.

2012-03-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add Download column.

2012-03-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-report-details): Add some space between the back
	arrows and the first number in the Filtered Results dialog heading.

2012-03-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-logo): Apply missing port list responses for
	indicator icon.

2012-03-06  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/help.xsl: Corrected typos (aspell run).

2012-03-06  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/help.xsl: Corrected typos.

2012-02-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_schedule_omp): Get minutes from correct param.

2012-02-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (target): Limit the hosts column to 500 chars.

2012-02-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (configure_targets.html): Adjust for "From file" Hosts
	option.

2012-02-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_target_omp): Only check target_locator when
	importing.

	* src/html/omp.xsl (html-create-target-form): Add the "From file" option
	to the case where target sources is empty.  Correct the maxlength in the
	other case.

2012-02-24  Matthew Mundell <matthew.mundell@greenbone.net>

	Allow upload of targets from a file.

	* src/gsad.c (init_validator): Add file to target_source.

	* src/gsad_omp.c (create_target_omp): Get hosts from file param if
	target_source is file.

	* src/html/omp.xsl (html-create-target-form): Add file target source.

2012-02-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add target_source.

	* src/gsad_omp.c (create_target_omp): Make the type of Hosts input depend
	on the target_source param instead of on the value of the Import dropdown.
	Seems like this was or should have been the original intention.  This
	prevents the input of an empty hosts string in the Manual case, which was
	leading a target with Hosts "(null)".

	* src/html/omp.xsl (html-create-target-form): Remove the "--" option
	because a source is required and the radio parameter signals which Host
	input type to use.

2012-02-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_port_range_omp, get_port_list): Add details flag
	to GET_PORT_LISTS call.

2012-02-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (configure_port_lists.html): New template.
	(configure_targets.html): Convert port ranges to port lists.

	* src/html/omp.xsl (port_list [details]): Rename the New Port Range field
	Type to Protocol, and the button to Create port range.

2012-02-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (port_list [details]): Use the in_use element to check
	if the New Port Range form should be enabled, because the predefined
	port lists are marked with in_use.

2012-02-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-port-lists-table, port_list): Add count columns.
	(port_list [details]): Add count fields.

2012-02-21  Matthew Mundell <matthew.mundell@greenbone.net>

	Add port list import.

	* src/gsad.c (init_validator, export_omp_get): Add import_port_range.

	* src/gsad_omp.c (export_port_list_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/omp.xsl (html-import-port-list-form): New template.
	(get_port_lists): Add import form.

2012-02-20  Matthew Mundell <matthew.mundell@greenbone.net>

	Add port list export.

	* src/gsad.c (init_validator, export_omp_get): Add export_port_list.

	* src/gsad_omp.c (export_port_list_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/omp.xsl (port_list): Add export icon.

2012-02-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Add port range deletion.

	* src/gsad.c (init_validator): Add delete_port_range command and rules.
	(exec_omp_post): Add delete_port_range.

	* src/gsad_omp.c (get_port_list_omp): Move body to get_port_list.
	(get_port_list, delete_port_range_omp): New functions.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/gsad.xsl (delete_port_range_response): New template.
	(html-gsa-logo): Add delete_port_range green icon case.

	* src/html/omp.xsl (delete_port_range_response): New template.
	(port_list [details]): Add delete icon.
	(get_port_list): Match delete_port_range_response and port list after
	delete.

2012-02-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Add "New port range" section to Port List Details page.

	* src/gsad.c (init_validator): Add create_port_range command and port
	range rules.
	(exec_omp_post): Add create_port_range.

	* src/gsad_omp.c (create_port_range_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/gsad.xsl (create_port_range_response): New template.
	(html-gsa-logo): Add create_port_range green icon case.

	* src/html/omp.xsl (delete_port_list_response): Correct name.
	(port_list [details]): Add "New port range" form.
	(create_port_range_response): New template.
	(get_port_list): Match create_port_range_response.

2012-02-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add file and from_file.

	* src/gsad_omp.c (create_port_list_omp): Get port ranges from file if
	given in file.

	* src/html/omp.xsl (html-create-port_list-form): Add file option for
	ranges.

2012-02-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (delete_target_omp): Get the port lists too, for the
	follow on page.

2012-02-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-port_list-form): Replace "default" in
	port range with a range example.

2012-02-13  Matthew Mundell <matthew.mundell@greenbone.net>

	Add simple form for creating port lists.  Switch target creation from
	port ranges to port lists.

	* src/gsad.c (init_validator, exec_omp_post): Add create_port_list.

	* src/gsad_omp.c (create_target_omp): Replace port range with port list
	ID.  Get the port lists too.
	(get_targets_omp): Get the port lists too.
	(CHECK): New macro.
	(create_port_list_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/omp.xsl (port_list [select]): New template.
	(html-create-target-form): Replace port range field with port lists.
	(get_targets): Pass port lists to html-create-target-form.
	(html-create-port_list-form): Convert to port lists.
	(get_port_lists): Enable call to html-create-port_list-form.

2012-02-12  Henri Doreau <henri.doreau@greenbone.net>

	* MakeLists.txt: Install VMWare OS icon.

2012-02-10  Matthew Mundell <matthew.mundell@greenbone.net>

	Add initial port list handling.

	* src/gsad.c (init_validator): Add port list commands and params.
	(exec_omp_post, exec_omp_get): Add port list commands.

	* src/gsad_omp.c (get_trash): Get port lists too.
	(get_port_list_omp, get_port_lists_omp, delete_port_list_omp)
	(delete_trash_port_list_omp): New functions.

	* src/gsad_omp.h: Add headers accordingly.

	* src/html/gsad.xsl (create_port_list_response)
	(delete_port_list_response): New templates.
	(html-gsa-navigation): Add port lists.

	* src/html/omp.xsl (html-targets-table, target, target [trash])
	(target [details]): Switch port range to port list.
	(html-create-port_list-form, html-port-lists-table)
	(create_port_list_response, delete_port_list_response, port_list)
	(port_list [trash], port_list [details], get_port_list)
	(get_port_lists): New templates.
	(host): Add TCP and UDP port fields.
	(html-port-lists-trash-table): New template.
	(html-targets-trash-table): Switch to port list.
	(get_trash): Add port lists.

2011-02-10  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/os.xml: Added new entry for VMWare ESXi.

2011-02-10  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/os_vmware.png: New.

2011-02-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl, src/html/gsad.xsl, src/html/help.xsl: Extend
	copyright notice to 2012.

2011-02-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (html-edit-note-form, note [note], note [details])
	(html-edit-override-form, override [override], override [details])
	(result-detailed): Add oid to abbr.

2012-02-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-note-form, note [note], note [details])
	(html-edit-override-form, override [override], override [details])
	(result-detailed): Add abbr around truncated NVT name, with full name.

2012-01-31  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add missing esc_levels.

2012-01-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (params_append_mhd): Add missing condition_data and
	event_data cases.

2012-01-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_base.c (params_append_bin): Get the length of the value from
	the structure instead of using strlen, because the value is binary.

2011-01-09  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/gsa-style.css (gb_menu): Adjusted to work with
	the Chrome browser family. Patch by Karl-Heinz Ruskowski.

2012-01-03  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (ref_cve_list, ref_bid_list, ref_xref_list): New.
	List vulnerability references.
	(result-detailed): Added a reference box.

2011-12-29  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* INSTALL: Re-arranged text a bit and added some Debian 6 info.

2011-12-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (my_settings.html): Add timezone description.

2011-12-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (user_find): Use the right variable.
	(attach_sid): Switch to GMT around the printing of the expiry time.
	Switching the locale only affects the formatting of the time.

2011-12-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/oap.xsl: Wrap all radio inputs in labels.

2011-12-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl: Wrap all checkbox inputs in labels.

2011-12-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl: Wrap all radio inputs in labels.

2011-12-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (REQUIRE): Add backurl arg.  Update callers.
	(REQUIRE2): Remove.  Now same as REQUIRE.

2011-12-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add missing command.

	* src/gsad_omp.c (save_container_task_omp): Save the observers too.

2011-12-07  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (os-icon): Always display OS icon title as defined
	in os.xml to ensure consistency.

2011-12-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): Switch to new report format UUID.

2011-12-05  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Fixed bug that caused
	problems for IE7.

2011-12-05  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (result-detailed): Added product detection box as of
	CR#57 implementation.

2011-12-05  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/os.xml: Added entry for Greenbone OS 1.7.

2011-12-05  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/os.xml: Added unnumbered entry for Greenbone OS.

2011-12-02  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-12-02  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 3.0+beta8 release.

	* CHANGES: Updated.

2011-11-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (init_validator): Add . to family rules, for
	"PCI-DSS 2.0".

2011-11-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): Make sure commands_xml is always defined,
	because it is always freed.  Free levels.  Remove some cases where xml is
	freed erroneously.

2011-11-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [assets]): Only enable the Prognostic Report
	icon when there is a prognosis.

2011-11-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Allow space around numbers.
	(params_mhd_validate_values, params_mhd_validate): If the rule is "number"
	or an alias for "number", then strip any leading and trailing space from
	the number if it is valid.

2011-11-30  Matthew Mundell <matthew.mundell@greenbone.net>

	In the validator, also store the rule name for aliases.

	* src/validator.c (openvas_validator_rule_new)
	(openvas_validator_rule_free, openvas_validator_alias_for): New functions.
	(openvas_validator_new, openvas_validator_add, openvas_validator_alias)
	(openvas_validate): Use validator_rule_t instead of regexp as hashtable
	value.

	* src/validator.h: Add header accordingly.
	(struct validator_rule): New structure.
	(validator_rule_t): New type.

2011-11-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Allow empty passwords.  If login is empty
	go to the login page with fail message, instead of an internal error page.

2011-11-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_note_omp): Add missing days init.

2011-11-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_note_omp, create_override_omp): Set both
	GET_REPORT overrides OMP flags from the URL param, so that overrides only
	show when "apply overrides" is chosen.

2011-11-30  Matthew Mundell <matthew.mundell@greenbone.net>

	Get the result details delta case of the override edit icons working.

	* src/gsad_omp.c (edit_override_omp): Make param errors a bit nicer.
	(save_override_omp): For get_result call get_report for the delta case
	instead of get_result.

	* src/html/omp.xsl (note-detailed): Correct edit icons min_cvss_base path.
	(override-detailed): Add delta result details cases of the edit icons.

2011-11-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Get the result details delta case of the note edit icons working.

	* src/gsad_omp.c (REQUIRE_PARAM): New macro.
	(edit_note_omp): Make param errors a bit nicer.
	(save_note_omp): For get_result call get_report for the delta case instead
	of get_result.

	* src/html/omp.xsl (note-detailed): Add delta result details cases of the
	edit icons.

2011-11-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Get the note and override delete icons working, even directly after a
	delete operation.

	* src/gsad_omp.c (get_result): Remove the delta case.  Now done in caller.
	(delete_note_omp, delete_override_omp): Call get_report directly in the
	delta case when leading to get_result, instead of complicating get_result.
	Remove the parameter checks which should be done in get_result.

	* src/html/omp.xsl (note-detailed): Call the right template.
	(override-detailed): Access report ID lower down, as in the note case.

2011-11-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Get the delete icons working on the result details page, for delta
	results.

	* src/gsad_omp.c (REQUIRE2): New macro.
	(get_result): Add the delta case.
	(delete_note_omp, delete_override_omp): Make param errors a bit nicer.
	Pass the delta params through to get_result.

	* src/html/omp.xsl (note-detailed-delete-params)
	(override-detailed-delete-params): Remove report_id.
	(note-detailed, override-detailed): Add delta handling to the get_result
	case.
	(get_result): Match get_reports_response too, because the delta result
	detail uses this.
	(get_delta_result): Add a result loop with a "commands_response" prefix
	for the result details page.

2011-11-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (note-detailed-delete-params, note-detailed)
	(override-detailed-delete-params, override-detailed): Add missing text to
	result_host_only hidden param.

2011-11-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (delete_note_omp, delete_override_omp): Resurrect
	get_result case removed earlier.

2011-11-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result-detailed): Add missing case for delete icons
	on the Result Details page.

2011-11-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (note-detailed-delete-params)
	(override-detailed-delete-params): New templates.
	(note-detailed, override-detailed): Call new template to put down the
	delete icon params.  Use the correct base path for result 2, which is more
	deeply nested.  Adjust the paths similarly in the edit icon link.  This
	ensures that the parameters are added to the icons on result 2.

2011-11-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (edit_override_omp): Add delta params.
	(save_override_omp): Call get_report instead of getting the report by hand.
	This means the delta case is now handled properly.

	* src/html/omp.xsl (html-edit-override-form): Add delta params to save_override
	form.
	(override-detailed): Add delta params to edit_override link.

2011-11-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (delete_override_omp): Call get_report instead of getting
	the report by hand.  This means the delta case is now handled properly.

	* src/html/omp.xsl (override-detailed): Send delta params in delta case.

2011-11-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (edit_note_omp): Add delta params.
	(save_note_omp): Call get_report instead of getting the report by hand.
	This means the delta case is now handled properly.

	* src/html/omp.xsl (html-edit-note-form): Add delta params to save_note
	form.
	(note-detailed): Add delta params to edit_note link.

2011-11-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): New function.  Body from get_report_omp.
	Add commands arg for extra commands.
	(get_report_omp): Call through to get_report.
	(delete_note_omp): Call get_report instead of getting the report by hand.
	This means the delta case is now handled properly.

2011-11-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (note-detailed): Send delta params in delta case.

2011-11-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_note_omp): Add missing days init.

	* src/html/omp.xsl (html-edit-note-form): Correct tag name.
	(note [details]): When note is off put "when Active" in heading.
	(result-detailed): Only show active notes.

2011-11-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_result): Set both overrides OMP flags from the
	URL param, so that overrides only show when "apply overrides" is chosen.

2011-11-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_note_omp, save_note_omp): Pass active state
	through.

	* src/html/omp.xsl (html-report-table, note, html-notes-table): Add active
	column.
	(html-create-note-form, html-edit-note-form): Add active field.
	(note [details]): Add active field.
	(note-detailed): Add active status above modification time.

2011-11-23  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-11-23  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 3.0+beta7 release.

	* CHANGES: Updated.

2011-11-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (host): Always print arrows, even if time is empty.

2011-11-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (host, report [report-assets]): Handle ISO time.

2011-11-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report_omp): Set both overrides OMP flags from the
	URL param.

2011-11-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (gsa:long-time, html-report-details): Add length check.
	(html-report-table): Correct next_time check.
	(report [assets]): Handle ISO time.

2011-11-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (gsa:long-time): New function.
	(html-report-table, agent, agent [trash], schedule, schedule [details])
	(note [details], override [details], report_format, report_format [trash])
	(note-detailed, override-detailed): Neaten ISO times.

2011-11-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details, short_timestamp_first)
	(short_timestamp_last, report, report [overview]): Filter ISO dates.

2011-11-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (assets): Remove duplicate &amp;.

2011-11-16  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-11-16  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 3.0+beta6 release.

	* CHANGES: Updated.

2011-11-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (assets): Add override selector.  Add overrides flag
	to links.
	(html-report-details): Add overrides flag to Prognostic Report link.
	(host): Add override selector.  Add overrides flag to links.
	(report [assets]): Add overrides flag to links.

	* src/html/help.xsl (hosts.html): Add note about applying overrides.

2011-11-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (assets): When there are 0 hosts skip the host
	counts and table, and put "0 hosts".  This matches the behaviour for
	0 results in a report.

2011-11-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add - to hostport.

2011-11-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (get_info_response): Explain better the situation
	if no CPE/CVE entry was found.

2011-11-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (override [details]): Show the override in the active
	style always, with a hint in the title when it's off.  This allows the
	user to see the full text, even when the override is off.
	(override-detailed): Use the override_box_box always, and remove the
	"Active: no".

2011-11-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (override [details]): Only show appearance when active.
	(result-detailed): Show overrides only when they are active.

2011-11-10  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (override-detailed): Little improvement of text
	for ative flag.

2011-11-10  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/CMakeLists.txt: Adjust path to make XSLT validation work for
	out-of-source builds.

	* CMakeLists.txt: Adjust source locations in install command to enable
	installation from an out-of-source build.

2011-11-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (host): Get the right pos, from the XML, for the
	prognostic report icon.

2011-11-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_note_omp, delete_note_omp, save_note_omp)
	(create_override_omp, delete_override_omp, save_override_omp): Use
	apply_min_cvss_base instead of apply_min, which was the name of the
	variable used to pass the URL param before the param passing change.

	* src/html/omp.xsl: Cast all min_cvss_base comparisons to number, so that
	the result is "0" or "1" instead of "true" or "false".

2011-11-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (override-detailed): Use apply_overrides for overrides
	param.  GSA delete_notes expects apply_overrides there, and uses that
	param for both override and apply_overrides in the OMP GET_REPORT.

2011-11-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (override-detailed): Skip active field if always on.
	Simplify active field if on with time limit.

2011-11-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add active and days.

	* src/gsad_omp.c (create_override_omp, save_override_omp): Pass active
	state through.

	* src/html/omp.xsl (html-create-override-form)
	(html-edit-override-form): Add active field.
	(override [details]): Check the length of the end_time because it's always
	present.
	(override-detailed): Lowlight the box when the override is off.  Add
	active status above modification time.

2011-11-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (cve-detail, cpe-details): Add last SCAP update time.

2011-11-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-table, html-overrides-table): Add active
	column.
	(override, override [details]): Add active state.

2011-11-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): Add URL trace message.  Add favicon.ico
	special case, to prevent the session from expiring when the browser
	requests this file.

2011-11-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/sensor.png: New.

	* CMakeLists.txt: Install new icon.

	* src/html/omp.xsl (task): Replace temporary icon by final one.

2011-10-03  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/os.xml: Removed duplicate entry.

2011-10-03  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/os.xml: Added entries for Slackware Linux.

2011-11-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (nvt): Make Tags align top.

2011-11-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (assets): Fixed greyed icon for prognosis.

2011-11-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/provide_view.png, src/html/img/view_other.png: New.

	* CMakeLists.txt: Install new icons.

	* src/html/omp.xsl (task): Exchanged temporary view icons
	by final ones.

2011-11-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/prognosis.png, src/html/img/prognosis_inactive.png: New.

	* CMakeLists.txt: Install new icons.

	* src/html/omp.xsl (report): Exchanged temporary prognosis icon
	by final one.

2011-11-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/os_slackware.png: New.

	* CMakeLists.txt: Install the new icon.

2011-11-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (nvt): Put each tag neatly on a line.

2011-11-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/oap.xsl: Remove "Back to" from all "Back to" links.

2011-11-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (nvt): Add version field.

2011-11-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (cpe-details): Add width to Name column, otherwise it's
	all crammed up when there's only one row.  Separate note from table by
	adding P.

2011-11-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl: Remove "Back to" from all "Back to" links.

2011-11-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (host): Add Prognostic Report icon in title.

2011-11-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (host, report [assets]): Change "Asset" to "Host" in
	tooltip and title.

2011-11-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (assets, report [assets]): Add result_hosts_only to
	prognostic report links.
	(html-report-details): Include the "Only show hosts..." checkbox for
	prognostic reports too.

2011-11-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (assets): Add missing report element to prognostic
	report link.
	(html-report-details): Add missing host filter params to page arrows.

2011-11-01  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (get_info_response, cpe-details): Display associated
	vulnerabilities of a CPE even if this one isn't present in the
	official CPE dictionary.

2011-10-31  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add prognostic case for the page
	arrows, because these need extra params.

2011-10-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (assets): Grey progostic report icon when list is
	empty.
	(report [assets]): Grey prognostic icon in actions when Apps is 0.  Move
	Reports column to end as other columns all refer to current report.

	* src/html/help.xsl (hosts.html): Update icon.

2011-10-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (wrap): Add outer loop on paragraphs, because
	tokenizing on lines swallows empty lines.

2011-10-26  Matthew Mundell <matthew.mundell@greenbone.net>

	Add note and override exporting.

	* src/html/omp.xsl (note, note [nvt-details], override)
	(override [nvt-details], note-detailed, override-detailed): Add export
	button.

	* src/gsad.c (init_validator): Add export commands.
	(exec_omp_get): Add export calls.

	* src/gsad_omp.c (export_note_omp, export_override_omp): New functions.

	* src/gsad_omp.h: Add headers accordingly.

2011-10-26  Matthew Mundell <matthew.mundell@greenbone.net>

	Maintain the refresh interval across most of the actions on the get_tasks
	page.

	* src/html/omp.xsl (task): Add refresh_interval to icons.

	* src/gsad_omp.c (delete_task_omp stop_task_omp pause_task_omp)
	(resume_paused_task_omp resume_stopped_task_omp start_task_omp): Pass
	refresh_interval to get_tasks.

2011-10-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (cve-details): Add "none" case for References and
	Vulnerable Products.  Format Vulnerable Products like other tables.

2011-10-25  Matthew Mundell <matthew.mundell@greenbone.net>

	Bring the SecInfo pages closer to the others.

	* src/html/dialog.xsl (browse_infosec.html): Remove main heading.  Use H1
	for headings.

	* src/html/omp.xsl (cve-details, cpe-details): Remove main heading.  Use
	H1 for headings.  Add "Back to" link.

2011-10-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (cve-details): Use H1 for both NVT list cases.

2011-10-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_info_response): Make heading depend on type.

2011-10-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (host): Link threat count to CPE Details page.

2011-10-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (cpe-details): Add list of reported vulnerabilites.

2011-10-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (cve-details): Bold only the ID field, as in other
	pages.

2011-10-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (cve-details): Add table of NVTs that address the CVE.

2011-10-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/dialog.xsl (browse_infosec.html): Make the text inputs wider
	so that an entire NVT OID fits in the field.

2011-10-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_info_response): Switch to new wrapper tags.
	(cve-details, cpe-details): Add wrapper tags.

2011-10-21  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/help.xsl: Correct help message for port range.

2011-10-19  Matthew Mundell <matthew.mundell@greenbone.net>

	Get Credential saving working.

	* src/gsad_omp.c (save_lsc_credential_omp): Get change_login from the
	presence of the login param.  This is how it was before the big parameter
	passing patch.  Use the right parameter for the login, "credential_login".
	Get change_password from "enable" instead of "login", because that's the
	form is using.

	* src/html/omp.xsl (html-edit-lsc-credential-form): Use 1 instead of yes
	for "enable" parameters, because that's what validation requires.  Use
	"password" consistently for the password, as it is safe to do so.

2011-10-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-lsc-credential-form): Correct help link.

	* src/html/help.xsl (configure_credentials.html): Add Edit Credential
	action.

2011-10-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_my_settings): Add missing TD.

2011-10-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (contents.html): Move performance to Miscellaneous
	with other Extras.  Add My Settings.  Move SecInfo up to match Extras
	order.
	(my_settings.html): New template.

2011-10-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add missing max_results to All
	Filtered case.

2011-10-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): Add ROLE to ENVELOPE in help and dialog
	cases, for header bar.

2011-10-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_my_settings_omp): Set TZ when the timezone changes.

2011-10-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (user_set_password): New function.
	(exec_omp_post): Set password for session after save_my_settings_omp.

	* src/gsad_omp.c (save_my_settings_omp): Add password return.  Set when
	password successfully changed.

	* src/gsad_omp.h: Update header accordingly.

2011-10-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Remove "login" size limitation, to match
	Administrator.

	* src/gsad_oap.c (edit_user_oap): Replace assertion on name with error
	return.  Expect login name in "login" param.

	* src/html/oap.xsl (user): Pass edit_user username in "login" instead of
	"name".

	* src/html/gsad.xsl (html-gsa-logo): Truncate name at 45 characters.

2011-10-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_tasks, get_overrides): Sort overrides by NVT name,
	text.

2011-10-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_tasks, get_notes): Sort notes by NVT name, text.

2011-10-11  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/help.xsl (hosts.html): Improved help message for prognostic
	scan.

2011-10-11  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-10-11  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 3.0+beta5 release.

	* CHANGES: Updated.

	* CMakeLists.txt: Update openvas-libraries dependency.

	* INSTALL: Document updated openvas-libraries dependency.

2011-10-07  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (get_my_settings): Add dummy Password
	entry to make clear to user she could change it if pressing
	the edit icon.

2011-10-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_my_settings_omp): Add Password case.

	* src/html/omp.xsl (edit_my_settings): Add Password input.

2011-10-05  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (get_info_response): Add NVT details handling.

	* src/html/dialog.xsl (browse_infosec.html): Add input field for NVT
	lookups.

	* src/html/help.xsl (browse_infosec.html): Update help message
	accordingly.

2011-10-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Move "last" class to SecInfo.

	* src/html/help.xsl (browse_infosec.html): Add jump to dialog.

	* src/html/omp.xsl (html-create-schedule-form): Remove stray UTC.

2011-10-04  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/help.xsl (browse_infosec.html): Improve help page.

2011-10-04  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/help.xsl (browse_infosec.html): Add help page for the
	Security Information Browser.
	(contents.html): Link the new help page.

	* src/html/dialog.xsl (browse_infosec.html): Add help icon linking to
	the corresponding help page.

2011-10-04  Henri Doreau <henri.doreau@greenbone.net>

	Add a form for security information lookup.

	* src/gsad.c (request_handler): Handle /dialog/<filename> URLs.

	* src/html/dialog.xsl: New. Handle intermediate pages that don't
	directly issue OMP commands.

	* src/html/gsad.xsl: Include dialog.xsl
	(html-gsa-navigation): Add a link to the new form.

	* src/CMakeLists.txt: Add syntax check for dialog.xsl

	* CMakeLists.txt: Update install procedure accordingly (handle dialog.xsl).

2011-09-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Set the timezone early, so that it's in effect for the entire page
	handler.

	* src/gsad.c (exec_omp_post, exec_omp_get): Set timezone.

	* src/gsad_omp.c (xsl_transform_omp): Remove timezone setting.

	* src/gsad_oap.c (xsl_transform_oap): Remove timezone setting.

2011-09-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (modify_settings_response): Remove.  Now
	modify_setting_response.
	(modify_setting_response): New template.  Was modify_settings_response.

2011-09-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_my_settings): Ensure that timezone return arg is
	always set.  If timezone param is "" return "UTC" instead of "".

	* src/gsad_omp.h: Update header accordingly.

	* src/gsad.c (exec_omp_post): Free timezone.

2011-09-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (user_set_timezone): New function.
	(exec_omp_post): Update timezone after save_my_settings.

	* src/gsad_omp.c (save_my_settings): Add timezone return arg.

	* src/gsad_omp.h: Update header accordingly.

2011-09-28  Matthew Mundell <matthew.mundell@greenbone.net>

	Add editing of My Settings.

	* src/gsad.c (init_validator, exec_omp_post, exec_omp_get): Add
	edit_my_settings and save_my_settings.

	* src/gsad_omp.c (get_my_settings, edit_my_settings)
	(edit_my_settings_omp, save_my_settings_omp): New function.
	(get_my_settings_omp): Call through to get_my_settings.

	* src/gsad_omp.h: Add headers accordingly.

	* src/html/omp.xsl (modify_settings_response, edit_my_settings): New
	templates.
	(my_settings): Remove.  Renamed to get_my_settings.
	(get_my_settings): New template.  Was my_settings.  Add edit icon.

2011-09-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Initialise role and timezone in credentials.

2011-09-27  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a My Settings page.

	* src/gsad.c (init_validator): Add get_my_settings to cmds.
	(exec_omp_get): Add get_my_settings.

	* src/gsad_oap.c (xsl_transform_oap): Add TIMEZONE to ENVELOPE.

	* src/gsad_omp.c (xsl_transform_oap): Add TIMEZONE to ENVELOPE.
	(get_my_settings_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/gsad.xsl (html-gsa-logo): Link username to My Settings.
	(html-gsa-navigation): Add My Settings.
	(timezone): New template.

	* src/html/omp.xsl (my_settings): New template.

2011-09-27  Matthew Mundell <matthew.mundell@greenbone.net>

	Use the timezone given in the OMP AUTHENTICATE.  Store this timezone in
	the session.  Similarly for the user role, adding the role to the
	page header.

	* src/gsad_base.c (ctime_r_strip_newline): Use strftime to include
	timezone.

	* src/gsad_base.h (credentials_t): Add role and timezone.

	* src/gsad.c: Increase size of buffers passed to ctime_r_strip_newline.
	(struct user): Add role and timezone.
	(user_add): Add role and timezone args.
	(exec_omp_post): Pass role and timezone from authenticate_omp to user_add.
	(request_handler): Set role and timezone in credentials for page handlers.

	* src/gsad_oap.c: Increase size of buffers passed to
	ctime_r_strip_newline.
	(xsl_transform_oap): Set timezone if present.  Add role to ENVELOPE.

	* src/gsad_omp.c: Increase size of buffers passed to
	ctime_r_strip_newline.
	(xsl_transform_oap): Set timezone if present.  Add role to ENVELOPE.
	(authenticate_omp): Add role and timezone return args.  Call
	omp_authenticate_info to set them.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/gsad.xsl (html-gsa-logo): Add role.  Remove timezone.
	(role): New template.

2011-09-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp/xsl (get_info_cve_lnk, nvt): Flush trailing whitespace.
	(report [details]): Turn result icons back on for normal cases.  These
	were accidentally turned off during addition of prognostic results.

2011-09-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report_omp): Correct delta state param name.

2011-09-26  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp/xsl (get_info_response): Improve error messages for
	unknown elements.

2011-09-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report_omp): Correct format specifier.

2011-09-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Replace \\R with (?s) in regexps.

2011-09-26  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (result-detailed): Make CPE and CVE clickable in the
	prognostic scan reports.

2011-09-26  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (cve-details, cpe-details): Add help icons.

	* src/html/help.xsl (contents.html, glossary.html): Document CPE and
	CVE.
	(cpe.html, cve.html): New help pages.

2011-09-26  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (cve-details, nvt, host): Use one-liners to
	transmit template parameters, to improve readability.

2011-09-26  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (nvt): Add links to the CVE details dialog.
	(get_info_cve_lnk): Add an optional gsa_token parameter, to let the
	caller set the value if not available from within the template.

2011-09-26  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (get_cve_details, get_cpe_details): Make item name
	unclickable to prevent these recursive links to confuse users.

2011-09-22  Henri Doreau <henri.doreau@greenbone.net>

	Add new CVE and CPE details dialog.

	* src/gsad.c (init_validator, exec_omp_get): Add get_info command.

	* src/gsad_omp.c (get_info, get_info_omp): New functions.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (stylesheet): Add SCAP namespaces.
	(get_info_cpe_lnk, get_info_cve_lnk, get_info_response, cve_details)
	(cpe_details): Add CVE and CPE details dialog.
	(host): Apply get_info_cpe_lnk and get_info_cve_lnk to make CPE and
	CVE clickable.

2011-09-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (task): Slightly improved appearance of icons
	in name column.

2011-09-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-task-table, task): Replace owner column with
	owner icon in task column.  Also add icons for observers and slave.

2011-09-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/oap.xsl (html-create-user-form, user [edit]): Add observer
	role.

2011-09-21  Matthew Mundell <matthew.mundell@greenbone.net>

	Add task observers.

	* src/gsad.c (init_validator): Add observers.

	* src/gsad_omp.c (create_task_omp, save_task_omp): Add observers.
	(get_tasks, get_lsc_credentials, get_target_omp, get_config)
	(get_config_family, get_config_nvt): Add actions param to GET OMPs.

	* src/html/omp.xsl (html-task-table): Add owner column.
	(html-report-table, report, html-edit-task-form): Add observers field.
	Turn off icons on observed tasks.
	(task): Add owner column.  Turn off icons when observing.
	(new_task): Add observer field.

2011-09-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl: Rename assets to hosts.

	* src/html/help.xsl (assets.html): Remove to hosts.html.
	(hosts.html): New template.  Was assets.html.  Rename assets to hosts.
	Add prognosis column and icons.
	(contents.html): Add Asset Management.

	* src/html/omp.xsl (assets, html-report-details, host): Rename assets to
	hosts.

2011-09-19  Matthew Mundell <matthew.mundell@greenbone.net>

	Add multi-host prognosis report.

	* src/gsad.c (init_validator): Add host_levels alias.

	* src/html/omp.xsl (html-report-details): Correct path in Back to Assets
	link.
	(report [assets]): Pass Back to Assets link levels in host_levels.

2011-09-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Add multi-host prognosis report.

	* src/gsad_omp.c (get_report_omp): Add host levels to
	GET_PROGNOSTIC_REPORT.

	* src/html/omp.xsl (assets): Add overall prognostic report button.
	(html-report-details): Get back link levels from host levels.  Remove
	result hosts only button.

2011-09-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Pass host filtering params
	through on result filtering form too.

2011-09-16  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (host): Add hardware information table.

2011-09-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add host filters.

	* src/gsad_omp.c (get_report_omp): Add host filters to
	GET_PROGNOSTIC_REPORT.

	* src/html/omp.xsl (html-report-details): Get most filters for back link
	from new GET_PROGNOSTIC_REPORT elements, instead of using the result
	filters.
	(report [assets]): Use host names for filter params in prognostic report
	link.

2011-09-15  Matthew Mundell <matthew.mundell@greenbone.net>

	Add single host prognostic reports.

	* src/gsad.c (init_validator): Add prognostic to type.

	* src/gsad_omp.c (get_report_omp): Add prognostic case.

	* src/html/omp.xsl (html-report-details): Add prognostic report handling.
	(get_prognostic_report): New template.
	(result-detailed, report [assets], report [overview])
	(report [details]): Add prognostic cases.

2011-09-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (host): Add max prognosis threat.
	(report [assets]): Add prognosis column.

2011-09-07  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (host): Moved Report info up as all
	the rest refers to the selected report. Renamed section
	"Apps" to "Detected Apps".

2011-09-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (host): Add prognosis columns.

2011-09-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (check_modify_config): Add name error case.
	(save_config_omp): Pass name and comment to Manager.

	* src/html/omp.xsl (html-config-table): Add name and comment editing.

2011-09-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (host): Correct help link.

	* src/html/help.xsl (assets.html): Add actions and asset details.

2011-09-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report_omp): Add filters to GET_ASSET.

	* src/html/omp.xsl: Add stylesheet attribs for functions.
	(gsa:build-levels): New function.
	(host, report [assets]): Add filters to links.

2011-09-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_lsc_credentials): Init sort params.

	* src/html/gsad.xsl (html-gsa-navigation): Clean up some wrapping.

2011-09-05  Matthew Mundell <matthew.mundell@greenbone.net>

	Add report scrolling to Asset Details page.

	* src/gsad.c (init_validator): Add pos.
	(get_report_omp): Send host and pos to Manager.  Remove search_phrase
	hack.

	* src/gsad_omp.c (get_report_omp): If host is given send host as
	search_phrase and wrap in get_asset.

	* src/html/omp.xsl (host, report [assets]): Add report scrolling.

2011-09-05  Matthew Mundell <matthew.mundell@greenbone.net>

	Add Asset Details page.

	* src/gsad_omp.c (get_report_omp): If host is given send host as
	search_phrase and wrap in get_asset.

	* src/html/omp.xsl (host, get_reports_response [asset], get_asset): New
	template.
	(report [assets]): Add Actions column.

2011-09-03  Matthew Mundell <matthew.mundell@greenbone.net>

	Remove old param mechanism.

	* src/gsad.c (init_validator): Add login command and caller rule.
	(free_gchar_array, struct req_parms, append_chunk_string)
	(append_chunk_binary): Remove.
	(struct gsad_connection_info): Add cookie.  Was in struct req_parms.
	(free_resources): Remove req_parms, add cookie.
	(serve_post): Remove old param inits.
	(ELSE, ELSE_OAP): Get cmd from new params.
	(exec_omp_post): Get all params from new mechanism.
	(exec_omp_get): Remove old param inits.  Get package_format from new
	params.
	(request_handler): Use new cookie location.  Get text from new params.

2011-09-02  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert last pages to new param mechanism.

	* src/gsad.c (exec_omp_get): Pass single param instead of many.

	* src/gsad_oap.c (get_user_oap, get_users_oap, get_feed_oap): Replace
	multiple args with one.

	* src/gsad_omp.c (get_nvts_omp, get_target_omp, get_targets_omp)
	(get_configs_omp, get_trash_omp): Replace multiple args with one.

	* src/gsad_omp.h, src/gsad_oap.h: Update headers accordingly.

	* src/html/oap.xsl (user): Match param name to validator.

2011-09-02  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (exec_omp_get): Pass single param instead of many.

	* src/gsad_omp.c (get_slave_omp, get_slaves_omp, get_schedule_omp)
	(get_schedules_omp, get_system_reports_omp, get_report_format_omp)
	(get_report_formats_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update headers accordingly.

2011-09-02  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (exec_omp_get): Pass single param instead of many.

	* src/gsad_omp.c (get_result): New function.  Body from get_result_omp.
	(get_result_omp): Call through to get_result.  Update callers to call
	get_result.
	(get_notes_omp, get_overrides_omp): Add params arg.

	* src/gsad_omp.h: Update headers accordingly.

2011-09-01  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (init_validator): Add rules and new commands.
	(exec_omp_get): Pass single param instead of many.

	* src/gsad_omp.c (export_lsc_credential_omp): New function.  Split from
	get_lsc_credentials.
	(get_lsc_credentials): Replace multiple args with one.  Update caller.
	(get_lsc_credentials_omp, get_agents_omp, get_escalator_omp)
	(get_escalators_omp): Replace multiple args with one.
	(create_agent_omp): Improve size check because new param size can be -1.
	(get_agent_omp): New function.  Split from get_agents.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/omp.xsl (lsc_credential, agent): Use new command names.

2011-09-01  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (exec_omp_get): Pass single param instead of many.

	* src/gsad_omp.c (verify_agent_omp, export_config_omp)
	(export_preference_file_omp, export_report_format_omp)
	(verify_report_format_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update headers accordingly.

2011-09-01  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (exec_omp_get, exec_omp_post): Pass single param instead of
	many.

	* src/gsad_omp.c (edit_task, edit_report_format): Replace multiple args
	with one.  Update caller.
	(edit_task_omp, save_container_task_omp, edit_report_format_omp): Replace
	multiple args with one.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/omp.xsl (html-edit-task-form): Separate into two commands.

2011-09-01  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (exec_omp_get): Pass single param instead of many.

	* src/gsad_omp.c (new_task): New function.  Body from new_task_omp.
	(new_task_omp): Call through to new_task.
	(create_report_omp): Replace multiple args with one.
	(get_config, get_config_family, get_config_nvt): New functions.  Bodies
	from *_omp versions, replacing multiple args with one.
	(get_config_omp, edit_config_omp, get_config_family_omp)
	(edit_config_family_omp, get_config_nvt_omp, edit_config_nvt_omp): Call
	through to new function.  Switch callers to new function.
	(edit_override_omp): Replace multiple args with one.
	(save_override_omp): Correct message typo.

	* src/gsad_omp.h: Update headers accordingly.

2011-08-31  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (validator): Remove.  Out of use.
	(exec_omp_post): Pass single param instead of many.

	* src/gsad_omp.c (save_task_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update header accordingly.

2011-08-31  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (init_validator): Add more rules.
	(validator_or): Remove.  Out of use.
	(params_append_mhd): Add more container cases.
	(exec_omp_post): Pass single param instead of many.

	* src/gsad_oap.c (modify_ldap_auth_oap): Remove for rename.
	(modify_auth_oap): New function.  Was modify_ldap_auth_oap.  Replace
	multiple args with one.

	* src/gsad_omp.c (stop_task_omp, pause_task_omp, resume_paused_task_omp)
	(resume_stopped_task_omp, start_task_omp, test_escalator_omp, restore_omp)
	(save_config_family_omp, save_config_nvt_omp): Replace multiple args with
	one.

	* src/gsad_omp.h, src/gsad_oap.h: Update headers accordingly.

2011-08-31  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (init_validator): Add get_task rules.
	(exec_omp_post, exec_omp_get): Pass single param instead of many.

	* src/gsad_omp.c (get_report_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-report-details): Match param name to validator.

2011-08-31  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/os.xml: Re-ordered some entries to have the most specific
	ones at the beginning.

2011-08-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_report_omp): Get xml_file before using it.

2011-08-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad_omp.c (create_report_omp): Make it compile again by
	initializing a variable before use.

2011-08-30  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (init_validator): Add result_task_id.
	(exec_omp_post): Pass single param instead of many.

	* src/gsad_omp.c (create_override_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-create-override-form): Match param name to
	validator.

2011-08-30  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (init_validator): Add result_task_id.
	(exec_omp_post): Pass single param instead of many.

	* src/gsad_omp.c (create_note_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-create-note-form): Match param name to validator.

2011-08-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (init_validator): Add credential rule.
	(exec_omp_post): Pass single param instead of many.

	* src/gsad_omp.c (create_target_omp, create_slave_omp)
	(create_schedule_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update headers accordingly.

2011-08-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (params_append_mhd): Add preference check.

2011-08-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_lsc_credential_omp): Put paren in right place.

2011-08-25  Matthew Mundell <matthew.mundell@greenbone.net>

	Get create_credential params working.

	* src/gsad.c (init_validator): Add create_credential rules.

	* src/gsad_omp.c (CHECK): New macro.
	(create_lsc_credential_omp): Use the right param names.  Check one param
	at a time.

	* src/html/omp.xsl (html-create-lsc-credential-form): Use lsc_password
	instead of password as param name.

2011-08-25  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert create_task to new param mechanism.

	* src/gsad.c (init_validator): Add rules for optional cases.
	(exec_omp_post): Pass single param instead of many.

	* src/gsad_base.h (GSAD_MESSAGE_INVALID): New define.

	* src/gsad_omp.c (new_task_omp): Show message.
	(CHECK): New macro.
	(create_task_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/omp.xsl (new_task): Use optional cases of params.  Remove stray
	input.

2011-08-25  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (exec_omp_post): Pass single param instead of many.

	* src/gsad_omp.c (create_report_omp, create_lsc_credential_omp): Replace
	multiple args with one.

	* src/gsad_omp.h: Update headers accordingly.

2011-08-25  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (init_validator): Widen method_data value.  Add escalator
	data rules.
	(escalator_data): Remove.  For old param mechanism.
	(exec_omp_post): Pass single param instead of many.

	* src/gsad_omp.c (send_escalator_data, send_escalator_method_data): Expect
	data as params.
	(create_escalator_omp, create_config_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update headers accordingly.

2011-08-25  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Make the first
	menu item the default when clicking on the main menu.
	Patch by Karl-Heinz Ruskowski.

2011-08-24  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/os.xml: Added an entry for Greenbone OS 1.6.

2011-08-24  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert save_override to new param mechanism.

	* src/gsad.c (exec_omp_post): Pass single param instead of many.

	* src/gsad_omp.c (save_override_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update headers accordingly.

2011-08-24  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (init_validator): Include newlines in xml_file.  Add
	method_data rules.
	(params_append_mhd): Add method_data check.
	(exec_omp_post): Pass single param instead of many.

	* src/gsad_oap.c (sync_feed_oap, save_settings_oap): Replace multiple
	args with one.

	* src/gsad_omp.c (get_tasks_omp, import_report_format_omp): Replace
	multiple args with one.

	* src/gsad_omp.h, src/gsad_oap.h: Update headers accordingly.

	* src/html/omp.xsl (html-task-table): Remove duplicate input.

2011-08-24  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (exec_omp_post): Pass single param instead of many.

	* src/gsad_omp.c (delete_task_omp, delete_report_omp): Replace multiple
	args with one.

	* src/gsad_omp.h: Update headers accordingly.

2011-08-24  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (exec_omp_post): Pass single param instead of many.

	* src/gsad_omp.c (delete_note_omp, delete_override_omp): Replace multiple
	args with one.

	* src/gsad_omp.h: Update headers accordingly.

2011-08-23  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (exec_omp_get): Pass single param instead of many.

	* src/gsad_omp.c (new_note_omp, new_override_omp): Replace multiple args
	with one.

	* src/gsad_omp.h: Update headers accordingly.

2011-08-23  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (exec_omp_post): Pass single param instead of many.

	* src/gsad_omp.c (delete_trash_task_omp, delete_trash_escalator_omp)
	(delete_trash_lsc_credential_omp, delete_trash_agent_omp)
	(delete_trash_schedule_omp, delete_trash_target_omp)
	(delete_trash_config_omp, delete_trash_slave_omp)
	(delete_trash_report_format_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update headers accordingly.

2011-08-23  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (exec_omp_post): Pass single param instead of many.

	* src/gsad_oap.c (delete_user_oap): Replace multiple args with one.

	* src/gsad_omp.c (delete_escalator_omp, delete_lsc_credential_omp)
	(delete_agent_omp, delete_schedule_omp, delete_target_omp, delete_config_omp)
	(delete_slave_omp, delete_report_format_omp): Replace multiple args with
	one.

	* src/gsad_omp.h, src/gsad_oap.h: Update headers accordingly.

2011-08-23  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert save_config to new param mechanism.

	* src/gsad.c (init_validator): Add config rules.
	(params_append_mhd): Catch the collection params explicitly instead of
	searching for a colon.
	(params_mhd_validate_values): New function.
	(params_mhd_validate): Validate values too.
	(exec_omp_post): Pass single param instead of many.

	* src/gsad_base.c (params_add): Set value manually to use allocated
	memory.

	* src/gsad_omp.c (member): Search in params instead of array.
	(member1): New function.
	(save_config_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update header accordingly.

2011-08-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Consistently mark
	each last menu entry with class "last".

2011-08-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Remove last from Trashcan.

2011-08-22  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (init_validator): Add xml_file regex.
	(params_append_mhd): Add filename arg.  Set in param.  Update caller.
	(exec_omp_get): Pass single param instead of many.

	* src/gsad_base.c (param_free): Add filename.
	(params_value_size, params_filename): New functions.

	* src/gsad_base.h: Add headers accordingly.
	(struct param): Add filename.

	* src/gsad_oap.c (create_user_oap): Replace multiple args with one.

	* src/gsad_oap.h: Update header accordingly.

	* src/gsad_omp.c (create_agent_omp, empty_trashcan_omp)
	(import_config_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update headers accordingly.

2011-08-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (ELSE, ELSE_OAP): New macros.
	(exec_omp_post, exec_omp_get): Use macro for params cases.

	* src/gsad_oap.c (save_user_oap): Correct op name in message.

2011-08-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Renamed
	"Misc" to "Extras".

2011-08-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Moved "Administration"
	behind "Misc".

2011-08-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (html-task-table): Reduced width of columns
	Threat and Trend.

2011-08-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Moved "Scan Configs"
	menu item two entries down.

	* src/html/gsad.xsl (html-gsa-navigation): Moved Performance
	menu item from "Scan Management" to "Misc".

2011-08-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/gsa-style.css: Removed some redundant
	color/background definitions. This patch was developed by
	Karl-Heinz Ruskowski.

2011-08-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Make Navigation a menu. This patch was developed by
	Karl-Heinz Ruskowski.

	* src/html/img/style/top_menu_buttons.png,
	src/html/img/style/menu_pointy.png: New.

	* CMakeLists.txt: Install top_menu_buttons.png and menu_pointy.png.

	* src/html/gsa-style.css (progressbar_text): increased
	z-index to 3 to have it below the menu.
	(gb_menu): New. The styles for the new menu.

	* src/html/gsad.xsl (html-gsa-navigation): Replaced
	gb_window div-container by gb_menu div container.
	(envelope): Replace the table where first column was
	Navigation with simply stacked Menu/Content.

2011-08-18  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert save_note to new param mechanism.

	* src/gsad.c (exec_omp_get): Pass single param instead of many.

	* src/gsad_omp.c (edit_note_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update header accordingly.

2011-08-18  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert get_note to new param mechanism.

	* src/gsad.c (exec_omp_get): Pass single param instead of many.

	* src/gsad_omp.c (get_note, get_note_omp): Replace multiple args with one.
	Update callers.

	* src/gsad_omp.h: Update header accordingly.

2011-08-18  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert save_notes to new param mechanism.

	* src/gsad_base.c (params_free): Free original_value.
	(params_given, params_original_value): New functions.
	(params_add): Clear memory on allocation.

	* src/gsad_base.h: Update headers accordingly.
	(RESULTS_PER_PAGE): New define.  From gsad.c.
	(struct param): Add original_value.

	* src/gsad.c (RESULTS_PER_PAGE): Remove.  To gsad_base.h.
	(params_append_mhd): Append to the param even if zero size, so that empty
	params are still added.
	(params_mhd_validate): Set original_value.
	(exec_omp_post): Pass single param instead of many.

	* src/gsad_omp.c (save_note_omp): Replace multiple args with one.  Check
	validation outcome, as was done in exec_omp_post.

	* src/gsad_omp.h: Update header accordingly.

2011-08-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert save_report_format to new param mechanism.  In the process add
	handling of binary values and groups of values to the mechanism.

	* src/gsad_base.c (params_values, params_append_bin)
	(params_iterator_next): New functions.
	(params_add): Return added param.

	* src/gsad_base.h: Update headers accordingly.
	(struct param): Add values and values_size.
	(params_iterator_t, params_iterator_init): New defines.

	* src/gsad.c (params_append_mhd): If name contains a colon add the data
	to the params new named values instead of to the params single value.
	(exec_omp_post): Pass single param instead of many.

	* src/gsad_omp.c (save_report_format_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update header accordingly.

2011-08-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_oap.c (save_user_oap): Remove excess tracing.

2011-08-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert get_lsc_credential and edit_lsc_credential to new param mechanism.

	* src/gsad.c (init_validator): Add next.
	(exec_omp_post, exec_omp_get): Pass single param instead of many.

	* src/gsad_omp.c (get_lsc_credential, get_lsc_credential_omp)
	(edit_lsc_credential, edit_lsc_credential_omp)
	(save_lsc_credential_omp): Replace request params with single arg.

	* src/gsad_omp.h: Update headers accordingly.

2011-08-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Add automatic storage and validation of request parameters.  The idea is
	to reduce the work and complexity involved in the explicit parameter
	handling.  Convert a few of the Administrator pages to this mechanism.

	* src/gsad.c (struct gsad_connection_info, free_resources): Add params.
	(params_append_mhd, params_mhd_validate, params_mhd_add): New functions.
	(serve_post): Add every param to params.
	(exec_omp_post): Validate all params.  Pass single param arg to
	save_user_oap.
	(exec_omp_get): Add and validate every param.  Pass single param arg to
	edit_settings_oap and edit_user_oap.
	(redirect_handler, request_handler): Init params.

	* src/gsad_base.c (param_free, params_new, params_free, params_get)
	(params_value, params_valid, params_add): New functions.

	* src/gsad_base.h: Add headers accordingly.
	(params_t, struct param, param_t): New types.

	* src/gsad_oap.c (save_user_oap, edit_user_oap)
	(edit_settings_oap): Replace request param args with single arg.

	* src/gsad_oap.h: Update headers accordingly.

2011-08-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (assets): Add help icons.

	* src/html/omp.xsl (assets.html): New template.
	(view_report.html): Correct window name.

2011-08-10  Matthew Mundell <matthew.mundell@greenbone.net>

	Use "assets" in naming instead of "inventory".

	* src/gsad.c (init_validator): In type rename inventory to assets.

	* src/gsad_omp.c (get_report_omp): Rename type inventory to assets.

	* src/html/gsad.xsl (html-gsa-navigation): Rename type inventory to
	assets.

	* src/html/omp.xsl (inventory, report [inventory])
	(report [report-inventory]): Rename.
	(assets): New template.  Was "inventory".  Update caller.  Rename report
	type inventory to assets.
	(get_reports_response): Rename report type inventory to assets.
	(report [assets]): New template.  Was "report [inventory]".  Update caller.
	(report [report-assets]): New template.  Was "report [report-inventory]".
	Update caller.

2011-08-09  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/os.xml: Added a generic entry for Ubuntu.

2011-08-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Hide Filtered Results window
	inventory table.

2011-08-08  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/os_ubuntu.png: New.

	* CMakeLists.txt: Install the new icon.

2011-08-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (inventory): Enable search phrase field.  Add search
	phrase to page links.

2011-08-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Allow any character in authdn.

2011-08-04  Matthew Mundell <matthew.mundell@greenbone.net>

	Enable Assets threat filtering.

	* src/gsad_omp.c (get_report_omp): Make levels fallback the empty
	string.

	* src/html/gsad.xsl (html-gsa-navigation): Add levels to Assets link.

	* src/html/omp.xsl (inventory): Enable threat filter.  Add levels to page
	links.

2011-08-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (inventory): Add Filtering window with results per
	page.

2011-08-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [report-inventory]): Match distance to Assets
	page.

2011-08-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (inventory): Add pagination.

2011-08-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl: Fixed typo: Intesity -> Intensity (3 times).

2011-08-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (inventory): Rename Inventory page to Assets.

	* src/html/gsad.xsl (html-gsa-navigation): Rename Inventory page Assets.

2011-08-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [inventory, report-inventory]): Subtract
	less from the traceroute distance so it starts at 0.

2011-08-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [inventory]): For report link Use static notes
	and overrides values, and include host as search phrase.

2011-08-01  Matthew Mundell <matthew.mundell@greenbone.net>

	Add basic host inventory page.

	* src/gsad.c (init_validator): Add type.
	(exec_omp_post): Update get_report_omp call.
	(exec_omp_get): Pass type to get_report_omp.

	* src/gsad_omp.c (get_report_omp): Add type arg.  Add to GET_REPORT
	request.  Exit earlier in inventory case.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/gsad.xsl (html-gsa-navigation): Add Asset Management section.

	* src/html/omp.xsl (inventory): New template.
	(html-report-details): Rename template in call.
	(get_reports_response): Call template according to type.
	(report [report-inventory]): New template.  Body from report [inventory].
	(report [inventory]): Replace body with full inventory page case.

2011-08-01  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/os.xml: Added entries for Univention Corporate Server (UCS).

2011-07-29  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/os_ucs.png: New.

	* CMakeLists.txt: Install the new icon.

2011-07-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (os-icon): New template.
	(report [inventory], report [overview]): Call os-icon.

2011-07-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add an example inventory host
	table to the Filtered Results window.
	(report [inventory]): New template.

2011-07-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-07-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 3.0+beta4 release.

	* CHANGES: Updated.

2011-07-20  Matthew Mundell <matthew.mundell@greenbone.net>

	Move performance prefs from configs to tasks.

	* src/gsad.c (init_validator, struct req_parms, free_resources)
	(serve_post): Add max_checks and max_hosts.
	(exec_omp_post): Pass max_checks and max_hosts to new_task_omp and
	save_task_omp.

	* src/gsad_omp.c (create_task_omp, create_task_omp): Add max_checks and
	max_hosts params.  Pass to OMP commands.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/omp.xsl (html-report-table, html-edit-task-form, new_task): Add
	Scan Intensity fields.

2011-07-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add missing report params to
	result window << and >> links.

2011-07-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (struct req_parms, serve_post, exec_omp_get): Remove TODOs
	about stricter and static parameter handling, it's already too hard to
	manage the parameters.

2011-07-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Add get_result Back to Report link for delta results.

	* src/gsad.c (exec_omp_get): Pass delta params to get_result_omp.

	* src/gsad_omp.c (get_result_omp): Add delta param args.  Pass into XML.
	Update callers.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (result-details): Add Back to Report link for delta
	case.
	(result-detailed): Pass delta params to get_result.

2011-07-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (note-detailed, override-detailed)
	(result-detailed): Pass overrides to note icons from apply_overrides,
	because apply_overrides is the apply flag, whereas overrides is the
	"include overrides" flag.

2011-07-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Pass get_report params across creates on get_result page.

	* src/gsad.c (exec_omp_post): Pass get_report params to the get_result
	cases of create_note_omp and create_override_omp.
	(exec_omp_get): Pass get_report params to the get_result cases of
	new_note_omp and new_override_omp.

	* src/gsad_omp.c (create_note_omp, create_override_omp): Rename result_id
	arg to note_result_id.  Add result_id arg for get_result result.  Pass
	get_report params to get_result_omp.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/omp.xsl (html-create-note-form, html-create-override-form): Add
	get_report params to get_result case of create icon.  Pass result ID in
	result_id instead of report_id.  Use note_result_id for result ID
	constraint of note/override instead of result_id.
	(result-detailed): Add get_report params to get_result case of create
	icon.

2011-07-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (note-detailed, override-detailed): Get edit icon
	note/override param value from XML instead of assuming it is 1.  Get
	the value from the correct element too.

2011-07-15  Matthew Mundell <matthew.mundell@greenbone.net>

	Pass get_report params across edits on get_result page.

	* src/gsad.c (exec_omp_post): Pass get_report params to the get_result
	cases of save_note_omp and save_override_omp.
	(exec_omp_get): Pass get_report params to the get_result cases of
	edit_note_omp and edit_override_omp.

	* src/gsad_omp.c (edit_note_omp, edit_override_omp): Add result_id arg.
	Pass into XML.
	(save_note_omp, save_override_omp): Pass get_report params to
	get_result_omp.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/omp.xsl (html-edit-note-form, html-edit-override-form): Add
	result_id param for get_result, because report_id is now used for
	report_id passed from get_report page.
	(note-detailed, override-detailed): Add get_report params to edit icon in
	get_results case.

2011-07-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Pass result ID to delete_note_omp and
	delete_override_omp from result_id instead of report_id, because report_id
	is used for the get_report pass-through params now.

	* src/gsad_omp.c (delete_note_omp, delete_override_omp): Add result_id
	arg.  Use for result ID for get_result_omp instead of report_id.  Also
	correct format specifier for first and max.

	* src/gsad_omp.h: Update headers accordingly.

2011-07-15  Matthew Mundell <matthew.mundell@greenbone.net>

	Pass get_report params across deletes on get_result page.

	* src/gsad.c (exec_omp_post): Pass get_report params to delete_note_omp
	and delete_override_omp.

	* src/gsad_omp.c (REQUIRE): New macro.
	(get_result_omp): Check args with REQUIRE.
	(delete_note_omp, delete_override_omp): Pass get_report params back to
	get_result_omp.

	* src/html/omp.xsl (note-detailed, override-detailed): Add get_report
	params to delete icons.

2011-07-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_result_omp): Move the constructed report children
	up to the same level as the report, for the XSL.

	* src/html/omp.xsl (result-details): In the links that pass through the
	get_report params, expect the params at the same level above the result
	as in the get_report case, like the links that use the params for other
	purposes do.

2011-07-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_result_omp): Remove trace text.

	* src/html/omp.xsl (result-details): Add get_report params to refresh
	icon.  Correct sort paths in Back to Report link.

2011-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a Back to Report link to the single result case of the Result Details
	page.

	* src/gsad.c (init_validator): Add apply_overrides.
	(exec_omp_get): Pass get_report params through to get_result for
	back link.

	* src/gsad_omp.c (get_result_omp): Add get_report args.  Pass into XML.
	Update callers with NULLs for now.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (result-details): Add a Back to Report link.  Add
	get_report params to get_result icon.

2011-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report_omp): Exit after the GET_TASKS for the delta
	case, because that's all that's needed.

2011-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result-details): Add delta param.  Skip overrides
	widget if set.
	(get_delta_result): Pass delta flag to result-details.

2011-07-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/os_gos.png: New.

	* CMakeLists.txt: Install the new icon.

2011-07-13  Matthew Mundell <matthew.mundell@greenbone.net>

	Enable result details for delta results.

	* src/gsad.c (exec_omp_post): Pass result_id to get_report_omp.

	* src/gsad_omp.c (get_report_omp): Add a result_id arg.  If given adjust
	the XML to be a GET_DELTA_RESULT instead of a GET_REPORT.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (result [details]): Take task info as args.
	(result-detailed): Add details icon to delta case.
	(get_delta_result): New template.

2011-07-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Pass overrides flag to delete_report_omp.

	* src/gsad_omp.c (delete_report_omp): Add apply_overrides flag.  Call
	through to get_tasks instead of doing the OMP by hand, as some of the OMP
	was missing.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (report): Add override param to delete icon.

2011-07-13  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/os.xml: Updated with new entries.

2011-07-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/os_junos.png: New.

	* CMakeLists.txt: Install the new icon.

2011-06-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Allow hosts to be empty in save_note and
	save_override.

2011-06-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result [details]): Add overrides control.

2011-06-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-note-form, html-edit-note-form)
	(html-create-override-form, html-edit-override-form): Turn off the details
	button of the associated note/override.

2011-06-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-table): Check whether the task is a
	container for the report template, instead of just passing 1.
	(status_bar): Remove shadowed case.

2011-06-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-note-form)
	(html-create-override-form): Move next inside the get_result params,
	because only get_result expects it.
	(result-detailed): Set next in the get_report case of the note-detailed
	call otherwise next ends up as the empty string.

2011-06-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Get the result details add_override working.

	* src/gsad.c (exec_omp_post): Add a get_result case for create_override.
	(exec_omp_get): Pass override_task_id instead of task_id to
	create_override_omp, because the get_result case uses task_id.

	* src/gsad_omp.c (new_override_omp): Put arg for NEW_OVERRIDE NEXT in the
	right place.
	(create_override_omp): Add args for next page, task name and task ID.  Add
	the get_result case.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-create-override-form): Add params for the
	get_result case.  Use override_task_id instead of task_id for the task_id
	of the override.
	(result-detailed): Move the new_override link to the override section.
	Use the right params in new_override link.

2011-06-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-logo): Match get_result delete ops for
	indicator.

	* src/html/omp.xsl (get_result): Match delete op responses.

2011-06-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Get the result details add_note working.

	* src/gsad.c (exec_omp_post): Add a get_result case for create_note.
	(exec_omp_get): Pass note_task_id instead of task_id to create_note_omp,
	because the get_result case uses task_id.

	* src/gsad_omp.c (create_note_omp): Add args for next page, task name and
	task ID.  Add the get_result case.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-create-note-form): Add params for the get_result
	case.  Use note_task_id instead of task_id for the task_id of the note.
	(result-detailed): Use the right params in new_note link.

2011-06-29  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (get_reports_response/report/report): fixed the
	conflicts reporting mechanism for OS detection.

2011-06-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* ChangeLog: Revert overwritten entry.

2011-06-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Get the result details save_override working.

	* src/gsad.c (exec_omp_post): Pass task name to edit_override from the
	get_result page.
	(exec_omp_get): Add a new_override case for get_result.

	* src/gsad_omp.c (new_override_omp): Add a next arg.  Add to NEW_OVERRIDE
	for XSL.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-edit-override-form): Add task name param for
	get_result.
	(result-detailed): Setup new_override link specially for get_result.

2011-06-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Get the result details save_note working.

	* src/gsad.c (exec_omp_post): Pass task name to edit_note from the
	get_result page.
	(exec_omp_get): Add a new_note case for get_result.

	* src/gsad_omp.c (new_note_omp): Add a next arg.  Add to NEW_NOTE
	for XSL.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-edit-note-form): Add task name param for
	get_result.
	(result-detailed): Setup new_note link specially for get_result.

2011-06-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Pass the task name into the get_result page in preparation for the
	edit icons.  As a result show the name instead of the UUID above the
	result.

	* src/gsad.c (exec_omp_post, exec_omp_get): Pass task name to note and
	override operations on the get_result page.  Pass name to get_result_omp
	too.

	* src/gsad_omp.c (get_result_omp): Add task name arg.  Add to TASK for
	XSL.
	(delete_note_omp, save_note_omp, delete_override_omp)
	(save_override_omp): Add task_name arg, pass through to get_result_omp.
	(edit_note_omp, edit_override_omp): Add task_name arg.  Add to EDIT_NOTE
	for XSL.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/omp.xsl (note-detailed, override-detailed)
	(result-detailed): Pass task name to commands for get_result.
	(result [details]): Print task name with link instead of UUID.

2011-06-28  Matthew Mundell <matthew.mundell@greenbone.net>

	Get the Result Details page edit_override working.

	* src/gsad.c (exec_omp_post): Add the get_result case of save_override.
	(exec_omp_get): Add the get_result case of edit_override.

	* src/gsad_omp.c (save_override_omp): Add a get_result case, which calls
	get_result_omp.

	* src/html/gsad.xsl (html-gsa-logo): Add get_result modify_override
	response for indicator icon.

	* src/html/omp.xsl (override-detailed): Setup args specially for
	get_result case.
	(get_result): Match modify_override response.

2011-06-28  Matthew Mundell <matthew.mundell@greenbone.net>

	Get the Result Details page edit_note working.

	* src/gsad.c (exec_omp_post): Add the get_result case of save_note.
	(exec_omp_get): Add the get_result case of edit_note.

	* src/gsad_omp.c (save_note_omp): Add a get_result case, which calls
	get_result_omp.

	* src/html/gsad.xsl (html-gsa-logo): Add get_result modify_note response
	for indicator icon.

	* src/html/omp.xsl (note-detailed): Setup args specially for get_result
	case.
	(get_result): Match modify_note response.

2011-06-28  Matthew Mundell <matthew.mundell@greenbone.net>

	Get the Result Details page delete_override working.

	* src/gsad.c (exec_omp_post): Add the get_result case of delete_override.

	* src/gsad_omp.c (delete_override_omp): Add a get_result case, which calls
	get_result_omp.

	* src/html/omp.xsl (override-detailed): Add next arg.  When get_result setup
	args for get_result page.
	(result-detailed): Pass next to override-detailed according to arg.

2011-06-27  Matthew Mundell <matthew.mundell@greenbone.net>

	Enable Result Details page buttons and get the delete_note working.

	* src/gsad.c (exec_omp_post): Add the get_result case of delete_note.

	* src/gsad_omp.c (get_result_omp): Add commands arg.  Add TASK to
	GET_RESULT.  Wrap GET_RESULTS in COMMANDS and pass commands from arg
	through to Manager.
	(delete_note_omp): Add a get_result case, which calls get_result_omp.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (note-detailed): Add next arg.  When get_result setup
	args for get_result page.
	(result [details]): Turn on the note and override buttons.  Pass
	result_detailed a result-details flag.
	(result-detailed): Add result-details arg.  Pass next to note-detailed
	according to arg.
	(get_result): Add commands_response case.

2011-06-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (reports.html): Add delta actions.
	(view_report.html): Add delta filtering.

2011-06-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report): Remove anchor from delta first report icon.

2011-06-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (note-detailed, override-detailed): Add delta arg,
	print which result the item refers to.
	(result-detailed): Pass result number and delta flag down into
	override-detailed and note-detailed.  Print the second result notes and
	overrides too.

2011-06-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [details]): Remove "host" and quotes from port
	summary heading.

2011-06-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-table): Pass container flag to report
	template.
	(report): Add name and container arg.  Use "Uploading" for upload run
	status instead of "Running".

2011-06-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (tasks.html): Add missing edit_task anchor.

2011-06-24  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-06-24  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 3.0+beta3 release.

	* CHANGES: Updated.

2011-06-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result [details]): Comment out the help icon for now.

2011-06-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_result_omp): Get notes and overrides details too,
	for the modification times.

2011-06-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_get): Pass overrides to get_result_omp.

	* src/gsad_omp.c (get_result_omp): Add apply_overrides arg.  Pass through
	to Manager.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (result-detailed): Use right variable to control
	details icon.  Add overrides to icon link.

2011-06-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result-detailed): Add BR when NVT is missing, like
	it is for open ports, but only for delta reports, so that the delta result
	status symbol shows fully.

2011-06-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-table): Move Add Report button back into
	FORM.

2011-06-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-task-form): Add an Import Report window.

2011-06-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Move Apply button DIV above
	threat DIV, so it stays in the window on older Firefoxes.
	(html-report-table): Move Add Report button DIV above FORM, for same
	reason.

2011-06-22  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a basic Result Details page.

	* src/gsad.c (init_validator): Add "get_result" command.
	(exec_omp_get): Handle "get_result".

	* src/gsad_omp.c (get_result_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/gsad.xsl (get_results_response): New indicator template.

	* src/html/omp.xsl (result [details], get_results_response)
	(get_result): New template.
	(result-detailed): Add details-button and show-overrides args.  Add a
	result details icon.

2011-06-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-logo): Add more gsad_msg matches.

2011-06-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (create_user_response, delete_user_response)
	(get_settings_response, modify_auth_response, modify_settings_response)
	(modify_user_response, sync_feed_response): New templates.  Mode
	"response-indicator".
	(html-gsa-logo): Match administrator responses for indicator icon.

2011-06-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_oap.c (save_settings_oap): Treat settings element as
	method_data_param_t's, as required by chunking change.

2011-06-22  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a command result indicator icon.  Only show command result dialog on
	failure.

	* CMakeLists.txt: Install indicator icon images.

	* src/html/gsad.xsl (indicator): New template.  Indicator icon.
	(create_agent_response, create_config_response, create_escalator_response)
	(create_lsc_credential_response, create_note_response)
	(create_override_response, create_report_format_response)
	(create_report_response, create_schedule_response, create_slave_response)
	(create_target_response, create_task_response, delete_agent_response)
	(delete_config_response, delete_escalator_response)
	(delete_lsc_credential_response, delete_note_response)
	(delete_override_response, delete_report_format_response)
	(delete_report_response, delete_schedule_response, delete_slave_response)
	(delete_target_response, delete_task_response, empty_trashcan_response)
	(get_overrides_response, get_reports_escalate_response)
	(get_reports_response, get_system_reports_response, gsad_msg)
	(modify_lsc_credential_response, modify_note_response)
	(modify_override_response, modify_report_format_response)
	(modify_task_response, restore_response, start_task_response)
	(stop_task_response, pause_task_response, resume_paused_task_response)
	(resume_stopped_task_response, test_escalator_response)
	(verify_report_format_response): New templates.  Mode "response-indicator".
	(html-gsa-logo): Match responses for indictor icon.
	(command_result_dialog): Skip the dialog in the success case.

2011-06-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Remove Escalate and Download
	columns for delta reports.
	(result-detailed): Remove note and override creation buttons for delta
	reports.

2011-06-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result-detailed): Add headings to the "changed" result
	subboxes.

2011-06-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsa-style.css (div.diff-line, div.diff-line-hunk)
	(div.diff-line-plus, diff-line-minus): New rules.

	* src/html/omp.xsl (highlight-diff, highlight-diff-line): New function.
	(result-detailed): Add highlighted DELTA/DIFF.

2011-06-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result-detailed): For changed delta results, add
	the second report's result description below the first's.

2011-06-16  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (get_reports_response/report/report): display
	the target hostname if available.

2011-06-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Swap delta_report_id and
	report_id for Apply button, else it swaps the reports.

2011-06-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add scan 2 times and progress
	bar.

2011-06-15  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/indicator_operation_failed.png,
	src/html/img/indicator_operation_ok.png: New.

2011-06-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add delta params to refresh and
	sorting links.

2011-06-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Skip the Full Report line in the
	Report Summary table for delta reports.

2011-06-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add delta params to paging
	arrows in delta reports.

2011-06-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (serve_post): Append method data chunk if there's an existing
	chunk.

2011-06-08  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (edit-config-preference): Added network_scan to
	the list of parameters that use yes/no radio buttons.

2011-06-08  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (get_reports_response/report/report): Report
	conflicting OS detection results.

2011-06-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details, report): Swap values of report_id
	and delta_report_id for delta case, so that the report selected first
	comes first in the delta.

2011-06-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task): Switch off threat and trend for container
	tasks.

2011-06-07  Matthew Mundell <matthew.mundell@greenbone.net>

	Add importing of reports into container tasks.

	* src/html/omp.xsl (html-report-table): Add report import window.

	* src/gsad_omp.c (create_report_omp): Add task_id arg.  Pass through to
	Manager.  Add name and comment NULL checks.

	* src/gsad_omp.h: Update header accordingly.

	* src/gsad.c (exec_omp_post): Pass task_id to create_report_omp.

2011-06-07  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/delta_second.png, src/html/img/delta.png,
	src/html/img/delta_inactive.png: Udated with better graphics.

2011-06-07  Henri Doreau <henri.doreau@greenbone.net>

	Improved OS detection reporting using host details best_os_* fields.

	* src/html/omp.xsl (get_reports_response/report/report): Refactored
	OS icon displaying code to use best_os_* fields from host details.

	* src/html/os.xml: Updated with entries for OS's that now have CPE's
	associated with.

	* CMakeLists.txt: Updated to install new OS icons.

2011-06-02  Matthew Mundell <matthew.mundell@greenbone.net>

	Add delta state filtering to delta reports.

	* src/html/omp.xsl (html-report-details): Add delta state filtering
	control.

	* src/gsad_omp.c (get_report_omp): Add delta_states arg.  Pass through to
	Manager.

	* src/gsad.c (init_validator): Add delta state validation.
	(exec_omp_get): Pass delta states to get_report_omp.
	(exec_omp_post): Add temporary get_report_omp delta states value.

	* src/gsad_omp.h: Update header accordingly.

2011-06-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Do the filtering controls with
	DIVs instead of a table.

2011-05-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report): Use current override setting in get_report
	icons.

2011-05-26  Matthew Mundell <matthew.mundell@greenbone.net>

	Add very basic report deltas.

	* CMakeLists.txt: Add delta images.

	* src/gsad.c (exec_omp_get): Pass report_id to get_tasks for marking
	report for delta.  Pass delta_report_id to get_report_omp for report
	deltas.

	* src/gsad_omp.c (get_tasks): Add delta candidate arg.  Update callers.
	(get_report_omp): Add delta_report_id arg.  Send through to Manager.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/omp.xsl (html-report-details): When delta is given add delta
	to headings and add report links.
	(report): Add delta buttons.
	(result-detailed): When doing delta add state indicators in result
	headings.

	* src/html/img/delta.png, src/html/img/delta_inactive.png,
	src/html/img/delta_second.png: New files.

2011-05-25  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/os_cisco.png, src/html/img/os_freebsd.png,
	src/html/img/os_linux.png, src/html/img/os_netbsd.png,
	src/html/img/os_aix.png, src/html/img/os_openbsd.png: New.

2011-05-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_escalator_omp): Increase value size for trailing
	'\0' in submethod handling.

2011-05-21  Stephan Kleine

	* src/gsad_omp.c: Remove unused variable to fix compilation with GCC 4.6

2011-05-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-escalator-form): Add an attachment option
	for Email Content.
	(escalator [details]): Add attach text to Email Content.

2011-05-19  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-05-19  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 3.0+beta2 release.

	* CHANGES: Updated.

2011-05-18  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (get_reports_response/report/report):
	Improved note about missing OS information.

2011-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_trash): Add missing confirm window.

2011-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (modify_note_response)
	(modify_override_response): Remove duplicate templates.

2011-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_base.c (xsl_transform): Add trace as in USE_LIBXSLT case.

2011-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_nvts, get_note, get_override): Apply templates for
	save note and override confirm windows.

2011-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (override [nvt-details]): Use correct icon.  Add XSL markup.

2011-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (create_note_omp, create_override_omp): Get escalators
	too, for report page dropdown.

2011-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (verify_agent_omp, delete_report_format_omp)
	(verify_report_format_omp): Correct message typos.

2011-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-table, get_trash): Use "Scan Config"
	instead of "Config" for consistency.

2011-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-table): Remove surplus } characters.

2011-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): At least survive if the caller param is
	missing.

2011-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (user): Switch the delete_user icon to POST.

2011-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-table): Pass task_id and overrides params
	to note and override templates explicitly, instead of bundling them in the
	next param, which only works for GET.
	(note, override): Add params and params-get parameters.

2011-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Remove delete_note override requirement, as
	it's optional.  Validate task_id too for delete_report.  Add save_note
	and save_override NULL param checks that where previously done in
	exec_omp_get.

	* src/gsad_oap.c (delete_user_oap): Add NULL param check that was
	done in exec_omp_get when this was a GET.

	* src/gsad_omp.c: Add NULL param checks to the new POST commands.  These
	were done in exec_omp_get when the commands were GET operations.

2011-05-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (delete_note_omp, delete_override_omp): Revert erroneous
	NULL checks added when switching the delete_* commands to POST.

2011-05-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add missing filtering params to
	"All filtered results" download.  Add missing max_results param to
	"Filtered Results 1 to n" download.

2011-05-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (serve_post): Correct esc_first_result case.  Add missing
	esc_max_results case.

2011-05-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Split the escalate case of get_report out into a POST request.

	* src/gsad.c (init_validator): Add alias "escalate_report".
	(struct req_parms, free_resources, serve_post): Add required fields.
	(exec_omp_post): Add new command.

	* src/html/omp.xsl (html-report-details): Make escalate icons POST forms
	that request the new escalate_report command.

2011-05-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Switch test_escalator and the save_* commands to POST.

	* src/gsad.c (init_validator): Add alias "new_threat".
	(struct req_parms, free_resources, serve_post): Add required fields.
	(exec_omp_post): Add commands.
	(exec_omp_get): Remove commands.

	* src/html/omp.xsl (start-icon): Add cmd and alt params.
	(html-edit-task-form, html-edit-note-form, html-edit-override-form): Make
	form POST.  Add caller.
	(escalator): Use start-icon.

2011-05-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Switch the task control commands to POST.

	* src/gsad.c (exec_omp_post): Add task control commands.
	(exec_omp_get): Remove task control commands.

	* src/html/omp.xsl: Replace every task control icon link with a POST icon.
	(pause-icon, resume-icon, start-icon, stop-icon): New templates.

2011-05-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Switch the restore command to POST.

	* src/gsad.c (init_validateor): Replace . with - in uuid.
	(exec_omp_post): Add restore command.
	(exec_omp_get): Remove restore command.

	* src/html/omp.xsl: Replace every restore icon link with a POST icon.
	(restore-icon): New template.

2011-05-16  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad.c (handle_sighup): Do not exit upon receiving a SIGHUP.
	Even though exiting in the default POSIX action, most current
	distributions do not expect this behavior.

2011-05-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_escalators_response): New function.  Prevents
	matching of get_escalators_response on get_reports page.

2011-05-12  Matthew Mundell <matthew.mundell@greenbone.net>

	Switch the delete_* commands to POST.

	* src/gsad.c (validate_or): New function.
	(req_parms, free_resources, serve_post): Add params for commands.
	(exec_omp_post): Add delete_* commands.
	(exec_omp_get): Remove delete_* commands.

	* src/gsad_omp.c (delete_note_omp, delete_override_omp): NULL check
	params.

	* src/html/omp.xsl: Replace every delete_* icon links with POST icons.
	(delete-button): Rename delete-icon.
	(trash-delete-icon, trashcan-icon): New templates.
	(delete-icon): New template.  Was delete-icon.

2011-05-09  Matthew Mundell <matthew.mundell@greenbone.net>

	Switch delete_agent button to POST.

	* src/gsad.c (req_parms, free_resources, serve_post): Add agent_id.
	(exec_omp_post): Add delete_agent.
	(exec_omp_get): Remove delete_agent.

	* src/html/omp.xsl (delete-button): New template.
	(agent): Replace link with form.

2011-05-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Remove character limitations on "password".

	* src/gsad_oap.c (create_user_oap, save_user_omp): Send command with
	openvas_server_sendf_xml, as password may contain XML chars.

	* src/gsad_oap.c (create_slave_oap): Send CREATE_SLAVE with
	openvas_server_sendf_xml, as password may contain XML chars.

	* src/html/help.xsl (configure_slaves.html, configure_users.html): Update
	password syntax.

2011-05-05  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-05-05  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 3.0+beta1 release.

	* CHANGES: Updated.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-05-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add missing max_results to
	links, so that they respect "Results per page".

2011-05-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (escalator [details]): Add Sourcefire Connector data.

2011-05-04  Matthew Mundell <matthew.mundell@greenbone.net>

	Base64 encode PKCS12 when creating Sourcefire escalator.

	* src/gsad_base.h (struct method_data_param): New struct.
	(method_data_param_t): New type.

	* src/gsad.c (escalator_data, free_resources): Expect method data in
	struct.
	(serve_post): Put method data into struct.

	* src/gsad_omp.c (send_escalator_method_data): New function.  Copy of
	send_escalator_data, with Sourcefire PKCS12 base64 special case.
	(create_escalator_omp): Switch syslog special to use struct.  Call
	send_escalator_method_data instead of send_escalator_data for method data.

2011-05-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (status_bar): Add percentage and bar to 'Uploading'.

2011-05-02  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a column to the report summary for escalating the report.

	* src/html/omp.xsl (get_reports_escalate_response): New template.
	(html-report-details): Add "Escalate" column.
	(get_report): Also match get_reports_escalate_response.

	* src/gsad.c (exec_omp_get): Also pass escalator filters to
	get_report_omp.

	* src/gsad_omp.c (get_report_omp): Escalate before getting report, if
	requested.  Get escalators for dropdown.
	(delete_note_omp, save_note_omp, delete_override_omp)
	(save_override_omp): Get escalators for dropdown.

	* src/gsad_omp.h: Update header accordingly.

2011-05-01  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (get_report_response/report/report): use the
	best_os_* entries from host details to display the detected OS.

2011-04-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add missing max_results param
	for "Filtered results..." download.

2011-04-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details, html-report-table)
	(status_bar, task): Add "Uploading" case.  Grey stop and resume when
	uploading.

2011-04-22  Matthew Mundell <matthew.mundell@greenbone.net>

	Add key pair credentials.

	* src/gsad.c (init_validator): Add "key" to "create_credentials_type".
	Remove out of date comment.
	(req_parms, free_resources): Add passphrase, private_key, public_key.
	(serve_post): Pass passphrase, private_key and public_key to
	create_lsc_credential_omp.

	* src/gsad_omp.c (create_lsc_credential_omp): Add key args.  Pass through
	to manager.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-create-lsc-credential-form): Add key pair input.

2011-04-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-escalator-form): Add Sourcefire Connector
	escalator.

2011-04-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Offer predefined reports with
	trusted reports, for download.

2011-04-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Only offer trusted report
	formats.

2011-04-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (RESULTS_PER_PAGE): New define.
	(exec_omp_post, exec_omp_get): Replace literals with new define.

	* src/html/omp.xsl (html-report-details): Add results per page field.

2011-04-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_get): Get maximum result values from params instead
	of using constant.

	* src/html/omp.xsl (html-report-details, html-create-note-form)
	(html-edit-note-form, html-create-override-form)
	(html-edit-override-form): Add max_results to forms that lead back to the
	results page.
	(note-detailed, override-detailed, result-detailed): Add max_results to
	links that lead back to the results page.

2011-04-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Get the increment from the
	report, instead of using a fixed value.

2011-04-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report): Remove download button.

	* src/html/help.xsl (reports.html): Remove "Download a report".

2011-04-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_oap.c (get_users_oap): Align arg properly.

2011-04-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/oap.xsl (modify_user_response): New template.

2011-04-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (config): Put the writable cases the right way round.

2011-04-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-lsc-credential-form)
	(html-edit-lsc-credential-form, html-create-target-form)
	(edit-config-preference, html-create-slave-form): Turn off autocomplete
	for passwords.

2011-04-12  Matthew Mundell <matthew.mundell@greenbone.net

	* src/gsad.c (request_handler): In the GET case when the session has
	expired, skip passing the next page down to the XSL when downloading a
	report.  This prevents the login page from simply serving the exported
	file.

2011-04-12  Matthew Mundell <matthew.mundell@greenbone.net

	* src/html/help.xsl (glossary.html): Describe container tasks.
	(new_task.html): Add container task section.
	(tasks.html): Update for container tasks.

2011-04-07  Matthew Mundell <matthew.mundell@greenbone.net

	* src/html/omp.xsl (html-report-details, html-report-table, task)
	(task [trash]): Check if the status is "Container".
	(status_bar): Add a container case.

2011-04-07  Matthew Mundell <matthew.mundell@greenbone.net

	Add SSH port support for targets.

	* src/gsad.c (exec_omp_post): Pass port to create_target_omp.

	* src/gsad_omp.c (create_target_omp): Add port arg.  Send to Manager.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-create-target-form): Add port input.
	(target [details]): Add port.

	* src/html/help.xsl (configure_targets.html): Add port to New Target
	table.

2011-04-06  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/tmp/omp.xsl (get_trash): Renamed link tag "tasks" to "the_tasks" because
	at least the firefox mixes up the link tag with the div tag with the
	same id "tasks" (and therfore jumps to another place on that page).

2011-04-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (config): Check writable flag instead of in_use flag
	for edit button.

	* src/html/help.xsl (configure_scanconfigs.html): Note that trashcan
	tasks are considered too for edit.

2011-03-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl (configure_credentials.html): Fixed 2 typos.

2011-03-30  Matthew Mundell <matthew.mundell@greenbone.net>

	Handle saving of container tasks.

	* src/html/omp.xsl (html-edit-task-form): Send target_id as "--" for
	container tasks.

	* src/gsad_omp.c (save_container_task_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/gsad.c (exec_omp_get): Call save_container_task_omp for container
	tasks.

2011-03-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-table, task): Grey start button for
	container tasks.

2011-03-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task): Remove duplicate token.

2011-03-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a New Container Task window to the New Task page.

	* src/gsad.c (init_validator): Add command create_report.
	(exec_omp_post): Add create_report handling.

	* src/gsad_omp.c (create_report_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/omp.xsl (create_report_response): New template.
	(new_task): Add container task window.

2011-03-25  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/restore_inactive.png: Updated with final version.

2011-03-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl: Renamed "Trashcan Contents" to "Contents".

	* src/html/help.xsl: Fixed icons for restore.

2011-03-22  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/os.xml: complete regeneration to include every CPEs present
	in cpe.inc and their official CPE titles. Also changed the format to use
	XML entities instead of attributes.

	* src/html/omp.xsl: modified to use the new format of os.xml.

2011-03-22  Matthew Mundell <matthew.mundell@greenbone.net>

	Log the user out when connecting to the Administrator fails.

	* src/gsad_oap.c (administrator_connect): If connecting to adminstrator
	fails, log user out and return login page in new html param.  Update all
	callers to return this html when appropriate.

2011-03-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_trash): Correct count selects.

2011-03-22  Matthew Mundell <matthew.mundell@greenbone.net>

	Log the user out when connecting to the Manager fails.

	* src/gsad.c (user_find): New function.  Was token_user.  Update callers.
	(token_user): Replace with version that find user from token only.
	(token_user_remove): New function.  Remove user given token.

	* src/gsad_omp.c (manager_connect): If connecting to manager fails, log
	user out and return login page in new html param.  Update all callers to
	return this html when appropriate.

2011-03-21  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (get_trash): Added a header line for contents
	table.

2011-03-21  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/restore_inactive.png: New. Interims icon.

	* CMakeLists.txt: Install restore icons.

	* src/html/omp.xsl: Apply new restore icon where resume
	was used for the time being.

2011-03-21  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (get_trash): Make overview table use
	full width and add title for this contents.

2011-03-21  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl: mark IPs with an icon representing the detected
	Operating System.

	* src/html/os.xml: New. Database to retrieve the OS icon and title to
	display for a given CPE.

	* CMakeLists.txt: consider the new files during the installation.

2011-03-16  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/indicator_software_update.png,
	src/html/img/indicator_software_update_inactive.png: New. Indicator
	Icon for availability of software update.

2011-03-16  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/os_apple.png, src/html/img/os_debian.png,
	src/html/img/os_centos.png, src/html/img/os_gentoo.png,
	src/html/img/os_unknown.png, src/html/img/os_windows.png,
	src/html/img/os_fedora.png, src/html/img/os_mandriva.png,
	src/html/img/os_suse.png, src/html/img/os_trustix.png,
	src/html/img/os_novell.png, src/html/img/os_conflict.png,
	src/html/img/os_sun.png, src/html/img/os_hp.png,
	src/html/img/os_redhat.png: New. Icons to mark IPs with the
	detected Operating System.

2011-03-16  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/restore.png: New. Restore Icon for the Trashcan.

2011-03-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): In the GET case when the session has
	expired, skip passing the next page down to the XSL when the command is
	an export command.  This prevents the login page from simply serving the
	exported file.

2011-03-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Reword down message slightly.

2011-03-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Tell the user when the login fails because the manager is down.

	* src/gsad.c (exec_omp_post): Update authenticate call.  Add message if
	manager is down.

	* src/gsad_omp.c (is_omp_authenticated): Remove.  Now authenticate_omp.
	(authenticate_omp): New function.  Was is_omp_authenticated.  Add "manager
	down" return.

	* src/gsad_omp.h: Update header accordingly.

2011-03-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (error_dialog): Get token from param.
	(gsad_response): New template.  From omp.xsl.

	* src/html/omp.xsl (gsad_response): Remove.  To gsad.xsl.

	* src/html/help.xsl (error_messages.html): Correct provoke link.

2011-03-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_trash): Correct help link.

	* src/html/help.xsl: Update Delete buttons to Trashcan buttons.
	(contents.html): Add trashcan.
	(trashcan.html): New page.

2011-03-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_trash): Add contents table.

2011-03-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_trash): Always print headers.

2011-03-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (note [details], override [details]): Indicate if task
	is in trashcan.

2011-03-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-table): Use trashcan button in header.
	(task): Improve trashcan link text.

2011-03-14  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a trashcan.

	* src/html/img/trashcan.png, src/html/img/trashcan_inactive.png: New
	files.

	* src/CMakeLists.txt: Install trashcan icons.

	* src/gsad.c (init_validator): Add trashcan commands.
	(exec_omp_post): Add empty_trashcan handling.
	(exec_omp_get): Increase CMD_MAX_SIZE.  Add trashcan command handling.

	* src/gsad_omp.c (delete_trash_agent_omp, delete_trash_config_omp)
	(delete_trash_target_omp, delete_trash_lsc_credential_omp)
	(delete_trash_report_format_omp, delete_trash_schedule_omp)
	(delete_trash_slave_omp, delete_trash_target_omp)
	(delete_trash_task_omp, restore_omp, empty_trashcan_omp, get_trash)
	(get_trash_omp): New functions.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/gsad.xsl (html-gsa-navigation): Add Miscellaneous section with
	Trashcan.

	* src/html/omp.xsl (task, lsc_credential, agent, escalator, target)
	(config, schedule, slave, report): Replace Delete with To Trashcan.
	(task [trash], lsc_credential [trash], agent [trash], escalator [trash])
	(target [trash], config [trash], schedule [trash], slave [trash])
	(report [trash], empty_trashcan_response, restore_response)
	(html-agents-trash-table, html-configs-trash-table)
	(html-escalators-trash-table, html-lsc-credentials-trash-table)
	(html-report-formats-trash-table, html-schedules-trash-table)
	(html-slaves-trash-table, html-targets-trash-table)
	(html-tasks-trash-table, get_trash): New templates.

2011-03-09  Michael Wiegand <michael.wiegand@greenbone.net>

	Post branch version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-03-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (view_report.html): Add token to jump link.

2011-03-02  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-03-02  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 2.0.1 release.

	* CHANGES: Updated.

	* INSTALL: Updated prerequisites.

2011-03-01  Matthew Mundell <matthew.mundell@greenbone.net>

	Switch to doing the XSL transform in a separate process, keeping the
	libxslt based transform as a configure time option.  This protects the
	GSA from threading and memory errors in libxslt and libxml.

	* CMakeLists.txt: Set USE_LIBXSLT.  Require xsltproc if appropriate.

	* src/CMakeLists.txt: Set USE_LIBXSLT directive.

	* src/gsad.c (main): Set SIGCHLD to SIG_DFL for glib.

	* src/gsad_base (gsad_base_init, xsl_transform): Add alternative for doing
	XSL transform in separate process.

2011-02-25  Matthew Mundell <matthew.mundell@greenbone.net>

	Close some leaks found by Pavel Sejnoha.

	* src/gsad.c (file_content_response): Free path in error cases.

	* src/gsad_omp.c (get_report_omp): Free task_id.

2011-02-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (file_content_response): Add fclose before error return.
	Spotted by Felix Wolfsteller.

2011-02-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_base.c (ctime_r_strip_newline): New function.

	* src/gsad_base.h: Add header accordingly.

	* src/gsad.c, src/gsad_omp.c, src/gsad_oap.c: Replace every use of ctime
	with ctime_r_strip_newline, which is reentrant and removes the trailing
	newline.  In some cases also add the missing time call.

2011-02-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-02-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 2.0.0 release.

	* CHANGES: Updated.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-02-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Set caller to previous caller, as this is
	usually the case.

2011-02-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): Correct comment.
	(main): Call gsad_base_init.

	* src/gsad_base.c (gsad_base_init): New function.  Check if libxml
	supports threading and init parser.

	* src/gsad_base.h: Add header accordingly.

2011-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (javascript.html): Correct typos.

2011-02-18  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/indicator_js.png: Replaced temporary icon with
	a specific one.

	* src/html/help.xsl: Reworked information about JavaScript.

	* src/html/gsad.xsl: Modified JS hint, updated copyright year.

2011-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (verify_report_format_response): New template.
	(get_report_formats): Match the verify response too.

2011-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Init credentials caller.

	* src/gsad_oap.c, src/gsad_omp.c (xsl_transform_oap): Check caller before
	using.

2011-02-18  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-02-18  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 2.0+rc5 release.

	* CHANGES: Updated.

2011-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	On relogin after a POST request due to expired session, return to the page
	that held the POST form.

	* src/gsad.c (req_parms, free_resources, serve_post): Add caller.
	(exec_omp_post): Add URL based on caller param to expired case of
	LOGIN_PAGE.  Support for URL exists already, from similarly patch for GET.
	(reconstruct_url): New function.
	(request_handler): Replace GET URL reconstruction with function call.
	Setup caller field in credentials for page handlers.

	* src/gsad_base.h (credentials_t): Add caller.

	* src/gsad_oap.c, src/gsad_omp.c (xsl_transform_oap): Add CALLER to
	ENVELOPE.

	* src/html/gsad.xsl (caller): New template.

	* src/html/oap.xsl, src/html/omp.xsl: Add hidden caller field to every
	POST form from ENVELOPE.

2011-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	Remove the session cookie on logout.

	* src/gsad.c (attach_sid): Neaten doc.  Make static.
	(remove_sid): New function.
	(send_response): If sid is 0, remove cookie.
	(handler_send_response): Add remove_cookie arg.  Update callers.
	(request_handler): Flag cookie removal where appropriate.

2011-02-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Set the session cookie for every authenticated page, so that the
	expiration time is updated.

	* src/gsad.c (exec_omp_post): Move user return into arg.  Add return
	value.  Add new_sid return arg which contains the new SID where
	appropriate.
	(EXPIRES_LENGTH): Move up in file.
	(attach_sid): New function.  Body from send_redirect_header.  Use current
	time instead of time in user struct for simplicity.
	(send_response): Add sid arg.  Set SID cookie if given.  Update callers.
	(send_redirect_header): Move SID cookie setting out to attach_sid.
	(handler_send_response): Doc return.
	(request_handler): For both GET and POST, set the SID cookie when the user
	is authentic.

2011-02-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (serve_post): Remove erroneous cookie parsing.
	(request_handler): Parse the cookie with the correct name from the
	connection.

2011-02-17  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-02-17  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 2.0+rc4 release.

	* CHANGES: Updated.

2011-02-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (SESSION_LENGTH): Remove.
	(SESSION_TIMEOUT): New define to replace SESSION_LENGTH.
	(session_timeout): New variable
	(token_user, send_redirect_header): Read timeout as minutes from
	session_timeout.
	(main): Add --timeout.

2011-02-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a dedicated icon for the JavaScript indicator.  Display the icon only
	when JavaScript is on.

	* CMakeLists.txt: Install the new icon.

	* src/html/gsad.xsl (html-gsa-logo): Only display icon when JavaScript is
	on.

	* src/html/help.xsl (javascript.html): Update accordingly.

	* src/html/img/indicator_js.png: New icon.

2011-02-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Add cookie based session identification.

	* src/gsad.c (use_secure_cookie): New variable.
	(struct user): Add cookie.
	(user_add): Set cookie.
	(token_user): Add cookie arg.  Check if browser ID matches server ID.
	(struct req_parms): Add cookie.
	(free_resources): Free cookie.
	(serve_post): Read cookie.
	(exec_omp_post): Pass cookie to token_user and go to login if cookie
	missing or bad.
	(EXPIRES_LENGTH): New define.
	(send_redirect_header): Add user arg.  Send cookie if arg set.  Update all
	callers.
	(request_handler): For GET, read cookie and pass to token_user.  Handle
	new return.
	(main): Add --secure-cookie.  If given with --http-only use a secure
	cookie.

2011-02-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_override_omp): Remove premature
	openvas_server_close.

2011-02-15  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/help.xsl (performance.html): Add missing slave_id
	parameter.

2011-02-15  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad.c (exec_omp_get): Have sane default parameters for system
	parameters in case they are not supplied.

2011-02-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (append_param): Skip "r" too.
	(request_handler): Add "&" to dummy param, so that next param gets it.

2011-02-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): Skip follow on page when logging out.

2011-02-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl: Reworked about dialog (authors and logos out).

	* src/html/img/intevation-logo.png, src/html/img/gb-logo.png,
	src/html/img/bsi-logo.png: Removed.

	* CMakeLists.txt: Don't install the logo's anymore.

2011-02-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): When generating the follow on URL, ensure
	that there is at least one parameter, to simplify appending the token.

2011-02-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): Print XML with g_markup_printf_escaped
	in case login contains special XML chars.

	* src/gsad_oap.c (xsl_transform_oap): Print XML with
	g_markup_printf_escaped in case login contains special XML chars.
	Clarify doc as in xsl_transform_omp.

2011-02-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (xsl_transform_omp): Print XML with g_markup_printf_escaped
	in case login contains special XML chars.

2011-02-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Remove password and username validation
	erroneously added with token session management on 2011-02-03.

2011-02-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_system_reports_response): Add slave ID to links.

2011-02-11  Matthew Mundell <matthew.mundell@greenbone.net>

	Make the fallback report more like the others.

	* src/html/omp.xsl (system_report): Include the contents of the report if
	it's text.
	(fallback): Remove.
	(get_system_reports): Remove fallback check.

2011-02-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (fallback): New template.
	(get_system_reports): Show the fallback report on error.

2011-02-10  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a JavaScript indicator.

	* src/html/gsa-style.css (.status_panel): New rule.

	* src/html/gsad.xsl (html-gsa-logo): Add icon next to login panel that
	indicates whether JavaScript is enabled.

	* src/html/help.xsl (javascript.html): New template.

2011-02-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (autorefresh): Add token to URL.

2011-02-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (main): Check the --redirect flag, instead of the --rport
	variable, to see whether to redirect.

2011-02-09  Matthew Mundell <matthew.mundell@greenbone.net>

	For GET requests when the session expires, go to the requested page after
	logging in.

	* src/gsad.c (append_param): New function.
	(request_handler): Add next URL to login page XML when the session has
	expired.  Redirect to the next URL on successful login.

	* src/html/gsad.xsl (login_page): Use next URL from XML if there is one.

2011-02-08  Michael Wiegand <michael.wiegand@greenbone.net>

	Consolidation: Move most of configuration and installation handling to
	top level CMakeLists.txt and clean up top level CMakeLists.txt.

	* CMakeLists.txt: Split up package detection. Set all _CFLAGS
	and _LDFLAGS properly. Add all defines to CMAKE_C_FLAGS. Handle
	installation of logging configuration and support files.

	* src/CMakeLists.txt: Remove most configuration and installation. Use
	the LINK_FLAGS reported by pkg-config instead of hard coding them.
	Split up handling of _LIBRARIES, added TODOs.

	* doc/CMakeLists.txt: Improved handling of "make clean" stage.

2011-02-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_config_omp): Always get the NVT families.

	* src/html/omp.xsl (config [families]): Show the total number of NVTs too,
	counting from NVT families list.

2011-02-07  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/CMakeLists.txt: Removed some testing stuff that
	accidently was comitted.

2011-02-05  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (gsad_init, main): Replace GSA_STATE_DIR by GSA_DATA_DIR.

	* src/CMakeLists.txt: Replace GSA_STATE_DIR by GSA_DATA_DIR.

	* CMakeLists.txt: Replace GSA_STATE_DIR by GSA_DATA_DIR.

2011-02-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_note_omp): Remove premature openvas_server_close.

2011-02-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (scanconfig_details.html): Replace name in get_config
	URL with ID.

2011-02-04  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-02-04  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 2.0+rc3 release.

	* CHANGES: Updated.

2011-02-04  Michael Wiegand <michael.wiegand@greenbone.net>

	* README: Fix typo, strip now redundant part from example.

2011-02-04  Michael Wiegand <michael.wiegand@greenbone.net>

	Add man page to gsad.

	* doc/gsad.8.xml: New. Source file for the gsad man page.

	* doc/gsad.8: New. Pregenerated man page as troff document.

	* doc/gsad.html: New. Pregenerated man page as HTML document.

	* doc/CMakeLists.txt: Add support for man page generation and
	installation.

	* CMakeLists.txt: Define DATADIR.

	* INSTALL: Updated prerequisites.

2011-02-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (login_page): Turn off autocomplete on input fields,
	to prevent some of the password completion performed by some browsers.

2011-02-03  Matthew Mundell <matthew.mundell@greenbone.net>

	Replace HTTP Basic Auth based session management with token based
	session management.  In the process close the cross site request
	forgery hole that affected every URL.

	* src/gsad.c (REALM): Remove.
	(SESSION_LENGTH): New define.
	(users, mutex): New variables.
	(struct user, user_t): New type.
	(user_add, token_user, user_release, user_remove): New functions.
	(init_validator): Add "token".
	(struct req_parms, free_resources, serve_post): Add token param.
	(get_header_credentials, is_http_authenticated)
	(create_http_authenticate_response, send_http_authenticate_header): Remove.
	Part of Basic Auth.
	(exec_omp_post): Remove credentials arg.  Setup credentials from "users"
	via the "token" request param.  Add a login command.
	(exec_omp_get): Add credentials arg because the caller does all the
	request param parsing, and so the caller must get the token and setup the
	credentials.  Update single caller.
	(file_content_response): Add credentials arg for gsad_message.  Serve the
	login page via an XSL transform instead of via a static page.  For "file
	not found" errors, simply serve the error, instead of also logging out
	the user (which would require a token).  Remove Basic Auth related
	header additions.  Update single caller.
	(handler_send_response): New function.  Helper for request_handler.
	(request_handler): Simply redirect the base url to the login page, instead
	of logging the user out first.  Serve the elements of the login page and
	the decorative images before checking authentication.  Replace the GET
	Basic Auth check with a check based on the token request param.  Add
	explicit logout handling.  Add the token to ENVELOPE in the XML.  Redirect
	to the tasks page if the exec_omp_post return indicates a successful
	login.
	(gsad_init): Init mutex and users.

	* src/gsad_base.c (gsad_message): Add credentials arg, and add token to
	GSAD_RESPONSE XML.  The token is for the logout and assumed sane state
	links.  Update all callers.

	* src/gsad_base.h: Update header accordingly.
	(credentials_t): Add token.

	* src/gsad_oap.c (xsl_transform_oap): Add token to ENVELOPE XML.

	* src/gsad_omp.c (xsl_transform_omp): Add token to ENVELOPE XML.
	(is_omp_authenticated): Add const to args.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/gsad.xsl: Add token to every internal HREF, both GET and POST.
	(error_dialog): Ditto.  If the token is missing, add a login link instead
	of a logout link.
	(login_page, token): New templates.

	* src/html/help.xsl: Add token to every internal HREF.

	* src/html/oap.xsl: Add token to every internal HREF, both GET and POST.

	* src/html/omp.xsl: Add token to every internal HREF, both GET and POST.

2011-02-01  Michael Wiegand <michael.wiegand@greenbone.net>

	Switch gsa to pkg-config.

	* CMakeLists.txt: Move check for openvas-libraries to pkg-config.
	Remove duplicate libmicrohttpd check.

	* INSTALL: Update requirements and installation instructions.

	* src/CMakeLists.txt: Replace calls to libopenvas-config with the
	appropriate pkg-config calls.

2011-01-31  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad.c (main): Log a message if binding to a port failed before
	trying the fallback port.

2011-01-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CMakeLists.txt: Fixed minor string typo.

2011-01-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-01-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 2.0+rc2 release.

	* CHANGES: Updated.

2011-01-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Ensure gsa tries to bind to the appropriate privileged ports first and
	falls back to an unprivileged default port if it did not work and no
	custom port was specified.

	* src/gsad.c: Change DEFAULT_GSAD_HTTP_PORT to 80, add
	DEFAULT_GSAD_PORT with value 9392 as fallback.
	(main): Retry binding to DEFAULT_GSAD_PORT if launching the MHD daemon
	failed and no custom port was specified.

2011-01-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_log_conf.cmake_in: Add warning about passwords.

2011-01-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (openvas_server_sendf_xml): Remove.

2011-01-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): Neaten formatting.

2011-01-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CMakeLists.txt: Added check for microhttpd library.

2011-01-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Allow any character in LSC passwords.

	* src/html/help.xsl (configure_credentials.html): Update lsc_password.

2011-01-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_target_omp): Create target locator string with
	g_markup_escape_text, as password may contain a &.

2011-01-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (configure_credentials.html): Add ! to lsc_password
	example.

2011-01-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add ! to lsc_password.

2010-12-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (main): Adapted --version output to
	comply with GNU Coding Standards
	(http://www.gnu.org/prep/standards/standards.html#g_t_002d_002dversion)

2010-12-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2010-12-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 2.0+rc1 release.

	* src/html/help.xsl: Updated version number.

	* CMakeLists.txt: Updated version number.

	* CHANGES: Updated.

2010-12-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add false positive to full
	download levels.

2010-12-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): In full download, put cmd first
	like other downloads, add a first_result, and get the counts from the
	correct entity.

2010-12-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Pass max_results to full and
	"all filtered" downloads, otherwise 1000 is used.

2010-12-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Only display current filtered
	results range when there are results.

2010-12-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add current filtered results row
	to report summary.  Remove download button from filtering window.  Move
	result pager from filtering window to filtered window.

2010-12-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add space to port_range, grouping
	explicitly.

2010-12-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add filtered result row to
	report summary.

2010-12-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (configure_targets.html): Add port range.

2010-12-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Move port range from config into target.

	* src/gsad.c (init_validator): Add port range validator.
	(req_parms, free_resources): Add port range.
	(serve_post): Handle port range.
	(exec_omp_post): Pass port range to create_target_omp.

	* src/gsad_omp.c (create_target_omp): Add port range arg.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-create-target-form): Add port range input.
	(html-targets-table, target, target [details]): Show port range.

2010-12-16  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt: Add a collection of code hardening flags to
	CMAKE_C_FLAGS, inspired by hardening-wrapper on Debian. Add -Werror to
	CMAKE_C_FLAGS to make all warnings fatal.

2010-12-16  Michael Wiegand <michael.wiegand@greenbone.net>

	* doc/CMakeLists.txt: Handle absence of doxygen more gracefully.

2010-12-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (report): Fixed string.

2010-12-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Switch table line to full report
	with download column.
	(html-report-table, report): Replace download column with download action.

	* src/html/help.xsl (configure_report_formats.html): Move predefined
	report details here.
	(reports.html): Remove predefined report details.  Add report download
	action.
	(view_report.html): Add descriptions of windows, in order to describe new
	download option.

2010-12-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (req_parms, free_resources): Add lsc_smb_credential_id.
	(serve_post): Pass two credentials to create_target_omp.

	* src/gsad_omp.c (create_target_omp): Split credential into SSH and SMB
	credentials.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/help.xsl (configure_targets.html): Update for dual credential.

	* src/html/omp.xsl (html-create-target-form, html-targets-table, target)
	(target [details]): Split into two credentials.

2010-12-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_lsc_credential_omp): Put comment tag directly
	in command string, otherwise the send function escapes brackets.

2010-12-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (configure_slaves.html, new_task.html): New templates.
	(contents.html): Add slaves item.

2010-11-30  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/omp.xsl (get_reports_response): Make error handling more
	universal.

2010-11-19  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 2.0+beta1 release.

	* src/html/help.xsl: Updated version number.

	* CMakeLists.txt: Updated version number. Changed
	CPACK_PACKAGE_VERSION for use with "+beta" versioning scheme.

2010-11-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CHANGES: Updated.

2010-11-19  Michael Wiegand <michael.wiegand@greenbone.net>

	Increased required openvas-libraries version.

	* CMakeLists.txt: Updated LO_MAJOR_MIN_VER and LO_MINOR_MIN_VER.

	* INSTALL: Document required version.

2010-11-19  Michael Wiegand <michael.wiegand@greenbone.net>

	Added proper setup for existing libexslt dependency.

	* CMakeList.txt: Added check for libexslt.

	* src/CMakeList.txt: Set LINK_FLAGS for gsad properly, avoid overwrite
	of the existing value.

	* INSTALL: Document libexslt dependency.

2010-11-09  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c, src/gsad_omp.c, src/gsad_oap.c: Adjusted include
	paths for header files of libopenvas_misc.

2010-11-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (new_task): Skip the empty config.

2010-11-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (preferences): Set action column width.

2010-11-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Increase hosts length to 2000.

	* src/html/omp.xsl (html-create-target-form): Increase hosts field to
	2000.

2010-10-31  Stephan Kleine

	* src/CMakeLists.txt: Link against exslt to fix some undefined reference
	to 'exsltRegisterAll' in gsad_base.c

2010-10-22  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad.c (file_content_response): Properly cast pointer to
	callback function so that gsa compiles with libmicrohttpd >= 0.9.2.

2010-10-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* CMakeLists.txt, ChangeLog, doc/CMakeLists.txt, src/gsad.c,
	src/gsad_base.c, src/gsad_base.h, src/gsad_oap.c, src/gsad_oap.h,
	src/gsad_omp.c, src/gsad_omp.h, src/html/gsa-style.css, src/html/gsad.xsl,
	src/html/help.xsl, src/html/oap.xsl, src/html/omp.xsl, src/tracef.h,
	src/validator.c, src/validator.h: Switch all Intevation addresses to
	Greenbone addresses.

	* src/CMakeLists.txt: Switch UKFSN address to Greenbone one.

2010-10-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (modify_note_response, modify_override_response): New
	templates.
	(get_notes, get_overrides): Apply modify response, to confirm save.

2010-10-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (configure_targets.html): Remove dot from hosts note.

2010-10-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (configure_targets.html): Add IPv6 to hosts note.

2010-10-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (configure_targets.html): Add IP ranges to hosts note.
	Increase hosts length.

2010-10-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (validate_hosts_parameter): Remove.  Now in Manager.
	(exec_omp_post): Remove validate_hosts_parameter calls.

2010-10-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Increase hosts length.

	* src/html/omp.xsl (html-create-target-form): Increase hosts length.

2010-10-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (edit_lsc_credential, edit_report_format): Doc next arg.

2010-10-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-lsc-credential-form): Replace login
	with credential_login.

	* src/gsad.c (validate): Neaten doc.
	(exec_omp_post): For create_lsc_credential and save_lsc_credential use
	credential_login instead of login.

2010-10-07  Matthew Mundell <matthew.mundell@greenbone.net>

	Add LSC credential editing.

	* src/html/omp.xsl (html-lsc-credentials-table): Increase action
	column width.
	(html-edit-lsc-credential-form, edit_lsc_credential)
	(modify_lsc_credential_response): New templates.
	(get_lsc_credential): Add COMMANDS to GET_LSC_CREDENTIALS path.  Apply
	modify response template.

	* src/gsad.c (init_validator): Add edit_lsc_credential and
	save_lsc_credential commands.
	(exec_omp_get): Add edit_lsc_credential and save_lsc_credential handling.

	* src/gsad_omp.c (get_lsc_credential, get_lsc_credentials): New function.
	From _omp counterpart, with commands arg.  In get_lsc_credentials allow
	result_len to be NULL.
	(get_lsc_credential_omp, get_lsc_credentials_omp): Replace body with call.
	(edit_lsc_credential, edit_lsc_credential_omp)
	(save_lsc_credential_omp): New functions.

	* src/gsad_omp.h: Add headers accordingly.

2010-10-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add & to lsc_password.

	* src/gsad_omp.c (openvas_server_sendf_xml): Move up in file.
	(create_lsc_credential_omp): Send with openvas_server_sendf_xml.

2010-10-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (check_modify_report_format): Add validation error check.

	* src/html/omp.xsl (param-edit): Set text input size according to param
	type.

2010-10-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_report_format_omp): Add NULL gaurd around param
	loop.

2010-09-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (param-edit): Make input field match param type.
	(param-details): Make value column match param type.

2010-09-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-formats-table): Add "(last verified)" to
	trust heading.

2010-09-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Add editing of report format active flag.

	* src/gsad.c (exec_omp_post): Pass enable param to save_report_format_omp.

	* src/gsad_omp.c (save_report_format_omp): Add active arg.  Save active flag.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-edit-report-format-form): Add active radio.

2010-09-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Add simple editing of report format params.

	* src/gsad.c (struct gsad_connection_info, free_resources)
	(serve_post): Add next and report_format_id params.
	(exec_omp_post): Add save_report_format page handling.
	(exec_omp_get): Remove save_report_format page handling.

	* src/gsad_omp.c (check_modify_report_format): New function.
	(edit_report_formats): Request params with report formats.
	(save_report_format_omp): Add param array arg.  Save params.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/omp.xsl (html-edit-report-format-form): Switch form to POST.
	Add param fields.
	(param-edit): New template.

2010-09-28  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a slave option to the Performance page.

	* src/gsad.c (exec_omp_get): Pass slave ID to get_system_reports_omp.
	(request_handler): Pass slave ID to get_system_report_omp.

	* src/gsad_omp.c (get_system_reports_omp): Add slave ID arg.  Also get
	slaves.
	(get_system_report_omp): Add slave ID arg.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/gsad.xsl (html-gsa-navigation): Add slave_id to performance
	URL.

	* src/html/omp.xsl (system_report): Add slave_id to system report IMG.
	(get_system_reports_response): Add slave field.

2010-09-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_escalator_omp, delete_escalator_omp)
	(test_escalator_omp): Also get the report formats.

2010-09-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_escalator_omp): Also get report formats.

	* src/html/omp.xsl (escalator [details]): Give email case same
	details as new escalator form.

2010-09-27  Matthew Mundell <matthew.mundell@greenbone.net>

	Add slave to task editing.

	* src/gsad.c (exec_omp_get): Pass slave ID to save_task_omp.

	* src/gsad_omp.c (edit_task): Get slaves too.
	(save_task_omp): Add slave arg.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-edit-task-form): Add slave field.

2010-09-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-table): Add slave to Task Summary.

2010-09-24  Matthew Mundell <matthew.mundell@greenbone.net>

	Add "first class" slaves.

	* src/gsad.c (init_validator): Add slave commands.  Add slave_id rule.
	(req_parms, free_resources): Add host.
	(serve_post, exec_omp_post, exec_omp_get): Add slave command handling.

	* src/gsad_omp.c (new_task_omp): Also get slaves.
	(create_slave_omp, delete_slave_omp, get_slave_omp, get_slaves_omp): New
	functions.

	* src/gsad_omp.h: Add headers accordingly.

	* src/html/gsad.xsl (html-gsa-navigation): Add slaves item.

	* src/html/omp.xsl (slave [newtask], html-create-slave-form)
	(html-slaves-table, create_slave_response, delete_slave_response)
	(slave, slave [details], get_slave, get_slaves): New templates.
	(new_task): Get slaves from GET_SLAVES instead of from GET_TARGETS.

2010-09-22  Matthew Mundell <matthew.mundell@greenbone.net>

	Add report format editing.

	* src/html/omp.xsl (html-edit-report-format-form, edit_report_format)
	(modify_report_format_response): New templates.
	(report_format): Add edit report_format button.
	(get_report_format): Apply modify response template.  Add COMMANDS to
	GET_REPORT_FORMATS path.
	(get_report_formats): Apply modify response template.

	* src/gsad.c (init_validator): Add edit_report_format and
	save_report_format commands.
	(exec_omp_get): Add edit_report_format and save_report_format handling.

	* src/gsad_omp.c (get_report_format, get_report_formats): New function.
	_omp counterpart with commands arg.
	(get_report_format_omp, get_report_formats_omp): Replace body with call.
	(edit_report_format, edit_report_format_omp, save_report_format_omp): New
	functions.

	* src/gsad_omp.h: Add headers accordingly.

2010-09-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Add verify buttons on the agents page.

	* src/html/omp.xsl (agent): Add verify button.

	* src/gsad_omp.c (verify_agent_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/gsad.c (init_validator, exec_omp_get): Add verify command.

2010-09-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (agent): Add time under trust value.

2010-09-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_escalators_omp): Also get report formats.

	* src/html/omp.xsl (html-create-escalator-form): Convert format field of
	email escalator to content, with report selection.

2010-09-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report_format [details]): Add active flag.

2010-09-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (status_bar): Also print percent if progress is 0.

2010-09-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details, report): Only offer active report
	formats for download.
	(html-report-formats-table, report_format): Add active column.

2010-09-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result-detailed): Only show override details when
	applying overrides.

2010-09-09  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl (configure_escalators.html): Added notes
	about HTTP GET.

2010-09-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (openvas_server_sendf_xml): New function.
	(send_escalator_data): Send with openvas_server_sendf_xml.

	* src/html/omp.xsl (html-create-escalator-form): Add HTTP Get input.

2010-09-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/CMakeLists.txt: Link gsad to libexslt.

	* src/gsad_base.c (xsl_transform): Register exslt extensions.

	* src/html/omp.xsl (wrap): Replace with line-tokenizing version which
	calls wrap-line.
	(wrap-line): New template.  Copy of old wrap.

2010-09-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_base.c (xsl_transform): Return NULL on error instead of HTML.
	(gsad_message): Return basic HTML if transformation fails.

	* src/gsad_oap.c (xsl_transform_oap): Try return error dialog page before
	basic message, on transformation failure.

	* src/gsad_omp.c (xsl_transform_omp): Try return error dialog page before
	basic message, on transformation failure.

2010-09-08  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CMakeLists.txt: Added check for subversion directory if build type
	is not release to avoid an incomplete version number.

2010-09-07  Matthew Mundell <matthew.mundell@greenbone.net>

	Add associating of slave with task.

	* src/gsad.c (gsad_connection_info, free_resources, serve_post): Add
	slave_id attribute.
	(exec_omp_post): Pass slave_id to create_task_omp.

	* src/gsad_omp.c (create_task_omp): Add slave_id param.  Pass to
	CREATE_TASK.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (new_task): Add slave input.

2010-09-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl (configure_credentials.html): Added
	note on Umlauts and Domain Controller.

2010-08-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report_format): Add trust time under trust.
	(report_format [details]): Extract text part of trust only.

2010-08-25  Matthew Mundell <matthew.mundell@greenbone.net>

	Add verify buttons on the report formats page.

	* src/html/omp.xsl (report_format): Add verify button.

	* src/gsad_omp.c (verify_report_format_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/gsad.c (init_validator, exec_omp_get): Add verify command.

2010-08-26  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/omp.xsl: Do not show the "Pause" button if the task is
	still being requested.

2010-08-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl: Consistent checked="1" everywhere.
	This is just code polishing.

	* src/html/gsad.xsl: Provide html tag with xml name space
	attribute. This was complained by HTML checker.

2010-08-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (init_validator): Allowed german umlauts for comment.

2010-08-20  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl (configure_credentials.html): More info
	about allowed characters.

2010-08-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-lsc-credential-form): Check password
	instead of autogenerate.

2010-08-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl (configure_report_formats.html): Slight improvement
	of test.

2010-08-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add - to credential_login.

2010-08-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (edit-families-family): Replace submit image with link.

2010-08-13  Matthew Mundell <matthew.mundell@greenbone.net>

	Add report formats help.

	* src/html/help.xsl (configure_report_formats.html): New template.
	(configure_scanconfigs.html, configure_targets.html): Correct spelling.
	(contents.html, glossary.html): Add report formats item.
	(reports.html): Refer to report formats page in download section.  Add TXT
	format.
	(view_report.html): Refer to report formats page in download section.

	* src/html/omp.xsl (report_format [details]): Neaten URL name.

2010-08-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-formats-table, report_format)
	(report_format [details]): Add report format trust value.

2010-08-11  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/help.xsl: Corrected typo in domain example for credential
	login.

2010-08-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl: Added domain examples for credential
	login.

2010-08-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (delete_report_omp): Get report formats for download
	dropdown.

2010-08-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report): Only activate report delete button for
	appropriate report states.

2010-08-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task): Add missing URL param name.

2010-08-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (status_bar): Just print status if the progress is -1.

2010-08-10  Matthew Mundell <matthew.mundell@greenbone.net>

	Show overrides consistently in links to get_tasks pages.

	* src/html/gsad.xsl (html-gsa-logo, error_dialog): Pass overrides flag to
	get_tasks.

	* src/html/help.xsl: Flush trailing whitespace.
	(reports.html, tasks.html): Pass overrides flag to get_tasks.

2010-08-10  Matthew Mundell <matthew.mundell@greenbone.net>

	Refer to report formats by UUID in OMP GET_REPORTS.

	* src/gsad.c (exec_omp_get): Expect report format ID instead of name for
	get_report_omp.

	* src/gsad_omp.c (get_report_omp): Pass UUID instead of name to
	GET_REPORTS to identify report format.

	* src/html/omp.xsl (html-report-details, report): Pass report format ID to
	get_report instead of name.

2010-08-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_get): Pass overrides flag to edit_override_omp in
	get_tasks case.

	* src/html/omp.xsl (html-report-table): Pass overrides param to override
	template.

2010-08-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_note_omp, delete_note_omp, save_note_omp)
	(create_override_omp, delete_override_omp, save_override_omp): Get report
	formats for download dropdown.

2010-08-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (edit-config-preferences): Add drop_privileges to
	yes/no radio list.

2010-08-05  Michael Wiegand <michael.wiegand@greenbone.net>

	* INSTALL: Added information on setting PKG_CONFIG_PATH. Updated and
	rephrased section on custom paths for libraries and header files. Made
	naming of the GSA consistent. Made text width consistent.

2010-08-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (edit-config-preferences): Add yes/no radios for known
	scanner yes/no prefs.

2010-08-05  Matthew Mundell <matthew.mundell@greenbone.net>

	Add task control buttons to the task summary page.

	* src/gsad.c (exec_omp_get): Pass next to task control functions.  Pass
	overrides as ints to the same.

	* src/gsad_omp.c (delete_task_omp, save_task_omp, stop_task_omp)
	(pause_task_omp, resume_paused_task_omp, resume_stopped_task_omp)
	(start_task_omp): Add next page handling.

	* src/gsad_omp.h: Update headers accordingly.

	* src/htmp/omp.xsl (html-report-table): Add task control buttons.
	(task): Pass next page to task control pages.

2010-08-04  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad.c: Added mainpage directive for documentation.

2010-08-03  Michael Wiegand <michael.wiegand@greenbone.net>

	Post branch version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2010-08-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report_omp): Wrap in GET_REPORT instead of COMMANDS.
	Get the task summary as well as the report, for the task progress info.

	* src/htmp/omp.xsl (html-report-details): Replace "Final scan run status"
	field with "Scan status" and progress bar.
	(get_report): New template.

2010-08-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsa-style.css (small_form): Separate out input to add middle
	vertical alignment.

	* src/htmp/omp.xsl (html-report-details, report): Replace download button
	with image input.

2010-08-03  Matthew Mundell <matthew.mundell@greenbone.net>

	Add report formats.

	* src/gsad_base.h (enum content_type): Add GSAD_CONTENT_TYPE_DONE.

	* src/gsad.c (init_validator): Add report format commands and validators.
	(exec_omp_post): Add handling for report format commands.
	(exec_omp_get): Add arg for content type.  Let get_report_omp set the
	content type if it wishes.  Add handling for report format commands.
	(gsad_add_content_type_header): Add GSAD_CONTENT_TYPE_DONE case.
	(request_handler): Set the content type for exec_omp_get if required.

	* src/gsad_omp.c (get_tasks): Also get report formats.
	(export_report_format_omp): New function.
	(get_report_omp): Add content type and disposition args.  Set these
	according to report format information.  Capitalise XML format name.  Also
	get report formats.
	(create_note_omp, delete_note_omp, save_note_omp, create_override_omp)
	(delete_override_omp, save_override_omp): Capitalise XML format name.
	(get_report_format_omp, get_report_format_omp, delete_report_format_omp)
	(import_report_format_omp): New functions.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/gsad.xsl (html-gsa-navigation): Add "Report Formats" menu item.

	* src/html/omp.xsl (html-report-details, report): Replace static report
	names with dynamic ones.
	(html-report-formats-table, html-import-report-format-form)
	(get_report_formats_response)
	(create_report_format_response, delete_report_format_response)
	(report_format, param-details, report_format [details])
	(get_report_format, get_report_formats): New templates.
	(get_reports_response)
	(get_reports_response/report [overview, details]): Account for extra
	report wrapper element.

2010-07-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add - to family_page.

2010-08-02  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2010-08-02  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 1.0.0 release.

	* src/html/help.xsl: Updated version number.

	* CMakeLists.txt: Updated version number.

	* CHANGES: Updated.

	* INSTALL: Updated prerequisites.

2010-08-02  Michael Wiegand <michael.wiegand@greenbone.net>

	* INSTALL: Updated prerequisites.

	* CMakeLists.txt: Increased required openvas-libraries version.

2010-07-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_config_nvt_omp): Correct MODIFY_CONFIG call
	for NVT preferences.

2010-07-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (serve_post): Account for chunking in file and password
	parsing.

2010-07-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (serve_post): Account for chunking in preference parsing.
	Most of work by Michael Wiegand.

2010-07-22  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt: Fixed openvas-libraries version detection.

2010-07-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (preferences-edit-details): Correct NVT path.

2010-07-16  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2010-07-16  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 1.0.0.rc1 release.

	* src/html/help.xsl: Updated version number.

	* CMakeLists.txt: Updated version number.

	* CHANGES: Updated.

2010-07-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Validate create_user password like other
	vars.

2010-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (send_http_authenticate_header): Doc MHD type.
	(redirect_handler, request_handler): Return MHD_YES on method error, so
	that the sender gets the response page.   Doc MHD type.  Align overhang.

2010-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report_omp): Remove TODO about g_string_new size, as
	it's hard to tell how big or small the string will get.

2010-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_base.c (xsl_transform): Check return value.  Remove premature
	free.

2010-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (main): Remove TODO that referred to a pidfile_create.

2010-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (print_header): Remove.  Now out of use.
	(redirect_handler): Clarify freeing.
	(request_handler): Remove print_header iteration.

2010-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (get_file_size): Remove.  Out of use.

2010-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (serve_post): Cleanup doc a bit.
	(request_handler): Rename arg contenttype to content_type.  Cleanup doc a
	bit.

2010-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* doc/CMakeLists.txt (.build-html, .built-html_full): Remove duplicate
	rule.  Depend on all source files.

	* src/gsad.c, src/gsad_base.h, src/gsad_omp.c: Bring docs up to date.

2010-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* doc/Doxyfile.in, doc/Doxyfile_full.in: Turn off recursive file search.

2010-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-note-form, html-edit-note-form)
	(html-create-override-form, html-create-note-form): Ensure override and
	note buttons are hidden.

2010-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-table): Add overrides to refresh URLs.

2010-07-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_system_reports_omp): Use new OMP for getting list.

	* src/html/omp.xsl (system_report [image]): Remove mode.  Change path.
	(system_report): Remove.
	(get_system_reports_response, get_system_reports): New template.  Rename
	from system_report.  Adjust path for flatter report type list.

2010-07-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl (configure_agents.html): Updated help page on agents.

2010-07-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_get): Get agent filename from get_agent_omp.

	* src/gsad_omp.c (get_agents_omp): Add filename return arg.

	* src/gsad_omp.h: Update header accordingly.

2010-07-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_get): Expect get_agents_omp html in arg return
	instead of in function return value.  Get agent before setting response
	headers, in case of error.

	* src/gsad_omp.c (get_agents_omp): Add html return arg.  Return success
	or failure.

	* src/gsad_omp.h: Update header accordingly.

2010-07-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_get): Get credential login for filename from
	get_lsc_credentials_omp.

	* src/gsad_omp.c (get_lsc_credential_omp): Add login return arg.

	* src/gsad_omp.h: Update header accordingly.

2010-07-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_get): Expect get_lsc_credentials_omp html in arg
	return instead of in function return value.  Get credential before setting
	response headers, in case of error.

	* src/gsad_omp.c (get_lsc_credentials_omp): Add html return arg.  Return
	success or failure.

	* src/gsad_omp.h: Update header accordingly.

2010-07-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_lsc_credential_omp): Correct comment.
	(get_lsc_credentials_omp): Correct attribute name.

2010-07-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_get): Pass oid to edit_note_omp "get_nvts" case
	in correct parameter.  Pass overrides flag to edit_note_omp "get_tasks"
	case.

	* src/gsad_omp.c (edit_note_omp): Remove min_cvss_base NULL check, as
	only some callers use it.

	* src/html/omp.xsl (html-report-table): Add overrides flag to the request
	parameters passed to the edit_note "get_tasks" case.

2010-07-09  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl: Completed and fixed help texts for
	Overrides.

2010-07-08  Matthew Mundell <matthew.mundell@greenbone.net>

	Pass agent installer filename in CREATE_AGENT OMP.

	* src/gsad.c (struct req_parms): Add installer_filename field.
	(free_resources): Free installer_filename.
	(serve_post): Set installer_filename.
	(exec_omp_post): Pass installer_filename to create_agent_omp.

	* src/gsad_omp.c (create_agent_omp): Add installer_filename arg.  Send
	filename in CREATE_AGENT.

	* src/gsad_omp.h: Update header accordingly.

2010-07-08  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Added help for overrides.

	* src/html/help.xsl (contents.html): Added link to overrides-help.
	(glossary.html): Included overrides.
	(overrides.html): New, help for overrides.

2010-07-08  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad.c (free_gchar_array): New function, extracted.
	(free_resources): Extracted and call new function.

2010-07-08  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt: Make cmake environment more flexible as discussed on
	openvas-devel: Set CMAKE_BUILD_TYPE only to "Debug" if it is not
	already set. Do not set CMAKE_VERBOSE_MAKEFILE, let it default to OFF.
	Remove redundant flags from CMAKE_C_FLAGS_DEBUG. Replace check for
	PREPARE_RELEASE with check for CMAKE_BUILD_TYPE == "Release".

2010-07-06  Matthew Mundell <matthew.mundell@greenbone.net>

	Add agent installer signatures.

	* src/gsad.c (struct req_parms): Add installer_sig fields.
	(free_resources): Free installer_sig.
	(serve_post): Fill installer_sig.
	(exec_omp_post): Pass installer_sig fields to create_agent_omp.

	* src/gsad_omp.c (create_agent_omp): Add installer_sig args.  Send
	signature in CREATE_AGENT.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-create-agent-form): Add "Installer signature"
	field.
	(html-agents-table, agent): Add trust column.

2010-07-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-escalator-form): Capitalize syslog.
	(escalator, escalator [details]): Use submethod name for syslog methods.

2010-07-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-table, overide)
	(html-overrides-table): Add From column.  Rename New Threat column to To.
	(override-detailed): Add from threat to heading.

2010-07-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-override-form): Select False Positive for
	New Threat.

2010-07-05  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/override.png, src/html/img/new_override.png: Updated.

2010-07-05  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/false_positive.png: New.

	* src/html/omp.xsl: Fix for consistent spelling of false_positive.png.

	* src/CMakeLists.txt: Install the new graphics file.

2010-07-03  Matthew Mundell <matthew.mundell@greenbone.net>

	Add Syslog and SNMP escalator methods.

	* src/gsad_omp.c (create_escalator_omp): Extract the syslog "submethod"
	data from the "method" param.

	* src/html/omp.xsl (html-create-escalator-form): Add syslog and SNMP
	methods.

2010-07-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (html-report-details): Consolidate title
	bar action.

2010-07-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (html-report-table): Consolidate title
	bar action.

2010-07-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (html-task-table): Use a hook to mark
	current selection in title bar. Well, officially its
	the radic symbol, but looks good.

2010-07-02  Matthew Mundell <matthew.mundell@greenbone.net>

	Add False Positive "threat" for overrides.

	* src/gsad.c (init_validator): Add false positive to levels and threat.
	Add level_false_positive.
	(exec_omp_get): Add false positive to level string.

	* src/html/omp.xsl (build-levels): Add False Positive.
	(html-report-details): Add false positive column and filter.
	(html-report-table): Add false positive column.
	(false_positive): New template.
	(report): Add FP to tool tip.  Fill false positive column.
	(last_report): Add FP to tool tip.
	(html-create-override-form, html-edit-override-form): Add False Positive
	to New Threat.
	(get_reports_response/report [overview]): Add false positive column.

2010-07-02  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt: GSA requires glib to be at least 2.14. Modified
	library check to check glibs version as well.

2010-07-01  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (html-task-table): Consolidate title bar actions.
	Mark current setting with ">". Don't us checkbox for
	nicer and consistent appearance.

2010-07-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-task-table, html-report-details)
	(html-report-table): Move the "Apply overrides" checkbox into the table
	heading.

2010-06-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_tasks): Move GET_NOTES and GET_OVERRIDES task ID
	into attribute.

2010-06-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-override-form): Ensure new threat offers
	the existing value.

2010-06-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_target_omp): Send USERNAME and PASSWORD inside
	TARGET_LOCATOR.

	* src/html/omp.xsl (target_locator [select]): Get name from entity.

2010-06-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_note_omp, save_note_omp, create_override_omp)
	(create_override_omp): Move TASK IDs from text into attribute.

2010-06-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_note_omp, save_note_omp, create_override_omp)
	(create_override_omp): Move NVT and RESULT IDs from text into attribute.

2010-06-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_nvts): Align param.  Change GET_NVTS/@oid to
	nvt_oid.  Move GET_NOTES and GET_OVERRIDES elements to attributes.
	(get_config_nvt_omp, save_config_nvt_omp)
	(export_preference_file_omp): Change GET_NVTS/@oid to nvt_oid.

2010-06-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_target_omp): Add tasks attrib to GET_TARGETS.

2010-06-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (new_override_omp): Remove apply_overrides flag.

2010-06-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Rename report/messages to
	report/result_count.  Rename report/scan_result_count to
	report/result_count.
	(report, last_report): Rename report/messages to report/result_count.
	(messages): Remove.
	(result_count): New template.  Rename from messages.

2010-06-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report_omp, create_note_omp, delete_note_omp)
	(save_note_omp, create_override_omp, delete_override_omp)
	(save_override_omp): Replace get_report with get_reports.

	* src/html/omp.xsl (get_report_response)
	(get_report_response/report [overview, details): Remove.
	(get_reports_response, get_reports_response/report [overview, details):
	New templates.  Renamed from "get_report" counterparts.

2010-06-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (manager_connect): Note breakpoint method of pausing.

	* src/gsad_oap.c (administrator_connect): Note breakpoint method of
	pausing.

2010-06-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-config-nvt-table): Select prefs from inside NVT.

2010-06-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_nvts, get_config_family_omp, get_config_family_omp)
	(get_config_nvt_omp): Adjust get_nvts with new details flags.

2010-06-23  Matthew Mundell <matthew.mundell@greenbone.net>

	Rename GET_NVT_DETAILS to GET_NVTS.

	* src/gsad.c (init_validator): Remove get_nvt_details.  Add get_nvts.
	(exec_omp_get): Call get_nvts_omp instead of get_nvt_details_omp.  Replace
	"get_nvt_details" page name args with "get_nvts".

	* src/gsad_omp.c: Replace get_nvt_details in comments and docs.
	(get_nvt_details, get_nvt_details_omp): Remove.
	(get_nvts, get_nvts_omp): New function.  Rename from "nvt_details"
	version.  Update callers.
	(get_config_nvt_omp, get_config_family_omp): Replace get_nvt_details
	command.  Add details attribute.
	(delete_note_omp, save_note_omp, delete_override_omp): Replace
	get_nvt_details in page name comparison.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (get_nvt_details): Remove.
	(get_nvt): New template.  Renamed from get_nvt_details_response.
	(html-config-family-table, html-config-nvt-table): Replace "nvt_details"
	with "nvts".

2010-06-22  Matthew Mundell <matthew.mundell@greenbone.net>

	Rename ABORT_TASK to STOP_TASK.

	* src/gsad.c (init_validator): Remove abort_task.  Add stop_task.
	(exec_omp_get): Call stop_task_omp instead of abort_task_omp.

	* src/gsad_omp.c (abort_task_omp): Remove.
	(stop_task_omp): New function.  Rename from "abort" version.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/help.xsl (tasks.html): Replace "abort" with "stop".

	* src/html/omp.xsl (abort_task_response): Remove.
	(stop_task_response): New template.  Renamed from abort_task_response.
	(task): Replace "abort" with "stop".

2010-06-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add _ to credential_login chars.

2010-06-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task): Also pass apply_override through to task
	details page.

2010-06-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_tasks_response): Improve operation name.

2010-06-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Use correct name for
	apply_overrides in report download request.

2010-06-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add apply_overrides to report
	download request.

2010-06-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add "Apply overrides" checkbox.

2010-06-21  Matthew Mundell <matthew.mundell@greenbone.net>

	Remove report "Apply overrides" checkbox.  Make the actions on the task
	list preserve the override state.

	* src/gsad.c (init_validator): Add command new_task.
	(exec_omp_post): Call new_task_omp instead of gsad_newtask, passing
	"apply override" flag.  Pass "apply override" flag to create_task_omp.
	(exec_omp_get): Pass "apply override" flag to task functions that lead to
	getting the task list.  Pass "show overrides" flag to functions that lead
	to getting a single task.
	(request_handler): Remove new_task.html special case.

	* src/gsad_omp.c (gsad_newtask): Remove.
	(new_task_omp): New function.  Rename from gsad_newtask.  Add
	apply_overrides arg.
	(create_task_omp, delete_task_omp, edit_task, edit_task_omp)
	(save_task_omp, abort_task_omp, pause_task_omp, resume_paused_task_omp)
	(resume_stopped_task_omp, start_task_omp): Add apply_overrides flag.
	(delete_note_omp, save_note_omp, delete_override_omp)
	(save_override_omp): Pass overrides arg to get_tasks as apply_overrides.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/gsad.xsl (autorefresh): Add overrides to URL.
	(html-gsa-navigation): Add overrides flags to get_tasks URL.  Replace
	new_task.html with new_task command.

	* src/html/help.xsl (configure_targets.html): Correct typo.
	(new_task.html): Remove.

	* src/html/omp.xsl (apply_overrides): New template.
	(html-task-table): Get apply_overrides directly from get_tasks response.
	Replace new_task.html with command version, including overrides flag.
	Pass overrides flag to pages that return to get_tasks.
	(html-report-details): Pass overrides to get_report.  Remove overrides
	checkbox.
	(html-edit-task-form): Pass override flag on to get_tasks.
	(task): Pass overrides flag through to report and report list and to pages
	that return to get_tasks.
	(gsad_newtask): Remove.
	(new_task): New template.  Renamed from gsad_newtask.  Pass override flag
	to create_task.

2010-06-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl (configure_targets.html): Added
	description for import of targets.

2010-06-19  Matthew Mundell <matthew.mundell@greenbone.net>

	Add "Apply override" checkboxes for task and report lists.

	* src/gsad.c (exec_omp_post, exec_omp_get): Pass overrides flag to
	get_tasks_omp.

	* src/gsad_omp.c (get_tasks): Add overrides arg.  Update callers.
	(get_tasks_omp): Add overrides arg.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-task-table, html-report-table): Add "Apply
	overrides" checkbox.
	(get_tasks): New template.

2010-06-18  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/oap.xsl: Little facelift for ADS/LDAP dialogs.

	* src/html/help.xsl: Moved and cleaned up ADS and LDAP
	documentation into Users page.

2010-06-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report_omp, create_note_omp, delete_note_omp)
	(save_note_omp, new_override_omp, create_override_omp)
	(delete_override_omp, save_override_omp): Pass overrides as 1 always, and
	pass apply_overrides with alongside overrides with the value overrides
	had.

	* src/html/omp.xsl (html-report-details): Rename "Show overrides" to
	"Apply overrides" and check it according to the apply_overrides filter
	setting.

2010-06-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (init_validator): Move "get_tasks" into alphabetical
	order.

2010-06-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsa-style.css: Order authors alphabetically.

2010-06-18  Matthew Mundell <matthew.mundell@greenbone.net>

	Rename GET_STATUS to GET_TASKS.

	* src/gsad_oap.c (get_users_oap, get_feed_oap, sync_feed_oap)
	(get_settings_oap, edit_settings_oap, save_settings_oap)
	(modify_ldap_auth_oap): Replace "get_status" with "get_tasks".

	* src/gsad_omp.c: Replace "get_status" with "get_tasks" in all messages
	and comments.
	(get_status, get_status_omp): Remove.
	(get_tasks, get_tasks_omp): New function.  Renamed from "status" version.
	(edit_task_xml, start_task_xml, delete_report_omp): Replace get_status
	with get_tasks in OMP.
	(save_task_xml, delete_note_omp, save_note_omp)
	(save_override_omp): Replace get_status call with get_tasks.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/gsad.xsl (autorefresh, html_gsa_logo, html-gsa-navigation)
	(error_dialog): Replace "get_status" with "get_tasks".

	* src/html/help.xsl (feed_management.html, reports.html)
	(tasks.html): Replace "get_status" with "get_tasks".

	* src/html/login/login.html: Replace "get_status" with "get_tasks".

	* src/html/oap.xsl (user [details]): Replace "get_status" with
	"get_tasks".

	* src/html/omp.xsl: Replace "get_status" with "get_tasks" in all URLs,
	POST variables and comments.
	(get_status_response): Remove.
	(get_tasks_response): New template.  Renamed from get_status_response.

2010-06-18  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/override.png, src/html/img/new_override.png: New.
	Temporary icons for override.

	* src/CMakeLists.txt: Install new icons.

2010-06-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (edit_task, get_status, delete_report_omp): Request
	details when getting status with task.

2010-06-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task_id, identifier): Remove.  Old templates.
	(result-detailed): Ensure that new notes and overrides use the original
	threat.

2010-06-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result [detailed]): Skip CVSS when overridden.

2010-06-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Add threat overrides.

	* src/gsad.c (init_validator): Add overrides commands and validators.
	(struct req_parms): Add overrides and new_threat.
	(free_resources): Free new_threat.
	(serve_post): Fill overrides and new_threat.
	(exec_omp_post): Pass overrides to create_note_omp.  Add handling for
	override commands.
	(exec_omp_get): Pass override request params to intermediate pages, as
	with notes request params.  Add handling for override commands.  Pass
	overrides param to get_report_omp.

	* src/gsad_omp.c (get_nvt_details): Get overrides.
	(get_report_omp, new_note_omp, create_note_omp, delete_note_omp)
	(edit_note_omp, save_note_omp): Add overrides flag arg.
	(get_overrides, get_overrides_omp, get_override, get_override_omp)
	(new_override_omp, create_override_omp, delete_override_omp)
	(edit_override_omp, save_override_omp): New function.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/omp.xsl: Pass overrides param to get_report.  Pass override
	request params to intermediate pages, as with notes request params.
	(html-report-details): Add overrides checkbox.
	(html-report-table): Add task overrides window.
	(get_overrides_response): New template.
	(get_nvt_details): Apply delete_override_response.  Add overrides section.
	(html-create-override-form, new_override, html-edit-override-form)
	(edit_override, modify_override_response, override, overide [nvt-details])
	(override [details], html-overrides-table, get_override, get_overrides)
	(create_override_response, delete_override_response, override-detailed): New templates.
	(result_detailed): Add override header, buttons and box.

	* src/html/gsad.xsl (html-gsa-navigation): Add "Notes" menu item.

	* src/html/gsa-style.css (.override_box_box, .override_top_line): New
	styles.

2010-06-10  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad_omp.c (create_task_omp): Fix. If no schedule is given, do
	not send schedule element with empty id, as manager will not be able
	to find it. Dont send schedule element instead. Merged with same issue
	for escalator.

2010-06-10  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/gsa-style.css: Add hover style for odd and even tr.

	* src/html/omp.xsl: Make tr's that correspond to a tr.odd
	now a tr.even.

2010-06-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_task_omp): Add missing XML quote.

2010-06-10  Matthew Mundell <matthew.mundell@greenbone.net>

	Pass config names to pages that need them.

	* src/gsad.c (exec_omp_post): Pass name to save_config_omp,
	save_config_family_omp and save_config_nvt_omp.
	(exec_omp_get): Pass name to get_config_family_omp, get_config_nvt_omp,
	get_config_family_omp and get_config_nvt_omp.

	* src/gsad_omp.c (save_config_omp, save_config_family_omp)
	(save_config_nvt_omp): Add name arguments.
	(get_config_family_omp, get_config_nvt_omp): Add name arguments.  Add
	NAME to CONFIG.  Update callers.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/omp.xsl (html-config-family-table, preference, preferences)
	(html-config-nvt-table, html-config-table): Pass config name alongside
	UUID.

2010-06-09  Matthew Mundell <matthew.mundell@greenbone.net>

	Switch to config UUIDs.

	* src/gsad.c (init_validator): Add validator "config_id".  Remove
	"scanconfig".
	(req_parms, free_resources, serve_post): Add config_id to required params.
	Remove scanconfig.
	(exec_omp_post): Expect create_task_omp config in config_id instead of
	scanconfig.  Expect config UUID instead of name in save_config_omp,
	save_config_family_omp and save_config_nvt_omp.
	(exec_omp_get): Pass config UUID instead of config name to config related
	functions.

	* src/gsad_omp.c (create_task_omp, get_config_omp)
	(save_config_omp, get_config_family_omp, save_config_family_omp)
	(get_config_nvt_omp, save_config_nvt_omp, delete_config_omp)
	(export_config_omp, export_preference_file_omp): Expect config as UUID
	instead of name.

	* src/html/omp.xsl (html-report-table, html-edit-task-form)
	(html-config-family-table, preference, preference-details)
	(edit-config-preference, preferences, html-config-nvt-table)
	(family, html-config-table, config, gsad_newtask): Pass
	config in "config_id" param instead of "name" or "scanconfig".
	(config [newtask]): Use UUID as value.
	(html-create-config-form): Replace predefined config names with UUIDs.

2010-06-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_get): Use correct variable when validating family.

2010-06-09  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad.c (validate): New function that validates a parameter from
	the request. If parameter was found invalid, free it and set the
	corresponding variable to NULL.
	(exec_omp_post): Replaced code with call to validate.

2010-06-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_task_omp): Pass schedule ID in attribute.

2010-06-09  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/omp.xsl (task): Deactivate icons when the actions are not
	applicable to the current status.

2010-06-09  Matthew Mundell <matthew.mundell@greenbone.net>

	Switch to target UUIDs.

	* src/gsad.c (init_validator): Add validator "target_id".  Remove
	"scantarget".
	(req_parms, free_resources, serve_post): Add target_id to required params.
	Remove scantarget.
	(exec_omp_post): Expect create_task_omp target in target_id instead of
	scantarget.
	(exec_omp_get): Pass target_id instead of name to delete_target_omp and
	get_target_omp.

	* src/gsad_omp.c (create_task_omp, delete_target_omp)
	(get_target_omp): Expect target as UUID instead of name.

	* src/html/omp.xsl (html-report-table, html-edit-task-form)
	(lsc_credential [details], target, gsad_newtask): Pass
	target in "target_id" param instead of "name".
	(target [newtask]): Use UUID as value.

2010-06-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-target-form): Revert to "--" as value
	associate with "--" credential, which was already working.

2010-06-07  Matthew Mundell <matthew.mundell@greenbone.net>

	Switch to LSC credential UUIDs.

	* src/gsad.c (init_validator): Add validator "lsc_credential_id".
	(req_parms, free_resources, serve_post): Add lsc_credential_id to required
	params.
	(exec_omp_post): Expect create_target_omp credential in lsc_credential_id.
	(exec_omp_get): Pass lsc_credential_id instead of name to
	delete_lsc_credential_omp, get_lsc_credential_omp and
	get_lsc_credentials_omp.

	* src/gsad_omp.c (delete_lsc_credential_omp, get_lsc_credential_omp)
	(get_lsc_credentials_omp): Expect lsc_credential_id instead of name param.
	(create_target_omp): Expect credential as UUID instead of name.

	* src/html/omp.xsl (lsc_credential, target, target [details]): Pass
	credential in "lsc_credential_id" param instead of "name" and
	"credential_login".
	(lsc_credential [select]): Use UUID as value.
	(html-create-target-form): Pass 0 as value associate with "--" credential.

2010-06-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_target_omp): Indent overhung assign like others.
	Bring long lines in range.  Indent args properly.

2010-06-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Indent overhang properly.

2010-06-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (scanconfig_nvt_details.html): Improve description.

	* src/html/omp.xsl: Format header comment like others.
	(html-create-target-form): Align cell.

2010-06-06  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl (scanconfig_nvt_details.html): Added
	description of risk factors.

2010-06-06  Matthew Mundell <matthew.mundell@greenbone.net>

	Switch to escalator UUIDs.

	* src/gsad.c (init_validator): Adapt "escalator_id" for UUIDs.  Remove
	"escalator".
	(req_parms, free_resources, serve_post): Rename escalator to escalator_id.
	(exec_omp_post): Allow escalator_id to be "--".  Rename escalator to
	escalator_id.
	(exec_omp_get): Pass escalator_id instead of name to delete_escalator_omp,
	get_escalator_omp and test_escalator_omp.

	* src/gsad_omp.c (create_task_omp): Rename escalator to escalator_id,
	and move to attrib.
	(delete_escalator_omp, get_escalator_omp, test_escalator_omp): Expect
	escalator_id instead of name param.

	* src/html/omp.xsl (html_report_table, escalator, gsad_newtask): Pass
	escalator_id instead of name in escalator URLs.
	(escalator [newtask]): Use UUID as value.
	(html-edit-task-form): Use UUID as value, using "0" to remove escalator.

2010-06-04  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad_omp.c (get_targets_omp): Corrected command name.

2010-06-04  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Reflect name change of OMP command (sources became target_locators).

	* src/gsad.c (gsad_connection_info, serve_post, exec_omp_post)
	(init_validator): Renamed source to target_locator.

	* src/gsad_omp.c (create_target_omp, delete_target_omp)
	(get_targets_omp): Renamed source to target_locator.

	* src/html/omp.xsl: Renamed source to target_locator.

2010-06-04  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad_omp.c (gsad_newtask): Added comments.

2010-06-04  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Added Import section to Targets page, allows fetching targets from
	external sources ("target locators"), if manager is configured to do
	so. Uses recent changes and additions in CREATE_TARGET and GET_SOURCES
	OMP commands.

	* src/gsad_omp.c (create_target_omp): Added parameters for source,
	username and password, include in OMP command if present.
	(delete_target_omp, get_targets_omp): Request sources after deletion
	of a target.

	* src/gsad_omp.h (create_target_omp): Adjusted proto.

	* src/gsad.c (init_validator): Added source validator.
	(gsad_connection_info): Added source field.
	(serve_post): Fill new source field.
	(exec_omp_post): Validate new parameters and pass to create_target_omp.

	* src/html/omp.xsl (source): New, creates option in a select box.
	(html-create-target-form): Updated to allow specification of source
	and respective authorization, if configured.
	(create_target_response): Pass response of get_sources as parameter.

	* src/html/help.xsl (configure_targets): Updated examples with
	comma-space separation of hosts.

2010-06-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (agent): Get UUID from "id" attrib.

2010-06-03  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/help.xsl: Handle requests for nonexistent help pages
	better. Kudos to Jan-Oliver Wagner for suggesting this approach.

2010-06-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_report_response/report [overview]): Compare to
	empty string instead of '(null)'.

2010-06-03  Matthew Mundell <matthew.mundell@greenbone.net>

	Switch to agent UUIDs.

	* src/gsad.c (init_validator): Add validator "agent_id".
	(exec_omp_get): Pass agent_id instead of name to delete_agent_omp and
	get_agents_omp.

	* src/gsad_omp.c (delete_agent_omp, get_agents_omp): Expect agent_id
	instead of name param.

	* src/html/omp.xsl (agent): Pass agent_id instead of name in delete_agent
	and get_agents URLs.

2010-06-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-lsc-credentials-table): Widen actions column.

2010-06-03  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad.c (exec_omp_post): For selected LSC credentials in the
	create target command, use different field in req_parms. Added todo, as
	the proper solution might include creating a new field and validator
	for this parameter.

2010-06-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_agents_omp): Indent params properly.

2010-05-31  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/help.xsl: Added help for ADS authentication configuration.
	Added table of options for LDAP authentication configuration.

	* src/html/oap.xsl: Link the respective (ADS/LDAP) section in help
	page.

2010-05-28  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2010-05-28  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 1.0.0-beta7 release.

	* src/html/help.xsl: Updated version number.

	* CHANGES: Updated.

2010-05-27  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl (scanconfig_editor_nvt_families.html,
	scanconfig_family_details.html): Updated column table description
	(Risk and CVSS).

2010-05-27  Michael Meyer <michael.meyer@greenbone.net>

	* src/gsad.c (init_validator):
	Allow "-" character in hostnames when creating a new target.

2010-05-27  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad_oap.c (modify_ldap_auth_oap): Fixed conditions.

2010-05-27  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	For ADS configuration, send modification command to
	openvas-administrator.

	* src/gsad_oap.c (modify_ldap_auth_oap): Added new parameters for ADS
	configuration, new fail conditions. Made the command sent more flexible
	to handle both ads and "normal" ldap configurations.

	* src/gsad_oap.h (modify_ldap_auth_oap): Updated proto.

	* src/gsad.c (init_validator): Added new validators for group
	and domain.
	(req_params): Added group and domain variable.
	(free_resources): Free the new variables.
	(serve_post): Read group and domain from request.
	(exec_omp_post): Validate parameters, updated call to
	modify_ldap_auth_oap.

2010-05-27  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Display ADS configuration part of describe_auth response from
	administrator, if any. Modification not yet possible.

	* src/html/oap.xsl (group): Generalized, added display of ADS
	configuration.
	(describe_auth_response): Call group template with ADS configuration.

2010-05-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-config-family-table): Add columns for Risk and
	CVSS in the final row.  Remove the edit test from the end of the details
	version of the table.

2010-05-20  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/CMakeLists.txt: Cosmetics.

2010-05-20  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/oap.xsl (html-feed-form): Display a message and disable the
	synchronization button if the sync script reports that it is unable to
	sync.

2010-05-19  Matthew Mundell <matthew.mundell@greenbone.net>

	Add CVSS filtering to report results.

	* src/gsad.c (init_validator): Add validator min_cvss_base.
	(req_parms): Add min_cvss_base and apply_min_cvss_base.
	(free_resources): Free min_cvss_base and apply_min_cvss_base.
	(serve_post): Setup min_cvss_base and apply_min_cvss_base.
	(exec_omp_post): Pass min_cvss_base to create_note_omp.
	(exec_omp_get): Pass min_cvss_base to GET_REPORT related commands.

	* src/gsad_omp.c (get_report_omp, new_note_omp, create_note_omp)
	(delete_note_omp, edit_note_omp, save_note_omp): Add min_cvss_base
	arg, for GET_REPORT.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/omp.xsl (html-report-details): Pass min_cvss_base params to
	get_report.  Add CVSS checkbox to get_report filters.
	(html-create-note-form, html-edit-note-form, note-details)
	(result-detailed): Pass min_cvss_base params to pages that lead to
	get_report.

2010-05-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_report_response): Add syntax error check.

2010-05-19  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/omp.xsl (report [overview]): Display a message if the task
	has not yet finished.

2010-05-19  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/omp.xsl (report [overview]): Fix display of end time for
	still running scans.

2010-05-18  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl: Fix number of columns for "Result Filtering".

2010-05-18  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl: Make "Result Filtering" box look nicer.

2010-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/CMakeLists.txt: Add tags targets.

2010-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c: Add newline at end of file.
	(modify_ldap_auth_oap): Improve some formatting.

2010-05-18  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad.c (init_validator): Added new hostport-rule. Allow port
	definitions in ldap-host input validation.

	* src/html/help.xsl (configure_manager_auth.html): Added fact that port
	can specified in the hostname parameter.

2010-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	Add "Only show hosts that have results" filtering to report results.

	* src/gsad.c (init_validator): Add validator alias.
	(req_parms): Add result_hosts_only.
	(serve_post): Check for result_hosts_only.
	(exec_omp_post): Pass result_hosts_only to create_note_omp.
	(exec_omp_get): Pass result_hosts_only to delete_note_omp, edit_note_omp,
	get_report_omp, new_note_omp and save_note_omp.

	* src/gsad_omp.c (get_report_omp, new_note_omp, create_note_omp)
	(delete_note_omp, edit_note_omp, save_note_omp): Add result_hosts_only
	arg.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/omp.xsl (html-report-details): Pass result_hosts_only in
	get_report requests.  Add a result_hosts_only checkbox.
	(report, task, html-create-note-form, html-edit-note-form, note-detailed)
	(result_detailed): Pass result_hosts_only in requests that can return to
	the get_report page.

2010-05-18  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/omp.xsl (report [overview]): Shorten displayed start and
	and times.

2010-05-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [overview]): Add start and end times to host
	table.

2010-05-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (configure_targets.html): Change CIDR limit to 20.

2010-05-17  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad_base.c (xsl_transform): Return newly allocated error
	messages in case MHD decides to free them.

2010-05-17  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad_base.c (xsl_transform): Handle errors during XSL
	transformation more gracefully, clean up and return an error message
	if the transformation failed instead of aborting.

2010-05-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (validate_hosts_parameter): Limit CIDR mask to 20.

2010-05-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result-detailed): Add CVSS alongside result NVT name.

2010-05-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-config-family-table): Align CVSS right.

2010-05-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (risk_factor): New template.
	(html-config-family-table): Replace risk colour coding with "Risk" column.

2010-05-14  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad.c (init_validator): Expand search phrase validator to allow
	punctuation characters and German umlauts.

2010-05-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (nvt): Add CVSS base and risk factor.

2010-05-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsa-style.css (div.Critical, div.High, div.Medium, div.Low)
	(div.None): New rules.

	* src/html/omp.xsl (html-config-family-table): Add CVSS column, coloured
	according to risk factor.

2010-05-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (edit-config-preference): Make password entry like file
	entry.  Only show the download button for file prefs.

2010-05-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (tasks.html): Describe the new stopped and pause
	progress bars.  Improve the "running" description a little.

2010-05-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result-detailed): Skip NVT header line if OID is 0.

2010-05-11  Matthew Mundell <matthew.mundell@greenbone.net>

	Add downloading of file preferences.

	* src/gsad.c (init_validator): Add export_preference_file command.
	(exec_omp_get): Add export_preference_file handling.

	* src/gsad_omp.c (export_preference_file_omp): New function.
	(get_status): Always send the refresh interval, even when 0.

	* src/gsad_omp.h: Add headers accordingly.

	* src/html/omp.xsl (preference): Add file download button.
	(preference [details]): Name preference-details.  Add "config" param and
	file download button.
	(edit-config-preference): Rename param "config" to "for_config_details".
	Add param "config" and file download button.
	(preferences [details, edit-details]): Name preferences-details.  Add
	"config" param; pass through to preference-details and
	edit-config-preference.
	(html-config-nvt-table): Pass config through to preferences templates.

2010-05-11  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad.c (file_content_response): Check whether the requested path
	really is a regular file before trying to serve it as a file and
	report an error message if it is not.

2010-05-11  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad.c (init_validator): Improve validation to avoid formatting
	string attacks.

	* src/html/help.xsl (configure_manager_auth.html): Added need for %s
	in authdn parameter.

	* src/gsad_oap.c (modify_ldap_auth_oap): Added warning about %s in
	input string.

2010-05-11  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad_oap.c (modify_ldap_auth_oap): Handle input validation
	failure case, communicate to user.

	* src/html/oap.xsl (get_users_response, modify_auth_response): Show
	result of modify_auth command (and input validation).

2010-05-11  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Added handling of DESCRIBE_AUTH and MODIFY_AUTH oap commands.

	* src/gsad.c (init_validator): Added new modify auth and the important
	parameters authdn, ldaphost and enable to the validator.
	(gsad_connection_info): Added the parameters to req_parms struct.
	(serve_post): Fill the new parameters with chunks from request.
	(exec_omp_post): Handle modify_auth command, validate parameters,
	call new modify_ldap_auth_oap function.

	* src/gsad_oap.c (get_users_oap): Issue a DESCRIBE_AUTH when requesting
	users list.
	(modify_ldap_auth_oap): New. Implementation of new MODIFY_AUTH command.

	* src/gsad_oap.h (modify_ldap_auth_oap): Added proto.

	* src/html/help.xsl (configure_manager_auth.html): Added stub for
	help of new elements.

	* src/html/oap.xsl (get_users_response): Match describe_auth response.
	(group, describe_auth_response): Added window showing the and allowing
	modification of authentication settings, if any.

2010-05-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_user_oap): Send an empty HOSTS to set "Allow All".

2010-05-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task): Grey the stop button for "Internal Error".

2010-05-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (status_bar): Add progress bar and percentage for
	paused and stopped tasks.

2010-05-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/img/pause.png, src/html/img/pause_inactive.png: New files.

	* src/CMakeLists.txt: Install pause images.

2010-05-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (tasks.html): Add pausing states and pause action.

2010-05-07  Matthew Mundell <matthew.mundell@greenbone.net>

	Add pausing of tasks.

	* src/html/omp.xsl (status_bar): Add pausing states.
	(pause_task_response, resume_paused_task_response): New templates.
	(task): Show pause button for requested and running tasks.  Show resume
	button for paused tasks.

	* src/gsad_omp.c (pause_task_omp, resume_paused_task_omp): New functions.

	* src/gsad_omp.h: Add headers accordingly.

	* src/gsad.c (init_validator, exec_omp_get): Add pausing commands.

2010-05-07  Michael Wiegand <michael.wiegand@greenbone.net>

	Handle requests to non-existent pages more gracefully.

	* src/gsad.c: Include gsad_base.h directly.
	(file_content_response): Display an error message if a logged-in user
	requests a file that does not exist instead of logging him out
	forcefully.
	(request_handler): Display an error message if the requested help page
	does not start with a valid character.

2010-05-07  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/gsad.xsl (error_dialog), src/html/help.xsl (glossary.html):
	Fixed broken links to get_status page.

2010-05-07  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad.c: Added define MAX_HELP_NAME_SIZE to limit the maximum
	length of the name of help "files" against resource exhaustion
	attacks.
	(request_handler): Test if the name of the requested help page starts
	with a valid character before even considering it. Duplicate and
	truncate it to fit MAX_HELP_NAME_SIZE. Removed superfluous handling of
	"#" character since it is not present in the request sent by the
	browser anyway.

2010-05-07  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Added simple compile time syntax checks on the xsl files.

	* CMakeLists.txt: Lowercased a cmake command, check for xsltproc
	program.

	* src/CMakeLists.txt: Check xsl stylesheets with xsltproc, if found.

2010-05-07  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* CMakeLists.txt, src/CMakeLists.txt: Lowercased cmake commands as in
	all other openvas modules, converted tab to whitespaces.

2010-05-07  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad.c (init_validator): Allow "@" and "." characters in LSC
	login. Allow "@" character in LSC password.

2010-05-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl, src/html/oap.xsl: Convert tabs to spaces.

2010-05-06  Matthew Mundell <matthew.mundell@greenbone.net>

	Make saving of file preferences conditional on a checkbox.

	* src/html/omp.xsl (edit-config-preference): Add checkbox to "file"
	preferences so that saving the file is optional.

	* src/gsad_omp.c (save_config_nvt_omp): Add files arg which lists files
	that must be updated.

	* src/gsad_omp.h: Update header accordingly.

	* src/gsad.c (req_parms): Add files array.
	(free_resources): Free files.
	(serve_post): Collect files.
	(exec_omp_post): Pass files to save_config_nvt_omp.

2010-05-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (preference [details]): Print "File attached."
	instead of the contents of file preferences.

2010-05-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (preference [preference]): Print "File attached."
	instead of the contents of file preferences.

2010-05-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-escalator-form): Add "threat level
	changed" condition.
	(escalator, escalator [details]): Add "threat level changed" handling.

2010-05-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/: Finally remove empty directory.

2010-05-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Move up the html files on directory in order to eliminate
	the unnecessary additional directory "src".

	* src/html/src/favicon.gif, src/html/src/gsad.xsl,
	src/html/src/gsa-style.css, src/html/src/help.xsl,
	src/html/src/IE6fixes.css, src/html/src/img,
	src/html/src/login, src/html/src/oap.xsl, src/html/src/omp.xsl:
	Moved to src/html/.

	* src/CMakeLists.txt: Adjusted paths.

2010-05-01  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c: Added ":" to hosts validator to allow
	IPv6 adresses.

2010-04-28  Hartmut Goebel <h.goebel@goebel-consult.de>

	* src/html/src/IE6fixes.css: Fixed: In reports IE6 did shift
	issues to the left more and more.

2010-04-27  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/gsa-style.css, src/html/src/omp.xsl,
	src/html/src/gsad.xsl, src/html/src/oap.xsl,
	src/html/src/IE6fixes.css, src/html/src/help.xsl: Made
	older Konqueror work again. Thanks to Hartmut Goebel
	for this proposed fix.

2010-04-23  Hartmut Goebel <h.goebel@goebel-consult.de>

	* src/html/src/gsad.xsl, src/html/src/help.xsl
	src/html/src/omp.xsl, src/html/src/oap.xsl,
	src/html/src/gsa-style.css, src/html/src/login/login.html ,
	src/CMakeLists.txt: Fixed: IE6 did not display some content
	elements at all and table headers were visually cluttered.

	* src/html/src/IE6fixes.css: New stylesheet (onyl used by IE6).

2010-04-22  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad_omp.c (create_task_omp): Fixed syntax for schedule element
	when creating a new task.

2010-04-22  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/gsad.xsl, src/html/src/help.xsl: Add default duration
	for links to the performance monitor.

2010-04-15  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/src/help.xsl: Updated version number.

2010-04-15  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 1.0.0-beta6 release.

	* src/html/src/help.xsl: Updated version number.

	* CHANGES: Updated.

	* CMakeLists.txt: Added autogenerated files to
	CPACK_SOURCE_IGNORE_FILES.

	* doc/.built-html: Removed superfluous file.

2010-04-15  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/help.xsl: Corrected the maximum comment length.
	(glossary.html): Added entry for schedule to glossary.
	(new_task.html): Added missing help for comment field, added help for
	schedule field.
	(reports.html): Updated help for report summary.

2010-04-14  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/help.xsl (tasks.html): Updated help for tasks list with
	new features and elements.

2010-04-14  Michael Wiegand <michael.wiegand@greenbone.net>

	Set the GSA to use UTC as timezone to stay consistent with the manager
	when scheduling.

	* src/gsad.c (main): Set timezone to UTC.

	* src/html/src/omp.xsl (html-create-schedule-form): Mark time as UTC.

	* src/html/src/gsad.xsl (html-gsa-logo): Mark time as UTC.

2010-04-14  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/help.xsl (configure_escalators.html): Comments are
	not mandatory for escalators.

2010-04-14  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/help.xsl (configure_schedules.html): Added help for
	scheduling.

2010-04-13  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/help.xsl: Flush trailing whitespace.

2010-04-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/CMakeLists.txt: Fix some installation directives to
	make the login dialog appear properly.

2010-04-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/make_html, src/html/header.m4, src/html/template.m4,
	src/html/footer.m4: Removed.

	* src/CMakeLists.txt: Instead of insalling the build directory
	do direct installation.

2010-04-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/gsad.xsl: Changed URL for about page.

	* src/html/src/help.xsl: Added content of pages "about" and "gplv2".

	* src/html/src/about.htm4, src/html/src/gplv2.htm4: Removed.

2010-04-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Static help files are not necessary anymore.

	* src/html/make_html: Don't create directory "help".

	* src/html/src/help/view_report.htm4,
	src/html/src/help/scanconfig_nvt_details.htm4,
	src/html/src/help/scanconfig_editor_nvt.htm4,
	src/html/src/help/configure_targets.htm4,
	src/html/src/help/new_task.htm4,
	src/html/src/help/scanconfig_details.htm4,
	src/html/src/help/scanconfig_editor_nvt_families.htm4,
	src/html/src/help/scanconfig_editor.htm4,
	src/html/src/help/error_messages.htm4,
	src/html/src/help/scanconfig_family_details.htm4,
	src/html/src/help/configure_agents.htm4,
	src/html/src/help/tasks.htm4,
	src/html/src/help/notes.htm4,
	src/html/src/help/nvts.htm4,
	src/html/src/help/contents.htm4,
	src/html/src/help/reports.htm4,
	src/html/src/help/configure_scanconfigs.htm4,
	src/html/src/help/configure_credentials.htm4,
	src/html/src/help/feed_management.htm4,
	src/html/src/help/settings.htm4,
	src/html/src/help/performance.htm4,
	src/html/src/help/configure_escalators.htm4,
	src/html/src/help/configure_users.htm4,
	src/html/src/help/glossary.htm4, src/html/src/help/: Removed.

2010-04-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Patch contributed by Mareike Piechowiak <noplant@gmx.de>.

	This moves all help page content to XSL and thus allows
	to have user name and date in the header (which was not
	possible with the static files).

	* src/gsad.c (request_handler): Added handling of any URL
	with "/help/".

	* src/html/src/help.xsl: New. Contains all help texts
	of the .htm4 files.

	* src/html/src/gsad.xsl: Added inclusion of help.xsl.

2010-04-10 Stephan Kleine

	* src/CMakeLists.txt: Fix build with as-needed and remove duplicate lines.

2010-04-10 Stephan Kleine

	* CMakeLists.txt: Add support for out-of-source builds.

	* src/CMakeLists.txt: Add support for out-of-source builds.

2010-04-06  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/oap.xsl (html-feed-form): Display feed version.

2010-04-01  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/about.htm4: Make sure that supporters are in
	alphabetical order.

2010-04-01  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/omp.xsl (nvt): Display NVT tags if they are set.

2010-03-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (xsl_transform_omp): Add TIME to ENVELOPE.

	* src/gsad_oap.c (xsl_transform_oap): Add TIME to ENVELOPE.

	* src/html/src/gsad.xsl (html-gsa-logo): Add time under logout.
	(time): New template.
	(envelope): Pass time to html-gsa-logo.

2010-03-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_get): Add NULL guard for duration.

2010-03-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_schedules_omp, create_schedule_omp)
	(delete_schedule_omp): Add TIME to GET_SCHEDULES.

	* src/html/src/omp.xsl (opt): New template.
	(html-create-schedule-form): Create first time input via "opt" so that
	currect time is selected.

2010-03-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (edit_task): New function.  Body from edit_task_omp.  Add
	extra_xml arg.
	(edit_task_omp): Call through to edit_task.
	(save_task_omp): For comment or name error, put up the parameter error
	message on the edit_task page.

2010-03-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-edit-task-form): Make escalator editable.

	* src/gsad.c (init_validator): Add rule "escalator_id".
	(exec_omp_get): Pass escalator to save_task_omp.

	* src/gsad_omp.h: Update header accordingly.

	* src/gsad_omp.c (save_task_omp): Add schedule_id arg.  Include in
	MODIFY_TASK command.

2010-03-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-create-schedule-form): Remove minute units
	from period and duration.
	(html-edit-task-form): Add "(immutable)" to target and config input names.

2010-03-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (edit_task_omp): Add next and refresh_interval NULL
	checks.
	(save_task_omp): Remove refresh_interval NULL enforcement.

2010-03-28  Matthew Mundell <matthew.mundell@greenbone.net>

	Add basic task editing.

	* src/html/src/gsad.xsl (autorefresh [html-header-meta]): Only add header
	if interval is above 0.

	* src/html/src/omp.xsl (html-task-table): Widen actions column.
	(html-edit-task-form, edit_task, modify_task_response): New templates.
	(task): Add edit task button.

	* src/gsad.c (init_validator): Add edit_task and save_task commands.
	(exec_omp_get): Add edit_task and save_task handling.

	* src/gsad_omp.c (edit_task_omp, save_task_omp): New functions.
	(get_status): Always send the refresh interval, even when 0.

	* src/gsad_omp.h: Add headers accordingly.

2010-03-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (gsad_newtask): Add comment entry.

	* src/gsad.c (exec_omp_post): Pass comment from request to
	create_task_omp.

2010-03-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-report-table): Add comment field.
	(task): Add comment under name.

2010-03-28  Matthew Mundell <matthew.mundell@greenbone.net>

	Display schedule intervals in unit format.

	* src/html/src/omp.xsl (interval-with-unit): New template.
	(schedule): Call interval-with-unit for intervals.
	(schedule [details]): Display unit interval instead of just seconds.

2010-03-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-create-schedule-form): Add odd row
	background colours.  Switch period and duration input to time and unit
	dropdowns.
	(html-schedules-table): Remove "(s)" from period heading.
	(schedule): Include period months.  Add unit to period cells.  Shorten
	entire duration text.

	* src/gsad.c (init_validator): Add calendar_unit rule and duration_unit
	and period_unit aliases.
	(struct req_parms): Add duration_unit and period_unit.
	(free_resources): Free duration_unit and period_unit.
	(serve_post): Also pass units to create_schedule_omp.

	* src/gsad_omp.c (create_schedule_omp): Add period_unit and duration_unit
	args.  Add to CREATE_SCHEDULE request.

	* src/gsad_omp.h: Update header accordingly.

2010-03-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (schedule [details]): Add units to period and
	duration.

2010-03-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (schedule): Correct delete URL.

2010-03-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-create-schedule-form): Add "(optional)" to
	period and duration fields.

2010-03-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (schedule [details]): Get next_time for next time,
	instead of first_time.

2010-03-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-report-table): Get next time for "Next due",
	instead of name.

2010-03-24  Matthew Mundell <matthew.mundell@greenbone.net>

	Add schedule input to "New Task" page.

	* src/gsad.c (struct req_parms): Add schedule_id.
	(free_resources): Free schedule_id.
	(serve_post): Pass schedule ID to create_task_omp.

	* src/gsad_omp.c (gsad_newtask): Also get schedules.
	(create_task_omp): Add schedule_id arg.  Send to Manager in CREATE_TASK.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/src/omp.xsl (schedule [newtask]): New template.
	(gsad_newtask): Add schedule field.

2010-03-23  Matthew Mundell <matthew.mundell@greenbone.net>

	Add schedule creation.

	* src/gsad.c (init_validator): Add create_schedule command.
	Add validators for create_schedule.  Change duration to an
	"optional_number".
	(struct req_parms): Add params.
	(free_resources): Add param freeing.
	(serve_post): Add create_schedule handling.
	(exec_omp_get): Pass "0" to get_system_reports_omp if duration is empty.

	* src/gsad_omp.c (create_schedule_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/src/omp.xsl (html-create-schedule-form): Add schedule params.
	(get_schedules): Add call to html-create-schedule-form.

2010-03-22  Matthew Mundell <matthew.mundell@greenbone.net>

	Complete support for removing schedules.

	* src/gsad.c (init_validator): Add delete_schedule command.
	(exec_omp_get): Handle command "delete_schedule".

	* src/gsad_omp.c (delete_schedule_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

2010-03-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (delete_note_omp): Remove openvas_server_close called
	before session is open.  Closes #1334 (http://bugs.openvas.org/1334).

2010-03-20  Stephan Kleine

	* src/CMakeLists.txt: Install gsad into ${SBINDIR} since it is a service.

2010-03-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-report-table): Add schedule.

2010-03-18  Matthew Mundell <matthew.mundell@greenbone.net>

	Start list and details pages for schedules.

	* src/gsad_omp.c (get_schedule_omp, get_schedules_omp): New function.

	* src/gsad_omp.h: Add headers accordingly.

	* src/gsad.c (init_validator): Add get_schedule and get_schedules command.
	Add schedule_id validator.
	(exec_omp_get): Add get_schedule and get_schedules command handling.

	* src/html/src/omp.xsl (html-create-schedule-form, html-schedules-table)
	(create_schedule_response, delete_schedule_response, schedule)
	(schedule [details], get_schedule, get_schedules): New templates.

	* src/html/header.m4, src/html/src/gsad.xsl: Add "Schedules" menu item.

2010-03-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (task): Always grey resume and stop buttons for
	scheduled tasks.  Replace start button with scheduled button for scheduled
	tasks.

	* src/html/src/img/scheduled.png, src/html/src/img/scheduled_inactive.png:
	New files.  Created by Karl-Heinz Ruskowski.

2010-03-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/img/resume.png, src/html/src/img/resume_inactive.png: Make
	right margin wider.  Thanks to Karl-Heinz Ruskowski.

2010-03-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (DEFAULT_GSAD_PORT): Remove.
	(DEFAULT_GSAD_HTTP_PORT, DEFAULT_GSAD_HTTPS_PORT): New defines.
	(main): Use appropriate define for gsad_port, depending on http_only.

2010-03-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/help/scanconfig_details.htm4: Close tags properly.

2010-03-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (task): Use details button instead of list button
	for summary link.  Always enable this details button.
	(escalator [details], target [details], html-config-table): Use details
	button instead of list button for task summary link.

	* src/html/src/help/tasks.htm4: Make "Reports" section "Task Details".

	* src/html/src/help/scanconfig_details.htm4,
	src/html/src/help/scanconfig_editor.htm4: Switch to details button.

2010-03-15  Matthew Mundell <matthew.mundell@greenbone.net>

	Complete last commit: Add Manager-side task resuming.

	* src/html/src/omp.xsl (resume_stopped_task_response): New template.
	(task): Add resume button.

2010-03-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add command resume_stopped_task.
	(exec_omp_get): Add resume_stopped_task handling.

	* src/gsad_omp.c (resume_stopped_task_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/src/help/tasks.htm4: Add Resume Task section.

	* src/html/src/img/resume.png, src/html/src/img/resume_inactive.png: New
	files.  Created by Karl-Heinz Ruskowski.

2010-03-08  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/omp.xsl: Enable all levels for report downloads in the
	task summary.

2010-03-08  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/help/reports.htm4: Corrected image filenames.

2010-03-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (report): Add ITG and CPE to download formats.

2010-03-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_config_family_omp, get_config_family_omp)
	(get_config_nvt_omp): Add table qualifier to GET_NVT_DETAILS sort field.

2010-03-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (trend_meter): Get trend from OMP.

2010-03-04  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/src/about.htm4: Updated version number.

2010-03-04  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 1.0.0-beta5 release, part two.

	* src/html/src/about.htm4: Updated version number.

	* CHANGES: Updated, added line missing from last commit.

	* ChangeLog: Corrected entry.

2010-03-04  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CHANGES: Updated and improved a bit for beta4.

2010-03-04  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/help/reports.htm4: Added help texts for ITG and CPE.

2010-03-04  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 1.0.0-beta5 release, part one.

	* ChangeLog: Restored lost entry.

	* CHANGES: Updated.

2010-03-04  Michael Wiegand <michael.wiegand@greenbone.net>

	Add format for CPE inventory report.

	* src/html/src/omp.xsl (html-report-details): Add report format "CPE".

2010-03-03  Matthew Mundell <matthew.mundell@greenbone.net>

	Add format for IT-Grundschutz (German FSI IT baseline protection) report.

	* src/gsad.c (init_validator): Relax "format" rule.

	* src/gsad_omp.c (get_report_omp): Relax report format check.

	* src/html/src/omp.xsl (html-report-details): Add report format "ITG".

2010-03-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (DATE_2822_LEN): New define.
	(file_content_response): Add Last-Modified and Expires headers.

2010-03-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (get_nvt_details): Add a help button.

	* src/html/src/help/nvts.htm4: New page.

	* src/html/src/help/contents.htm4: Link to NVT Details in NVT help.

2010-03-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (wrap): Select substring correctly after wrap.

2010-03-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-edit-note-form): Add NVT name row before
	constraint rows.

2010-03-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-edit-note-form): Add details button.
	(note [details]): Correct alignment.

2010-03-02  Matthew Mundell <matthew.mundell@greenbone.net>

	Add edit button to get_note page.

	* src/gsad.c (exec_omp_get): Add edit_note and save_note cases for
	get_note page.

	* src/gsad_omp.c (get_note): New function.  Body from get_note_omp.
	(get_note_omp): Wrap get_note.
	(save_note_omp): Add get_note page handling.

	* src/html/src/omp.xsl (note [details]): Add edit button.
	(get_note): Expect get_notes_response in a commands_response.

2010-02-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (serve_post): Use append_chunk_string to setup string request
	parameters.

2010-02-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/oap.xsl (html-users-table): Sort by role then name.

2010-02-25  Matthew Mundell <matthew.mundell@greenbone.net>

	Add notes help.

	* src/html/src/help/notes.htm4: New file.

	* src/html/src/help/view_report.htm4: Correct typo.  Add notes sections.
	Mention "Show notes" filter.

	* src/html/src/help/glossay.htm4: Add a note entry.  Improve the NVT
	entry a little.

	* src/html/src/help/reports.htm4: Add notes section.

	* src/html/src/help/contents.htm4: Add notes item.

	* src/html/src/omp.xsl (html-report-table): Link help to reports help.
	(note [details], html-notes-table): Link help to notes.html.

2010-02-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (note [details]): Label task and result in orphans,
	otherwise they show as "Any".

2010-02-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (note, note [nvt-details]): Mark orphans.

2010-02-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/gsa-style.css (.issue_box_head): Remove stray colon.

2010-02-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (note-detailed): Use normal delete button.

2010-02-25  Matthew Mundell <matthew.mundell@greenbone.net>

	Add note editing.

	* src/html/src/omp.xsl (html-edit-note-form, edit_note)
	(modify_note_response): New templates.
	(note, note [nvt_details], note-detailed): Add edit note button.

	* src/gsad.c (init_validator): Add edit_note and save_note commands.  Add
	hosts_opt, note_task_id and note_result_id rules.
	(exec_omp_get): Add edit_note and save_note handling.

	* src/gsad_omp.c (edit_note_omp, save_note_omp): New functions.

	* src/gsad_omp.h: Add headers accordingly.

2010-02-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (result-detailed): Compare note count with 0
	instead of 1.

2010-02-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add DVI to "format".

	* src/gsad_omp.c (get_report_omp): Allow DVI as format.

2010-02-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (note): Decrease max to 35 so NVT name always fits
	on a single line.

2010-02-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (note-detailed): Put the "Last modified" line
	after the button float, so that Konqueror keeps the buttons inside the
	box.

2010-02-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-create-note-form): Check the more specific
	option in most constraints instead of the general option.

2010-02-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-create-note-form): Replace "All" with "Any".
	(note) [details]: Capitalise "any".

2010-02-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/omp.xsl (html-report-details): Prevent unnecessary
	wrapping.

2010-02-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (wrap): Handle the case of a single line that must
	wrap.

2010-02-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_get): Use fixed max_results values for notes.

	* src/html/src/omp.xsl (html-create-note-form): Remove max_results
	passthrough.
	(note-detailed, result-detailed): Remove max_results from requests.

2010-02-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (new_note_omp): Check all args.

2010-02-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (get_nvt_details): Only add notes table when there
	are notes.

2010-02-19  Matthew Mundell <matthew.mundell@greenbone.net>

	Add delete buttons on all note lists.

	* src/gsad.c (exec_omp_get): Call delete_note_omp according to page that
	must follow.

	* src/gsad_omp.c (get_nvt_details, get_status, get_note): New function.
	Bodies from _omp versions.
	(get_nvt_details_omp, get_status_omp, get_notes_omp): Call through to
	static functions.
	(delete_note_omp): Add more passthrough args, and next page arg.  Pass
	work to handler of next page.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/src/omp.xsl (html-report-table): Pass next page to note
	template.
	(get_nvt_details_response): Remove.
	(get_nvt_details): New template.
	(note): Add next param.  Enable button.
	(note) [nvt-details]: Enable button.
	(get_notes): Expect entites in a commands_response.
	(note-detailed): Add next page to request.

2010-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_nvt_details_omp, get_status_omp, get_notes_omp): Add
	GET_NOTES sort fields.

2010-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-create-note-form): Refer to anchor in query.
	(note-detailed): Refer to anchor in delete_note query.
	(result-detailed): Add anchor.

2010-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (result-detailed): Add notes button.

2010-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (note-detailed): Add details button.

2010-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_status_omp): Request notes with task.

	* src/html/src/omp.xsl (html-report-table): Add notes window.

2010-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Extend the "port" rule to allow ports like
	"port-name (111/tcp)".

2010-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-report-details, report, task)
	(html-create-note-form, note-detailed, result-detailed): Pass the "notes"
	flag when requesting a report.  Preserve the notes flag across new_note
	and delete_note.

2010-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-report-details): Test filters/notes directly
	instead of counting it.

2010-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-config-family-table): Count in
	get_nvt_details_response instead of all/get_nvt_details_response, in
	view case.

2010-02-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/gsa-style.css (.note_top_line): New style.

	* src/html/src/omp.xsl (note) [details]: Put note text in yellow box.

2010-02-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a note details page.

	* src/gsad_omp.c (get_note_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/gsad.c (init_validator): Add get_note command.
	(exec_omp_get): Add get_note command handling.

	* src/html/src/omp.xsl (note): Enable details button.
	(note) [nvt-details]: Enable details button.
	(note) [details]: New template.
	(get_note): New template.

2010-02-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_nvt_details_omp): Also request notes for the NVT.

	* src/html/src/omp.xsl (get_notes_response): New template.
	(get_nvt_details_response): Add notes section.
	(note, html-notes-table): Replace OID column with text column.
	(note) [nvt-details]: New template.

2010-02-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Add notes management page.

	* src/gsad_omp.c (get_notes_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/gsad.c (init_validator): Add get_notes command.
	(exec_omp_get): Add get_notes command handling.

	* src/html/src/omp.xsl (note, html-notes-table, get_notes): New templates.

	* src/html/header.m4, src/html/src/gsad.xsl: Add "Notes" menu item.

2010-02-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Add note filtering in reports.

	* src/html/src/omp.xsl (html-report-details): Add "Show notes" checkbox.

	* src/gsad.c (init_validator): Add "notes" validator.
	(struct req_parms): Add notes.
	(free_resources): Add param freeing.
	(serve_post): Pass notes arg to create_note_omp.
	(exec_omp_get): Pass notes arg to report related functions.

	* src/gsad_omp.c (get_report_omp, new_note_omp, create_note_omp)
	(delete_note_omp) Add notes arg.

	* src/gsad_omp.h: Update headers accordingly.

2010-02-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Put result on "New Note" page.

	* src/html/src/omp.xsl (html-create-note-form): Add "Associated Result"
	section.
	(html-result-box): Remove.
	(new_note): Remove call to html-result-box.
	(note, result) [detailed]: Add template name.  Add note-buttons param to
	control display of note buttons.

	* src/gsad_omp.c (new_note_omp): Include result in response.

2010-02-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/img/new_note.png, src/html/src/img/delete_note.png,
	src/html/src/img/note.png: New files.

	* src/html/src/omp.xsl (note, result) [detailed]: Use new note images.

	* ChangeLog: Correct omp.xsl paths.

2010-02-16  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/omp.xsl: Fixed a typo regarding refresh
	intervals. When selecting 60 seconds, the GUI applied 60
	but showed 30.

2010-02-15  Matthew Mundell <matthew.mundell@greenbone.net>

	Add note constraints.

	* src/gsad.c (init_validator): Add "port", "result_id" and "threat"
	validators.
	(struct req_parms): Add params.
	(free_resources): Add param freeing.
	(serve_post): Pass contraint args to create_note_omp.
	(exec_omp_get): Pass contraint args to new_note_omp.

	* src/gsad_omp.c (new_note_omp): Add constraint args.
	(create_note_omp): Add constraint args.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/src/omp.xsl (html-create-note-form): Add contraint input.
	(new_note): Pass contraint values to new_note.

2010-02-12  Matthew Mundell <matthew.mundell@greenbone.net>

	Add adding of notes.

	* src/gsad.c (init_validator): Add create_note and new_note commands.
	Add "max_results" and "text" validators.
	(struct req_parms): Add params.
	(free_resources): Add param freeing.
	(append_chunk_string): New function.
	(serve_post): Add create_note handling.
	(exec_omp_get): Pass get_report params to delete_note_omp.  Add new_note
	handling.

	* src/gsad_omp.c (new_note_omp, create_note_omp): New function.
	(delete_note_omp): Add get_report params.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/src/omp.xsl (html-create-note-form, html-result-box, new_note)
	(create_note_response): New templates.
	(note) [detailed]: Wrap note text.  Pass get_report params to delete_note.
	(result) [detailed]: Add "new note" button.

2010-02-12  Matthew Mundell <matthew.mundell@greenbone.net>

	Add removal of notes.

	* src/gsad.c (init_validator): Add delete_note command.  Add "note_id"
	validator.
	(exec_omp_get): Handle command "delete_note".

	* src/gsad_omp.c (delete_note_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/src/omp.xsl (delete_note_response): New template.
	(note) [detailed]: Add delete button.

2010-02-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (note) [detailed]: New template.
	(result) [detailed]: Apply any notes.

	* src/html/src/gsa-style.css (.issue_box_box): Zero margin-bottom.
	(.note_box_box): New style.

	* src/gsad_omp.c (get_report_omp): Request notes.

2010-02-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (escalator) [details]: Remove greying of method
	background.

2010-02-08  Tim Brown <timb@openvas.org>

	* src/gsad.c: Fixed couple of leaks reported by cppcheck.

2010-02-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (wrap): Lower wrap column to 90.

2010-02-05  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/src/about.htm4: Updated version number.

2010-02-05  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 1.0.0-beta4 release.

	* src/html/src/about.htm4: Updated version number.

	* CHANGES: Updated.

2010-02-04  Matthew Mundell <matthew.mundell@greenbone.net>

	Wrap lines of result descriptions during the XSL transform.

	* src/html/src/omp.xsl (wrap): New template.
	(result) [detailed]: Add PRE around description.  Filter description
	through wrap template.

	* src/html/src/gsa-style.css (.issue_box_box): Remove white-space and
	font-family.

2010-02-04  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/omp.xsl: Reconciled value of of increment with max value
	in exec_omp_get in gsad.c to repair pagination.

2010-02-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (result) [detailed]: Remove PRE from description.

	* src/html/src/gsa-style.css (.issue_box_box): Add line wrapping, space
	preservation and PRE like font.

2010-02-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (lsc_credential) [details]: Remove colon from
	heading.

2010-02-01  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/omp.xsl: Made file entries have same length
	as text entries.

2010-01-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (get_status_response): Correct substring args.
	(html-create-lsc-credential-form): Add empty values to some empty inputs.

	* src/html/src/gsad.xsl (html-gsa-logo): Add image title.

	* src/gsad_oap.c (save_user_oap): Correct comment.
	(get_feed_oap): Correct message texts.

2010-01-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/oap.xsl (describe_feed_response): Check for failure.
	(html-feed-form): Add details if sync in progress.  Correct button
	greying test.

2010-01-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* ChangeLog: Format last entry better.

2010-01-28  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad_oap.c (create_user_oap, save_user_oap, delete_user_oap)
	(edit_user_oap, get_user_oapt_users_oap, get_feed_oap, sync_feed_oap)
	(get_settings_oap, edit_settings_oap, save_settings_oap): Use new
	library read_string function to access only the string of gnutls
	session.

	* src/gsad_omp (check_modify_config, gsad_newtask, get_status_omp)
	(create_lsc_credential_omp, get_lsc_credential_omp, create_agent_omp)
	(delete_agent_omp, create_escalator_omp, delete_escalator_omp)
	(get_escalator_omp, get_escalators_xml, test_escalator_omp)
	(create_target_omp, delete_target_omp, get_target_omp, get_targets_omp)
	(create_config_omp, import_config_omp, get_config_family_omp)
	(get_config_nvt_omp, get_report_omp, get_system_reports_omp): Use new
	library read_string function to access only the string of gnutls
	session.

2010-01-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (send_redirect_header)
	(create_http_authenticate_response): Add Expires and Cache-Control
	headers.
	(file_content_response): Use MHD defines for header names.

2010-01-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (file_content_response): Indent args.  Downcase @todos.
	Move fopen return check for default_file into block that does fopen.
	Add Expires and Cache-Control headers if path matches default_file.

2010-01-28  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad.c (request_handler): Simplified conditional.

2010-01-27  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/src/about.htm4: Updated version number.

2010-01-27  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 1.0.0-beta3 release.

	* src/html/src/about.htm4: Updated version number.

	* CHANGES: Updated.

2010-01-27  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* README: Updated.

2010-01-27  Matthew Mundell <matthew.mundell@greenbone.net>

	Add option to run in chroot.  Most of work by Felix Wolfsteller.

	* src/gsad.c (file_content_response): Make file path relative.
	(drop_privileges): New function.
	(main): Add option --do-chroot.  Change into the state directory
	before starting the HTTP daemon, so that all paths can be relative.
	If --do-chroot is given, chroot into the state dir and drop
	privileges.  Move PID file creation to come before the chroot.

	* src/gsad_base.c (XSL_PATH): Make relative.

2010-01-27  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad.c (request_handler): Collapse two conditionals with
	identical body.

2010-01-27  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Basic input checking when serving files. Set content type for images.

	* src/gsad_base.h: Added new content type (text/css).

	* src/gsad.c (gsad_add_content_type_header): Added new text/css
	content type.
	(file_content_response): Set content type and disposition, check url
	parameter to not contain "..".
	(request_handler): Pass content type and disposition to
	file_content_response.

2010-01-27  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad.c (create_http_authenticate_response): New, extracted from
	(send_http_authenticate_header).
	(file_content_response): New, extracted from request_handler
	(request_handler): Call extracted function, use http_response code
	variable to store the response code instead of immediate sending
	responses.

2010-01-27  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad.c: Added TODOs.

2010-01-27  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Set content-type header for error pages.

	* src/gsad.c (send_response): Add content type header to response.
	(send_redirect_header, send_http_authenticate_header): Use
	libmicrohttpd macros.

2010-01-27  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Further removal of global variables, closing mem leaks.

	* src/gsad.c: Removed global variable content_disposition and
	response_size.
	(exec_omp_get): Added new parameter.
	(request_handler): Added local variables as replacements for the global
	ones, pass as new parameter to functions.

2010-01-27  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Switched from using dynamic strings as http header content-type field
	to static strings, resolving a mem leak and possible contention issues.
	Set the content-type header field for more responses, minor consistency
	improvements of response-building.

	* src/gsad_base.h: Introduced new enum "content_type".

	* src/gsad.c: Removed global content_type variable.
	(content_type_from_format_string): New function.
	(exec_omp_get): Added content type return parameter instead of
	modification of global variable from within function, updated call to
	export_config_omp.
	(gsad_add_content_type_header): New function to add content type
	header to responses.
	(request_handler): Adjusted doc, added TODO about weird
	function/comment, use new content_type, minor refactoring of response-
	building code blocks.
	(main): Adjusted comment, moved pointers to certificate and key into
	single block where they are used.

	* src/gsad_omp.c (delete_lsc_crendential_omp)
	(get_lsc_crendential_omp, save_config_family_omp, save_config_nvt_omp):
	Repaired doc.
	(export_config_omp, get_system_reports_omp, get_system_report_omp): Use
	new content_type.

	* src/gsad_omp.h: Adjusted protos.

2010-01-27  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/src/about.htm4: Updated version number.

2010-01-27  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CMakeLists.txt: Added files to ignore for source packaging.

2010-01-27  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Preparing the gsa 1.0.0-beta2 release.

	* src/html/src/about.htm4: Updated version number.

	* CHANGES: Updated.

2010-01-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (main): Add options --alisten and --mlisten.

	* src/gsad_omp.c (manager_address): New variable.
	(omp_init): Add address argument.
	(is_omp_authenticated, manager_connect): Pass address to
	openvas_server_open.

	* src/gsad_omp.h: Update header accordingly.

	* src/gsad_oap.c (administrator_address): New variable.
	(oap_init): Add address argument.
	(administrator_connect): Pass address to openvas_server_open.

	* src/gsad_oap.h: Update header accordingly.

2010-01-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (gsad_address): New variable.
	(main): Add --listen option.  Pass address to MHD_start_daemon.

2010-01-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (main): Neaten MHD_start_daemon calls.

2010-01-26  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/src/help/configure_targets.htm4: Removed part about
	definition of ip-ranges and noted the cidr-netmask limit.

2010-01-26  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad_omp.c (serve_post): Own conditional for host parameter
	validation.
	(exec_omp_post): Validate host parameter
	(validate_hosts_parameter): Use gchar and respective function instead
	of char.

2010-01-26  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad.c (validate_hosts_parameter): New function, checks cidr
	netmasks.
	(serve_post): Call new validation function for hosts parameter.

2010-01-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (main): Add option --http-only.

2010-01-25  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad_omp.c (get_report_omp): Do not close the server connection
	a second time in error case.

2010-01-25  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad_omp.c (get_report_omp): Just send the xml describing the
	report if xml report is requested.

2010-01-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report_omp): If the format is XML send the plain
	XML, and if the format is NULL send the XSL transformed XML (that is,
	send the HTML page).

2010-01-25  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Updated help.

	* src/html/help/configure_credentials.htm4,
	src/html/help/configure_targets.htm4,
	src/html/help/configure_users.htm4,
	src/html/help/glossray.htm4: Updated help.

2010-01-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/gsa-style.css (.gb_window_part_center)
	(.gb_window_part_center_error, .logo_l, .logo_r, .logout_panel): Set
	colours so that text shows up when images are off in the browser.

2010-01-22  Matthew Mundell <matthew.mundell@greenbone.net>

	Remain on the task page after deleting the task's last report.

	* src/html/src/omp.xsl (html-report-table): Apply the report
	template explicitly.
	(report): Replace with body of get_status_response/task/report.  Go two
	up to get to the task ID.
	(get_status_response/task/report): Remove.
	(get_status_response): Determine if the reports are present by checking
	for task/reports instead of a task/report.
	(commands_response/get_status_response): Remove, redundant.

2010-01-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (redirect_pid): New variable.
	(gsad_cleanup): Kill redirect child in parent.
	(main): Set redirect_pid in parent.  Set SIGCHLD to SIG_IGN.  Remove
	pidfile creation from redirect child.

2010-01-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/oap.xsl (user) [edit]: Switch the modify_password values.

2010-01-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/oap.xsl (user): Account for "custom" access rules.

2010-01-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/oap.xsl (user) [edit]: Make the Host Access radios match
	the user's rights.

2010-01-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Revert create_target hosts validator to
	"hosts".

2010-01-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl: Make all alt's "Details" for details buttons.

2010-01-20  Matthew Mundell <matthew.mundell@greenbone.net>

	Add user details page and editing of user details.

	* src/gsad.c (init_validator): Add "edit_user", "get_user" and "save_user"
	commands.  Add rule "modify_password".
	(struct req_parms): Add modify_password.
	(free_resources, serve_post): Add modify_password handling.
	(exec_omp_post): Add save_user command.
	(exec_omp_get): Add edit_user and get_user commands.

	* src/gsad_oap.c (save_user_oap, edit_user_oap, get_user_oap): New
	functions.

	* src/gsad_oap.h: Add headers accordingly.

	* src/html/src/oap.xsl (html-create-user-form): Order options
	alphabetically, and force selection of "User".
	(user): Add details and edit buttons.
	(user) [details] [edit]: New templates.
	(edit_user, get_user): New templates.

2010-01-19  Matthew Mundell <matthew.mundell@greenbone.net>

	Add user host access to user list.  Make "Allow All" possible when
	creating a user.

	* src/gsad.c (init_validator): Add "access_hosts" rule.  Add 2 to
	"hosts_allow".
	(struct req_parms): Add access_hosts.
	(free_resources, serve_post): Add access_hosts handling.
	(exec_omp_post): Pass access_hosts instead of hosts to create_user_oap.

	* src/gsad_oap.c (create_user_oap): Leave out HOSTS if hosts_allow is 2.

	* src/html/src/oap.xsl (html-create-user-form): Make "Host Access"
	mandatory, with a "Allow All" radio.
	(html-users-table): Add "Host Access" column.
	(user): Add host access details.

2010-01-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/gsad.xsl, src/html/src/about.htm4: Extending Copyright
	to 2010.

2010-01-19  Matthew Mundell <matthew.mundell@greenbone.net>

	Add setting of user host access.

	* src/gsad.c (init_validator): Add "hosts_allow" rule.
	(struct req_parms): Add hosts_allow.
	(free_resources, serve_post): Add hosts_allow handling.
	(exec_omp_post): Pass hosts and hosts_allow to create_user_oap.

	* src/gsad_oap.c (create_user_oap): Add HOSTS to CREATE_USER according to
	new args hosts and hosts_allow.

	* src/gsad_oap.h: Update header accordingly.

	* src/html/src/oap.xsl (html-create-user-form): Add "Host Access" input.

2010-01-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Make create_user "name" a "login".

	* src/html/src/oap.xsl (html-create-user-form): Relabel "Name" as
	"Login Name", and make the input name "login".

2010-01-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add \ to credential_login characters.

2010-01-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/oap.xsl (user): Grey delete button for current user.

2010-01-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add \ to lsc_password characters.

2010-01-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/oap.xsl (scanner_settings): Only enable edit button if
	settings are editable.

2010-01-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (get_status_response)
	(commands_response/get_status_response): Add error check.

	* src/html/src/oap.xsl (get_settings_response): Indent by 2 like rest.

2010-01-14  Matthew Mundell <matthew.mundell@greenbone.net>

	Add editing of scanner settings.

	* src/gsad.c (init_validator): Add commands "edit_settings" and
	"save_settings".
	(exec_omp_post): Add command "save_settings".
	(exec_omp_get): Add command "edit_settings".

	* src/gsad_oap.c (edit_settings_oap, save_settings_oap): New functions.

	* src/gsad_oap.h: Add headers accordingly.

	* src/html/src/oap.xsl (scanner_settings): Add edit button.
	(scanner_settings, setting, get_settings_response) [edit]: New templates.
	(get_settings, edit_settings): New templates.

2010-01-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/about.htm4: Added supporters with their logos.

	* src/html/src/img/bsi-logo.png, src/html/src/img/gb-logo.png,
	src/html/src/img/intevation-logo.png: New.

2010-01-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_oap.c (sync_feed_oap): Add DESCRIBE_FEED to COMMANDS so that
	the sync result comes back on the Feed Management page.

2010-01-13  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Updated help.

	* src/html/src/help/scanconfig_familiy_details.htm4,
	src/html/scanconfig_editor.htm4,
	src/html/scanconfig_editor_nvt_families.htm4,
	src/html/src/help/scanconfig_details.htm4,
	src/html/src/help/scanconfig_family_details.htm4: Added links to other
	help pages.

	* src/html/src/help/scanconfig_editor_nvt.htm4: New. Accidentally
	ommitted in last commits. Contains help texts regarding
	Scan Config NVT Editor.

2010-01-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/help/contents.htm4: Indention for subgroups.
	Added a link for each separate file.

2010-01-12  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Updated help.

	* src/html/src/help/scanconfig_familiy_details.htm4: New. Contains
	help texts regarding Family Details Viewing functionality.

	* src/html/src/help/scanconfig_nvt_details.htm4: New. Contains help
	texts regarding NVT and NVT Preference Viewing functionality

	* src/html/src/omp.xsl: Added links to new help pages.

2010-01-12  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/src/about.htm4: Updated.

2010-01-12  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 1.0.0-beta1 release.

	* CMakeLists.txt: Updated version number.

	* src/html/src/about.htm4: Updated.

	* CHANGES: New.

2010-01-12  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Minor help improvements and fixes.

	* src/html/src/help/scanconfig_editor.htm4: Fixed link.

	* src/html/src/help/scanconfig_editor_nvt_families.htm4: Added links
	to glossary.

2010-01-12  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Added help and some fixes.

	* src/html/src/help/scanconfig_editor_nvt_families.htm4: New. Contains
	help texts regarding Scan Config Editors Family Details functionality.

	* src/html/src/help/scanconfig_editor.htm4: Fixed closing tags, added
	note about non-modificatability of scan configs in use.

	* src/html/src/help/scanconfig_details.htm4: Fixed/Added missing quote.

	* src/html/header.m4: Added macros for details and edit icons.

	* src/html/src/omp.xsl: Added link to new help page.

2010-01-12  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Added help.

	* src/html/src/help/scanconfig_editor.htm4: Updated with help
	texts describing the Scan Config Editor functionality.

	* src/html/src/help/scanconfig_details.htm4: Added alt and title
	parameters to icons, corrected heading.

	* src/html/src/omp.xsl: Added link to new help page.

2010-01-11  Matthew Mundell <matthew.mundell@greenbone.net>

	Add text phrase filtering to report results.

	* src/html/src/gsa-style.css (table.odd): New style.

	* src/gsad.c (init_validator): Add rule "search_phrase".
	(exec_omp_get): Pass search_phrase to get_report_omp.

	* src/gsad_omp.c (get_report_omp): Add argument search_phrase.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/src/omp.xsl (html-report-details): Add test phrase filter to
	threat filter.  Grey background of both.  Remove threat filter
	"Current View" and rename "New Filter" to "Threat".

	* src/html/src/help/reports.htm4: Try improve some descriptions.  Correct
	typos.  Describe text phrase filtering.

2010-01-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): Pass gsize to get_system_report_omp.

2010-01-11  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Updated help.

	* src/html/src/help/configure_credentials.htm4,
	src/html/src/help/configure_escalators.html4,
	src/html/src/help/configure_targets.htm4: Updated with "details"
	section.

	* src/html/src/omp.xsl: Link from pages to new help texts.

2010-01-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (result) [detailed]: Add NVT name.

2010-01-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Updating help.

	* src/html/src/help/tasks.htm4: Added section on auto-refresh.

	* src/html/src/help/contents.htm4: Added more link.
	Ordered according to user interface.

	* src/html/src/help/configure_scanconfigs.htm4: Fixed links.

	* src/html/src/help/scanconfig_editor.htm4: New.

	* src/html/src/help/configure_escalators.htm4: Added section
	on test escalator.

2010-01-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/gsa-style.css (small_inline_form): New style.

	* src/html/src/omp.xsl (html-task-table): Neaten indentation.  Put the
	form inside a small_inline_form div.  Remove the font-size and display
	styles from the form and select.
	(html-create-escalator-form): Alternate background colours of rows.
	(create_config_response): Only print details if a config was created and
	there's a config/name in the response.

	* src/html/src/help/reports.htm4: Correct phrase.

2010-01-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (get_system_reports): Add failure message.

2010-01-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/help/performance.htm4: New file.

2010-01-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_lsc_credential_omp): Add check for password
	validation failure.

	* src/gsad.c (init_validator): Add rule "lsc_password".
	(exec_omp_post): Verify create_lsc_credential_omp password with
	"lsc_password".

2010-01-08  Matthew Mundell <matthew.mundell@greenbone.net>

	Add HTTP to HTTPS redirection.

	* src/gsad.c (DEFAULT_GSAD_REDIRECT_PORT, MAX_HOST_LEN): New defines.
	(redirect_location): New variable.
	(redirect_handler): New function.
	(main): Add options --rport and --redirect.  If --redirect is present then
	fork an HTTP server that redirects any request to the HTTPS server.

2010-01-07  Matthew Mundell <matthew.mundell@greenbone.net>

	Add performance reports page.

	* src/gsad_omp.c (get_system_reports_omp, get_system_report_omp): New
	function.

	* src/gsad_omp.h: Add headers accordingly.

	* src/gsad.c (init_validator): Add get_system_reports command.  Add rule
	"duration".
	(exec_omp_get): Add get_system_reports command handling.
	(request_handler): Add system report image response.

	* src/html/src/omp.xsl (system_report, get_system_reports): New templates.

	* src/html/header.m4, src/html/src/gsad.xsl: Add "Performance" menu item.

2010-01-06  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/src/help/configure_scanconfigs.htm4: Added help text about
	import and export scan configs, removed text about importing openvasrc.

	* src/html/src/omp.xsl: Link to new help section.

2010-01-06  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Resolved compile issues on 64bit systems.

	* src/gsad.c (serve_post): Cast size_t to int (.* format expects
	integer).

2010-01-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (create_config_response): Pass config name in
	result details.

2010-01-06  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/src/omp.xsl: Fixed TODO: pre-select the chosen refresh
	interval in task overview table.

2010-01-06  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* CMakeLists.txt: Corrected libopenvas version check.

	* ChangeLog: Corrected date.

2010-01-05  Matthew Mundell <matthew.mundell@greenbone.net>

	Add XML config importing.  Remove RC file importing.

	* src/gsad_omp.c (create_config_omp): Remove RC file handling.
	(import_config_omp): New function.
	(export_config_omp): Use GET_CONFIGS export attribute.

	* src/gsad_omp.h: Update headers accordingly.

	* src/gsad.c (init_validator): Add import_config command.  Remove rule
	"rcfile".  Add rule "xml_file".
	(struct req_parms): Remove rcfile.  Add xml_file.
	(free_resources, serve_post, exec_omp_post): Remove rcfile handling.  Add
	xml_file handling.
	(exec_omp_get): Handle command import_config.

	* src/html/src/omp.xsl (html-create-config-form): Remove RC import option.
	(html-import-config-form): New template.
	(get_configs_response): Call html-import-config-form.

2010-01-05  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Added basic auto-refresh functionality for the tasks table.

	* src/gsad.c (init_validator): Added new "number" and refresh_interval
	entries, sorted.
	(exec_omp_post): Pass new parameter to get_status_omp.
	(exec_omp_get): Minor formatting, read passed refresh_interval request
	parameter, validate and pass it to get_status_omp.

	* src/gsad_omp.c (get_nvt_details_omp): Added parameter and pass new
	<autorefresh> element to the xsl transformation.
	(create_lsc_credential_omp): Analogous to get_nvt_details_omp, allocate
	GString only when needed.

	* src/gsad_omp.h (get_nvt_details_omp): Adjusted header.

	* src/html/src/gsad.xsl: Added handling of new <auto_refresh> element.

	* src/html/src/omp.xsl: For the tasks table case, added a form to chose
	the refresh interval. Added TODO about pre-selecting the selected value
	after a refresh happened.

	* src/html/make_html: Removed second newline at end of file.

2010-01-05  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* CMakeLists.txt: Corrected version check for libopenvas, required
	version is now 3.0.1.

2010-01-05  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* CMakeLists.txt: Added clumsy libopenvas required version check and
	TODO regarding possible improvements.

2010-01-05  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* CMakeLists.txt: Lowercased some cmake commands.

2010-01-04  Matthew Mundell <matthew.mundell@greenbone.net>

	Add config exporting.

	* src/gsad_omp.c (export_config_omp): New function.

	* src/gsad_omp.h: Add header.

	* src/gsad.c (init_validator): Add export_config command.
	(exec_omp_get): Handle command export_config.

	* src/html/src/omp.xsl (config): Add an export button.

2010-01-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add email rule.
	(escalator_data): New function.
	(exec_omp_post): Check email addresses.

	* src/html/src/omp.xsl (html-create-escalator-form): Match email length to
	validator.

2009-12-31  Matthew Mundell <matthew.mundell@greenbone.net>

	Add test escalator buttons to the escalators page.  Add "From
	Address" to escalator email input.

	* src/gsad_omp.c (get_escalators_xml, test_escalator_omp): New functions.
	(get_escalators_omp): Call get_escalators_xml.

	* src/gsad_omp.h: Add header.

	* src/gsad.c (init_validator): Add test_escalator command.
	(exec_omp_get): Handle command test_escalator.

	* src/html/src/omp.xsl (html-create-escalator-form): Add "From
	Address" field.  Rename "Message" to "Format".
	(escalator): Add test button.  Add "To" to before address.
	(test_escalator_response): New template.
	(escalator mode=details): Add from address.
	(get_escalators): Apply test_escalator_response.

2009-12-31  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Updated help texts.

	* src/html/src/configure_agents.htm4,
	src/html/src/configure_credentials.htm4,
	src/html/src/configure_targets.htm4: Updated.

2009-12-31  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/src/omp.xsl: Link help from scanconfig details page.

	* src/html/src/help/scanconfig_details.htm4: New.

	* src/html/src/help/configure_scanconfigs.htm4: Slightly improved, link
	to new help page.

2009-12-31  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* ChangeLog: Corrected paths.

	* src/html/src/help/configure_escalators.htm4: New.

	* src/html/src/help/configure_scanconfigs.htm4,
	src/html/src/help/glossary.htm4,
	src/html/src/help/new_task.htm4,
	src/html/src/help/tasks.htm4,
	src/html/src/help/view_report.htm4: Updated new and changed options.

2009-12-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/help/tasks.htm4: Added information to
	status "Stopped".

2009-12-30  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/src/help/configure_agents.htm4,
	src/html/src/help/configure_credentials.htm4,
	src/html/src/help/configure_targets.htm4,
	src/html/src/help/configure_users.htm4,
	src/html/src/help/tasks.htm4: Fixed typo.

2009-12-30  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* CMakeLists.txt: Adjusted todo, as check for libmicrohttpd is already
	done.

	* src/CMakeLists.txt: Declared libraries as static.

2009-12-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/help/contents.htm4: Add a "you".

	* src/html/src/help/tasks.htm4: Correct a few typos.

2009-12-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c: Clean and add some todos and comments.
	(exec_omp_post): Format strcmp like others.
	(free_resources): Remove NULL checks from around frees.

2009-12-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (nvt, get_nvt_details_response): Match to other
	details pages.

2009-12-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a escalator details page.

	* src/gsad_omp.c (get_escalator_omp): New function.

	* src/gsad_omp.h: Add header.

	* src/gsad.c (init_validator): Add get_escalator command.
	(exec_omp_get): Handle command get_escalator.

	* src/html/src/omp.xsl (html-report-table): Link escalator to details.
	(escalator): Add details button.
	(escalator mode=details, get_escalator): New templates.

2009-12-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Handle the OMP MODIFY_CONFIG "config in use" error with a small error
	dialog instead of a generic big dialog.

	* src/gsad_omp.c (check_modify_config): New function.
	(save_config_omp, save_config_family_omp, save_config_nvt_omp): Call
	check_modify_config instead of check_response to check response.

2009-12-27  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a credential details page.

	* src/gsad_omp.c (get_lsc_credential_omp): New function.

	* src/gsad_omp.h: Add header.

	* src/gsad.c (init_validator): Add get_lsc_credential command.
	(exec_omp_get): Handle command get_lsc_credential.

	* src/html/src/omp.xsl (target): Link credential to details.
	(target mode=details): Correct element name.  Link credential to details.
	(lsc_credential): Add details button.
	(lsc_credential mode=details, get_lsc_credential): New templates.

2009-12-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* ChangeLog: Repair after last commit.

2009-12-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-create-escalator-form): Add 'Threat level
	at least' condition.
	(escalator): Print level with 'Threat level at least' condition.

2009-12-27  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a target details page.

	* src/gsad_omp.c (get_target_omp): New function.

	* src/gsad_omp.h: Add header.

	* src/gsad.c (init_validator): Add get_target command.
	(exec_omp_get): Handle command get_target.

	* src/html/src/omp.xsl (html-report-table): Link target to details.
	(target): Add details button.
	(target mode=details, get_target): New templates.

2009-12-24  Matthew Mundell <matthew.mundell@greenbone.net>

	Add Escalators.

	* src/gsad.c (init_validator): Add escalator commands.  Add "condition",
	"escalator", "event" and "method" validators.
	(struct req_parms): Add fields for escalator commands.
	(free_resources): Init escalator resources.
	(serve_post): Check and setup escalator keys.
	(exec_omp_post): Handle command "create_escalator".  Pass escalator to
	create_task_omp.
	(exec_omp_get): Handle commands "delete_escalator" and "get_escalators".

	* src/gsad_omp.c (gsad_newtask): Also get escalators.  Correct two error
	message strings.
	(create_task_omp): Add escalator arg.
	(send_escalator_data, create_escalator_omp, delete_escalator_omp)
	(get_escalators_omp): New functions.

	* src/gsad_omp.h: Add and update headers accordingly.

	* src/html/src/omp.xsl (html-report-table): Add escalator link.
	(escalator, html-create-escalator-form, html-escalators-table)
	(create_escalator_response, delete_escalator_response)
	(escalator, get_escalator): New templates.
	(gsad_newtask): Add escalator selector.

	* src/html/src/gsad.xsl (html-gsa-navigation): Add Escalators menu item.

	* src/html/src/help/contents.htm4: Add Escalators menu item.

	* src/html/headers.m4: Add Escalators menu item.

2009-12-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad_omp.h: Updated according to last commit.

2009-12-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_agents_omp): Change result_len to gsize.

2009-12-22  Michael Wiegand <michael.wiegand@greenbone.net>

	Fixed variable types for 64bit compatibility in Base64 decoding.

	* src/gsad_omp.c (get_lsc_credentials_omp): Changed result_len to gsize.
	(get_report_omp): Changed report_len to gsize.

	* src/gsad_omp.h: Updated.

	* src/gsad.c: Changed response_size and header_auth_decoded_len to
	gsize.

2009-12-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/src/about.htm4: Updated.

2009-12-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 0.8.3 release.

	* src/html/src/about.htm4: Updated.

2009-12-21  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt: Don't ignore necessary files when creating the source
	tarball.

2009-12-21  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/help/contents.htm4: Added agent help to help contents.

2009-12-21  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/img/agent.png: New.

2009-12-21  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/oap.xsl: Include settings error message if there is one.
	Make sure filename is correctly aligned, even in Konqueror.

2009-12-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (append_chunk_binary): New function.
	(serve_post): Use append_chunk_binary for binary keys.
	(request_handler): Move authentication check down into GET and POST cases.
	Only authentication for the first chunk of a POST request.

	* src/html/src/omp.xsl (html-create-agent-form): Comment out the HOWTOs.

2009-12-18  Matthew Mundell <matthew.mundell@greenbone.net>

	Enable agent download button.

	* src/gsad.c (init_validator): Add "agent_format".
	(struct req_parms): Add fields for agent installer and HOWTO.
	(free_resources): Free installer and HOWTO fields.
	(serve_post): Fill installer and HOWTO fields.
	(exec_omp_post): Pass installer and HOWTO fields to create_agent_omp.
	(exec_omp_get): Expect format in request parameter "agent_format"
	instead of in "package_format".  Switch MIME type to
	application/octet-stream.

	* src/gsad_omp.c (create_agent_omp): Add installer and HOWTO args.  Encode
	installer and HOWTO before sending.

	* src/gsad_omp.h: Update header.

	* src/html/src/omp.xsl (agent): Enable single download button.

	* src/html/src/help/configure_agents.htm4: Correct typo.  Use agent.png.
	Close comment.

	* src/CMakeLists.txt: Neaten heading description.

2009-12-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/CMakeLists.txt: Remove HEADERS_TEMP and LIBS_TEMP as the OpenVAS
	flags are provided by other variables.  Set OpenVAS compile flags on
	gsad_omp and gsad_oap.

2009-12-18  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Add an agents page.

	* src/gsad.c (init_validator, exec_omp_post, exec_omp_get): Added
	handling for agents.

	* src/gsad_omp.c (create_agent_omp, delete_agent_omp)
	(get_agents_omp): New functions.

	* src/gsad_omp.h: Added according protos.

	* src/html/src/omp.xsl (html-create-agent-form, html-agents-table)
	(create_agent_response, delete_agent_response, agent, get_agents_response)
	(agents_response): New templates.

	* src/html/src/gsad.xsl, src/html/header.m4: Added link to agents.

	* src/html/src/help/configure_agents.htm4: New.

2009-12-18  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* CMakeLists.txt, src/CMakeLists.txt: Added checks for gnutls, libxml
	and libxslt. Tried to use "elegant" cmake mechanisms to add the
	respective linker and compiler flags, but failed.
	Todo with link to workaround added.

2009-12-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-config-table): Bold name.

2009-12-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Improve cross referencing.

	* src/html/src/omp.xsl (html-report-table): Add config and target to
	summary.
	(target): Link credential to credentials page.
	(html-config-table): Add section "Tasks using this Config".

2009-12-17  Michael Wiegand <michael.wiegand@greenbone.net>

	Added support for retrieving settings from the openvas-admininistrator.

	* src/gsad.c (init_validator): Added get_settings to the list of
	valid commands, fixed sorting of commands.
	(exec_omp_get): Added handling of get_settings command.

	* src/gsad_oap.c (get_settings_oap): New function to handle
	get_settings.

	* src/gsad_oap.h: Updated.

	* src/html/src/oap.xsl: Added handling of get_settings_response.

	* src/html/src/gsad.xsl: Added new menu item.

	* src/html/src/help/contents.htm4: Added new list item.

	* src/html/src/help/settings.htm4: New.

	* src/html/header.m4: Added new menu item.

2009-12-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Add sort buttons for task and status to the get_status page.

	* src/html/src/omp.xsl (sort): New template.
	(html-task-table): Add task and status sort buttons.

	* src/gsad.c (init_validator): Add '_' to sort_field.
	(exec_omp_post): Pass sort field and order to get_status_omp.

2009-12-17  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Use versioning mechanism as in the other OpenVAS CMake-based projects,
	added files and targets to generate documentation.

	* VERSION.in: New.

	* VERSION: Removed, will be generated by CMake.

	* doc/, doc/Doxyfile.in, doc/Doxyfile_full.in, doc/CMakeLists.txt,
	doc/.built-html: New, files to be used to generate documentation using
	doxygen.

	* CMakeLists.txt: Added versioning and documentation mechanism from
	openvas-manager.

2009-12-17  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* CMakeLists.txt: Fixed formatting by adding missing quotes.

2009-12-17  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/omp.xsl: Make report filter dialog
	look nicer in Konqueror.

2009-12-17  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (exec_omp_get): Maximum result count back down
	to 1000 as we have pagination acticated.

2009-12-17  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* CMakeLists.txt: Use pkg-config module to check for correct
	libmicrohttpd version.

	* src/CMakeLists.txt: Added TODOs to check for other libraries using
	the same mechanism as in the top-level CMakeLists.txt and to use
	the proper variables at compiling and linking step.

2009-12-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Increase credential_login max size to 40.

2009-12-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-report-details): Align table better.  Move
	per-host summary into filtered results.  Add a summary of total threat
	counts.  Rename the "Results per Host" window "Filtered Results".

2009-12-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-report-details): Only display result range
	and result headings when there are results.  Add first_result to download
	URL.

2009-12-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Separate credential name from credential login name.

	* src/gsad.c (init_validator): Add credential_login.
	(struct gsad_connection_info): Add req_parms.credential_login.
	(free_resources): Free credential login.
	(serve_post): Check for credential_login key.
	(exec_omp_post): In create_lsc_credential case pass credential_login to
	create_lsc_credential_omp.

	* src/gsad_omp.c (create_lsc_credential_omp): Add login arg.  Send to
	manager as login entity.

	* src/gsad_omp.h: Update header.

	* src/html/src/omp.xsl (html-create-lsc-credential-form): Add Login field.
	(html-lsc-credentials-table): Add Login heading.
	(lsc_credential): Add Login column.

2009-12-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c: Order authors alphabetically by surname.

	* ChangeLog: Improve formatting.

2009-12-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c: Correct doc.  Neaten comments.  Format strcmp conditionals
	consistently.

2009-12-10  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad.c (exec_omp_get): Increased maximum result count.

2009-12-09  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/header.m4: Adjusted menu to dynamic pages. (use plural
	"Scan Configs").

2009-12-08  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* VERSION: Set to 0.8.3.SVN.

	* CMakeLists.txt: Updated CPACK_PACKAGE_VERSION_PATCH.

	* src/html/src/about.htm4: Updated.

2009-12-08  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 0.8.2 release.

	* VERSION: Set to 0.8.2.

	* CMakeLists.txt: Updated CPACK_PACKAGE_VERSION_PATCH.

	* src/html/src/about.htm4: Updated.

2009-12-07  Michael Wiegand <michael.wiegand@greenbone.net>

	Fixed a bug which caused the GSA to hang or crash when editing the
	configuration for a family containing ":".

	* src/gsad.c (init_validator): Added / fixed regular expressions for
	family names.
	(exec_omp_post): Repaired validator usage.

2009-12-07  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* CMakeLists.txt: Improved checks for pkg-config and libopenvas-config,
	Intention was to first collect missing tools and then report on them to
	avoid configure-install cycles.

2009-12-07  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* CMakeLists.txt: Added checks for pkg-config and libopenvas-config.

2009-12-03  Michael Wiegand <michael.wiegand@greenbone.net>

	Added initial NVT feed synchronization support.

	* src/gsad.c (init_validator): Mark get_feed and sync_feed as valid
	commands.
	(exec_omp_post): Add handling of sync_feed command.
	(exec_omp_get): Add handling of get_feed command.

	* src/gsad_oap.c: Added functions for getting the description of a feed
	and for synchronization with a feed.
	(get_feed_oap, sync_feed_oap): New.

	* src/gsad_oap.h: Updated header.

	* src/html/src/gsad.xsl, src/html/src/help/contents.htm4,
	src/html/header.m4: Add menu item for feed management.

	* src/html/src/oap.xsl: Add support for new response types.

	* src/html/src/help/feed_management.htm4: New.

2009-12-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/make_html: Fix grep for static files to exclude
	SVN elements.

2009-12-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (REALM, POST_BUFFER_SIZE, FILE_NOT_FOUND,
	ERROR_PAGE, SERVER_ERROR, content_type, content_disposition,
	response_size, log_config, verbose): New.

2009-12-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (exec_omp_post, exec_omp_get): New.

2009-12-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (serve_post): New.

2009-12-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (free_resources, check_is_dir): New.

2009-12-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (gsad_connection_info, get_header_credentials)
	(is_http_authenticated, file_reader, get_file_size): New.

2009-12-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (print_header, send_response)
	(send_http_authenticate_header, request_handler): Improve documentation.
	(request_handler): Use "const" where possible. Introduce
	oap_cgi_base. Improve redirect for non-base URLs. Redirect
	"/login/". Fix memleak.
	(gsad_init): Improve documentation. Call init_validator.

2009-12-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c: Fixed some comments. Added list of includes.
	(DEFAULT_GSAD_PORT, DEFAULT_OPENVAS_ADMINISTRATOR_PORT)
	(DEFAULT_OPENVAS_MANAGER_PORT, GCRY_THREAD_OPTION_PTHREAD_IMPL)
	(gsad_daemon, validator, init_validator): New.
	(main): Use unified exit code. Improved comments.

2009-12-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad_oap.h: Fixed comment.

	* src/CMakeLists.txt: Reformatted.

2009-12-02  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/omp.xsl: Make 'Full and fast' accessible again as a scan
	config template.

2009-12-01  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* VERSION, CMakeLists.txt, src/html/src/about.htm4: Version set
	to 0.8.2.SVN.

2009-12-01  Michael Wiegand <michael.wiegand@greenbone.net>

	Add support for new empty scan config template.

	* src/html/src/omp.xsl: Switch default to 'empty'.

	* src/gsad_omp.c (create_config_omp): Switch default to 'empty'.

2009-12-01  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/omp.xsl: Grey out Stop/Delete in case a Task is "Requested".

2009-11-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.h, src/gsad_omp.c: New files.

	* src/CMakeLists.txt: Add static analysis rules.

2009-11-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-config-nvt-table): Always show the
	preferences, as there is always the timeout preference.

2009-11-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* VERSION, CMakeLists.txt, src/html/src/about.htm4: Version set
	to 0.8.1.SVN.

2009-11-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/header.m4, src/html/footer.m4, src/html/template.m4: New.

	* src/html/make_html: New.

	* src/html/src/login/login.html,
	src/html/src/help/error_messages.htm4: New.

2009-11-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl: Match input widths to validator widths.
	(get_targets): Apply gsad_msg.

2009-11-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl: Convert tabs to spaces.

2009-11-24  Matthew Mundell <matthew.mundell@greenbone.net>

	Add per-NVT timeout support.

	* src/html/src/omp.xsl (html-config-family-table): Add timeout column.
	Always enable the NVT edit button.
	[details, edit-details] (preferences): Add always-present timeout
	preference.

2009-11-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_base.c (gsad_message): Add function and line arguments.  Free
	the allocated XML.

	* src/gsad_base.h: Update header.

	* src/gsad_oap.c: New file.

2009-11-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/gsad.xsl, src/html/src/omp.xsl, src/html/src/oap.xsl:
	Convert tabs to spaces.

2009-11-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/gsad.xsl, src/html/src/omp.xsl, src/html/src/oap.xsl: New
	files.

2009-11-21  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* VERSION, CMakeLists.txt, src/html/src/about.htm4: Version set
	to 0.8.0.SVN.

	* src/gsad_base.h (preference_t): New.

	* src/gsad_oap.h: Updated proto for get_users_oap.

2009-11-07  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/gsa-style.css, src/html/src/help/view_report.htm4: New.

2009-11-06  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad_base.h, src/gsad_base.c: Cleanups and documentation.

2009-11-06  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/help/reports.htm4: New.

	* src/validator.c (openvas_validator_alias): New.
	(openvas_validate): Some more tracef-calls.

	* src/validator.h: Add proto accordingly.

2009-11-06  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	*  src/html/src/about.htm4, src/html/src/gplv2.htm4: New.

	* src/html/src/img/edit_inactive.png,
	src/html/src/img/ascending_inactive.png, src/html/src/img/edit.png,
	src/html/src/img/descending_inactive.png: New.

2009-11-04  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/img/descending.png, src/html/src/img/ascending.png: New.

2009-10-31  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/validator.c: New.

2009-10-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/img/download.png, src/html/src/img/bullet2.png,
	src/html/src/img/bullet.png, src/html/src/img/alert_sign.png: New.

2009-10-28  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad_oap.h: Some cosmetics.

	* src/gsad_base.h: Updated protos and added message string.

	* src/gsad_base.c (xsl_transform): Take only xml text now
	instead of files for xml and xsl.
	(gsad_message): New.

2009-10-28  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/help/tasks.htm4, src/html/src/help/contents.htm4,
	src/html/src/help/glossary.htm4: New.

	* src/html/src/img/high_big.png, src/html/src/img/medium_big.png,
	src/html/src/img/none_big.png, src/html/src/img/low_big.png: New.

2009-10-28  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/img/list_inactive.png, src/html/src/img/list.png,
	src/html/src/img/log.png, src/html/src/img/gsa_splash.png,
	src/html/src/img/low.png, src/html/src/img/high.png,
	src/html/src/img/medium.png: New.

2009-10-28  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/img/style/, src/html/src/img/style/logo_l.png,
	src/html/src/img/style/logo_m.png, src/html/src/img/style/logo_r.png,
	src/html/src/img/style/window_dec_a_error.png,
	src/html/src/img/style/window_dec_a.png,
	src/html/src/img/style/window_dec_b_error.png,
	src/html/src/img/style/window_dec_b.png,
	src/html/src/img/style/window_dec_c_error.png,
	src/html/src/img/style/window_dec_c.png: New.

	* src/validator.h: New.

	* src/CMakeLists.txt: Add module validator, fix sequence of modules,
	make libs static, remove cmake minimum requirement.

2009-10-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* VERSION, CMakeLists.txt: Upgraded from 0.7.3.SVN to 0.7.4.SVN.

2009-10-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/help/configure_scanconfigs.htm4,
	src/html/src/help/configure_credentials.htm4,
	src/html/src/help/configure_users.htm4: New. More documentation.

2009-10-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/CMakeLists.txt: Changed - to _ in module names.

	* src/gsad_oap.h: Fixed filename in doc.

	* src/gsad_base.h: Fixed filename in doc. Added missing proto.

2009-10-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad_base.c: New.

	* src/CMakeLists.txt: Added handling of module gsad_base.

2009-10-25  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad_oap.h: Renamed to src/gsad_oap.h.

2009-10-25  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad-base.h: Renamed to src/gsad_base.h.

	* src/gsad-oap.h: Adjusted include name accordingly.

2009-10-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (print_header, send_response, send_redirect_header): New.

2009-10-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* VERSION, CMakeLists.txt: Increased from 0.7.2.SVN to 0.7.3.SVN.

	* src/gsad_log_conf.cmake_in: Added "level".

	* src/CMakeLists.txt: Better handling of compile flags.

2009-10-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (main): Apply DEBUG flag for MHD.
	(request_handler): Fix typo.

2009-10-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (request_handler): Fix call of gsad_newtask,
	use g_strconcat.
	(gsad_init): Init glib.
	(main): Adjust logging to avoid recursion.

2009-10-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (send_http_authenticate_header): New.

2009-10-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (gsad_cleanup, main): Factored out pidfile management.

2009-10-20  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (request_handler): New.

2009-10-15  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/img/p_bar_bg.png, src/html/src/img/p_bar_done.png,
	src/html/src/img/p_bar_error.png, src/html/src/img/p_bar_new.png,
	src/html/src/img/p_bar.png, src/html/src/img/p_bar_request.png,
	src/html/src/img/trend_down.png, src/html/src/img/trend_less.png,
	src/html/src/img/trend_more.png, src/html/src/img/trend_nochange.png,
	src/html/src/img/trend_up.png: New.

2009-10-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (gsad_init): New.

2009-10-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (main): omp_init splits into omp_init and oap_init.
	(gsad_cleanup): New.

2009-10-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad-oap.h: New.

	* src/gsad-base.h: New.

	* src/tracef.h: New.

	* src/CMakeLists.txt: Handle modules gsad-omp and gsad-oap.

2009-10-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* VERSION: New.

	* src/gsad_log_conf.cmake_in: New.

	* src/CMakeLists.txt: New.

	* src/html/src/img/rpm.png, src/html/src/img/exe.png,
	src/html/src/img/key.png, src/html/src/img/deb.png: New.

	* gsad.c: New.

2009-10-01  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/img/new.png: New.

2009-10-01  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/help/configure_targets.htm4,
	src/html/src/help/new_task.htm4: New.

2009-09-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/img/start.png, src/html/src/img/refresh.png,
	src/html/src/img/start_inactive.png, src/html/src/img/delete.png,
	src/html/src/img/delete_inactive.png, src/html/src/img/details.png,
	src/html/src/img/stop.png, src/html/src/img/stop_inactive.png,
	src/html/src/img/help.png: New.

2009-09-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/help/, src/html/src/login/, src/html/src/img/,
	src/html/src/favicon.gif: New.

2009-09-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/: New.

2009-09-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CMakeLists.txt: New.

	* src/html/: New.

2009-09-28  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* INSTALL: New.

	* README: New.

2009-09-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* COPYING: New. The GNU GPLv2.

	* src/: New.

2009-09-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Starting package "gsa" (Greenbone Security Assistant)
